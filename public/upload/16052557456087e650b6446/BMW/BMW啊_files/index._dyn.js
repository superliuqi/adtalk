


var mandatorBrand='BM';
var mandatorMarket='CN';
var mandatorUnit='CN';
var mandatorIsDealer=false;


var mandatorCountry='CN';
var mandatorLanguage='zh';
var mandatorLocale='zh_CN';
var mandatorLocaleNodeName='zh_CN';
var mandatorRootPath='/content/brandBM/marketCN/countryCN/zh_CN';
var mandatorVarRootPath='/var/mandators/brandBM/marketCN/countryCN';
var mandatorLanguageBasePath='/zh_CN';
var mandatorContext='mc;brand=BM;market=CN;locale=zh_CN;mandatorType=country;country=CN';
var countryMandatorContext='mc;brand=BM;market=CN;locale=zh_CN;mandatorType=country;country=CN';
var mandatorKey=';country=CN;mandatorType=country';

var availableRoles = {"roles":[{"ribbonLabel":"BMW IMPULSE","roleId":"IMPULSE_USER"}]};

var GLOBAL_NCC_FRAME_PAGE='\/zh_CN\/publicPools\/templates\/ncc.html';

// MultiLevelDisclaimer switched to on or off
var GLOBAL_COUNTRY = 'CN';
var GLOBAL_MULTILEVELDISCLAIMER_SHOW = 'true';
var nextCore='http://localhost';
var nextCoreSecure='http://localhost';

var rlHost = function(){
  return {
    getC2BHostSecure: function(){
      return 'http://c2b-services.bmw.com';
    },
    getCmxHost : function(){
      return 'http://www.bmw.com.cn';
    }
  };
}();

var GLOBAL_MY_ACCOUNT_PATH='\/zh_CN\/mybmw\/myaccount.html';
var GLOBAL_CONFIG_ERROR_LAYER_URL='\/\/www.bmw.com.cn\/zh_CN\/publicPools\/errorPool\/errorLayer.html';
var GLOBAL_CONFIG_ERROR_PAGE_URL='\/\/www.bmw.com.cn\/zh_CN\/publicPools\/errorPool\/errorPage.ajax.html';
var GLOBAL_CONFIG_ERROR_PAGE_ACCESS_DENIED_URL='\/\/www.bmw.com.cn\/zh_CN\/publicPools\/errorPool\/accessDenied.html';

  
  
    var GLOBAL_REDIRECT_AFTER_LOGIN_PATH='\/zh_CN\/mybmw\/mydashboard.html';
  


var GLOBAL_LOGIN_PAGE_PATH='';
/* failed to render var GLOBAL_PROTECTED_CONTENT_LOGIN_PAGE_PATH */
var GLOBAL_SESSION_TIMEOUT_PAGE_PATH='\/\/www.bmw.com.cn\/zh_CN\/publicPools\/feedbackPool\/sessionTimeout.html';
var GLOBAL_REGISTRATION_PAGE_PATH='\/\/www.bmw.com.cn\/zh_CN\/publicPools\/registerPool\/register.html';
var GLOBAL_C2B_REGISTRATION_PAGE_PATH='\/\/www.bmw.com.cn\/zh_CN\/publicPools\/registerPool\/register_c2b.html';
var GLOBAL_ACCOUNT_DEACTIVATED_PAGE_PATH='\/\/www.bmw.com.cn\/zh_CN\/publicPools\/feedbackPool\/accountDeactivated.html';
var GLOBAL_PASSWORD_FORGOTTEN_PAGE_PATH='\/\/www.bmw.com.cn\/zh_CN\/publicPools\/dialogPool\/passwordreset\/passwordForgotten.html';
var GLOBAL_PASSWORD_LINK_SEND_PAGE_PATH='\/\/www.bmw.com.cn\/zh_CN\/publicPools\/dialogPool\/passwordreset\/passwordLinkSend.html';
var GLOBAL_USERNAME_CHANGE_INFO_PAGE_PATH='\/\/www.bmw.com.cn\/zh_CN\/publicPools\/feedbackPool\/usernameChangeInfo.html';
var GLOBAL_CONFIG_SELECTOR_PATH='\/\/www.bmw.com.cn\/zh_CN\/publicPools\/dialogPool\/myconfig\/selectordialog.html';
var GLOBAL_VEHICLE_SELECTOR_PATH='\/\/www.bmw.com.cn\/zh_CN\/publicPools\/dialogPool\/myvehicles\/selectordialog.html';
var GLOBAL_CONFIG_RENAME_DIALOG_URL='\/zh_CN\/publicPools\/dialogPool\/myconfig\/renamedialog.html';
var GLOBAL_CONFIG_SHARE_DIALOG_URL='\/zh_CN\/publicPools\/dialogPool\/myconfig\/sharedialog.html';
var GLOBAL_CONFIG_SHARE_SUCCESS_DIALOG_URL='\/zh_CN\/publicPools\/dialogPool\/myconfig\/sharesuccessdialog.html';
var GLOBAL_CONFIG_UNSHARE_DIALOG_URL='\/zh_CN\/publicPools\/dialogPool\/myconfig\/unsharedialog.html';
var GLOBAL_CONFIG_DELETE_DIALOG_URL='\/zh_CN\/publicPools\/dialogPool\/myconfig\/deletedialog.html';
var GLOBAL_MYBMWVEHICLE_ADD_DIALOG_URL='\/zh_CN\/publicPools\/dialogPool\/myvehicles\/mybmwvehicles.html';
var GLOBAL_CONFIG_BUY_DIALOG_URL='\/zh_CN\/publicPools\/dialogPool\/myconfig\/addtomyvehiclesdialog.html';
var GLOBAL_MY_DASHBOARD_PAGE_PATH='\/zh_CN\/.html';
var GLOBAL_LOGIN_WITH_POLICY_CONSENT_PAGE_PATH='\/\/www.bmw.com.cn\/zh_CN\/publicPools\/dialogPool\/policy\/loginWithPolicyConsent.html';
var GLOBAL_REVOKE_POLICY_PAGE_PATH='\/\/www.bmw.com.cn\/zh_CN\/publicPools\/dialogPool\/policy\/revokepolicy.html';
var GLOBAL_NCC_SAVE_DIALOG_URL='\/zh_CN\/publicPools\/dialogPool\/myconfig\/savedialog.html';
var GLOBAL_NCC_SAVE_CONFIRM_DIALOG_URL='\/zh_CN\/publicPools\/dialogPool\/myconfig\/myconfigsaveconfirm.html';
var GLOBAL_GPL_OKCANCELTEMPLATE_URL='\/\/www.bmw.com.cn\/zh_CN\/publicPools\/dialogPool\/glasspanelayertemplate.ajax.html';
/* failed to render var GLOBAL_LOGIN_ACCOUNT_STATE_URL */
/* failed to render var GLOBAL_LOGIN_IN_IFRAME_URL */

var GLOBAL_LOGIN_SERVICE='';
var GLOBAL_RESEND_ACTIVATION_LINK_INFO_PAGE_PATH='\/\/www.bmw.com.cn\/zh_CN\/publicPools\/feedbackPool\/resendActivationInfo.html';
var GLOBAL_RESEND_USERNAME_CHANGE_LINK_INFO_PAGE_PATH='\/\/www.bmw.com.cn\/zh_CN\/publicPools\/feedbackPool\/resendUsernameChangeInfo.html';
var GLOBAL_CONFIG_SAVED_AS_BOUGHT_SUCCESS_URL='\/zh_CN\/mybmw\/myvehicles.html';
var GLOBAL_VEHICLE_DELETE_DIALOG_URL='\/zh_CN\/publicPools\/dialogPool\/myvehicles\/deletedialog.html';
var GLOBAL_VEHICLE_RENAME_DIALOG_URL='\/zh_CN\/publicPools\/dialogPool\/myvehicles\/renamedialog.html';
var GLOBAL_ADD_VIN_TO_MY_VEHICLE_DIALOG_URL='\/zh_CN\/publicPools\/dialogPool\/myvehicles\/addvintomyvehicledialog.html';
var GLOBAL_MY_CONFIGURATIONS_URL='\/zh_CN\/mybmw\/myconfigurations.html';
var GLOBAL_COOKIES_CONSENT_DISCLAIMER_PATH='\/\/www.bmw.com.cn\/zh_CN\/publicPools\/contentPool\/cookie-disclaimer-consent.html';

    var GLOBAL_MLD_SMALL = 'true';
    var GLOBAL_IRIS_URL = 'https://cosy.bmwgroup.com/next/cosySec';
    var GLOBAL_MAX_GARAGE_ENTRIES= 20;
    var GLOBAL_CMX_SERVER= 'http://www.bmw.com.cn';
    var GLOBAL_CMX_SSL_SERVER = 'http://www.bmw.com.cn';
    var GLOBAL_CMX_JS_SERVER = GLOBAL_COUNTRY_SERVER = 'http://www.bmw.com.cn';
    var GLOBAL_CMX_JS_SSL_SERVER = 'http://www.bmw.com.cn';
    var GLOBAL_COOKIES_ERROR_PAGE_PATH= '/publicPools/errorPool/cookie_deactivate_reply.html';
    

var GLOBAL_DLO_PAGE_URL='';



  
  
    
    var GLOBAL_BACK_TO_DEALER_LAYER_PAGE_URL = '//www.bmw.com.cn/zh_CN/publicPools/contentPool/back-to-dealer';
  






var GLOBAL_DEALER_WATCHLIST_PAGE_URL='';

var GLOBAL_RFC1_PAGE_URL='\/\/www.bmw.com.cn\/zh_CN\/publicPools\/requestPool\/requestforcontact.html';
var GLOBAL_RFO_PAGE_URL='\/\/www.bmw.com.cn\/zh_CN\/publicPools\/requestPool\/requestforoffer.html';
/* failed to render var GLOBAL_RFP_PAGE_URL */
var GLOBAL_RFI_PAGE_URL='\/\/www.bmw.com.cn\/zh_CN\/publicPools\/requestPool\/requestforinformation.html';
var GLOBAL_RFI_PRINT_PAGE_URL='\/\/www.bmw.com.cn\/zh_CN\/publicPools\/requestPool\/requestforinformationprint.html';
/* failed to render var GLOBAL_RFI_DOWNLOAD_PAGE_URL */
var GLOBAL_TDA_PAGE_URL='\/\/www.bmw.com.cn\/zh_CN\/publicPools\/requestPool\/requestfortestdrive.html';
/* failed to render var GLOBAL_CONTACTFORM_PAGE_URL */
/* failed to render var GLOBAL_CALLBACKFORM_PAGE_URL */
/* failed to render var GLOBAL_RFA_PAGE_URL */


var rlGlobalConfig = {
    isManualVinMapping: ('false' === 'true') ? true : false
};

var GLOBAL_ESP_PRICE_NOTIFICATION_LAYER_PATH = '';
var GLOBAL_ESP_PROCESS_OVERVIEW_PAGE_URL = '';
var GLOBAL_ESP_ERROR_PAGE_URL = '';
var GLOBAL_ESP_ERROR_LAYER_URL = '';
var GLOBAL_ESP_RFO_SPECIAL_CUSTOMER_PAGE_URL = '';

var GLOBAL_ESP_ORDER_PAGE_URL='//www.bmw.com.cn/zh_CN/esp/esp-order.html';


    var GLOBAL_ESP_PRICE_NOTIFICATION_LAYER_PATH='\/\/www.bmw.com.cn\/zh_CN\/esp\/esp-price-notification-layer.html';
    var GLOBAL_ESP_PROCESS_OVERVIEW_PAGE_URL='\/\/www.bmw.com.cn\/zh_CN\/esp\/esp-processoverview.html';
    var GLOBAL_ESP_ERROR_PAGE_URL='\/\/www.bmw.com.cn\/zh_CN\/esp\/esp-errorpage.ajax.html';
    var GLOBAL_ESP_ERROR_LAYER_URL='\/\/www.bmw.com.cn\/zh_CN\/esp\/esp-errorlayer.ajax.html';
    var GLOBAL_ESP_RFO_SPECIAL_CUSTOMER_PAGE_URL='\/\/www.bmw.com.cn\/zh_CN\/esp\/requestforofferforspecialcustomer.html';



   
    var GLOBAL_CMX_MESSAGE_SR_CLOSE_GPLAYER_TOOLTIP = 'Close';
    var GLOBAL_CMX_MESSAGE_ICON_CLOSE = 'Close';
    var GLOBAL_ZSO_ERROR_IMAGE = '/dam/brandBM/common/logo-icons/errors/Teaser_180x100.jpg';
    var GLOBAL_ZSO_DETAIL_ERROR_IMAGE = '/dam/brandBM/common/logo-icons/errors/Detail_600x338.jpg';

var CROSSSUBDOMAINAJAX_TIMEOUT = 20000;

var MANDATOR_SUPPORTED_SUBBRANDS = 'BM,BI'.split(',');

rlC2BConfig = {
  getDealerLocatorServiceUrl : function(_brand){
    url = 'http://c2b-services.bmw.com' + '/c2b-localsearch/services/api/v3/clients/_{key}/_{market}/pois?country=_{country}&category=_{brand}&key=_{distkeys}';
    brand = isDefined(_brand) ? _brand : rlMandator.getBrand();

    url = url.replace(/_{brand}/g, (isDefined(brand) ? brand : ""))
    url = rlMandator.replaceCoreUrl(url);
    url = url.replace('_{key}', 'BMWDIGITAL_DLO');

    return url;
  },

  getDealerLocatorServiceUrlCmx : function(){
    var url='\/\/www.bmw.com.cn\/zh_CN\/index.dealer.dealerId=_{dealerKey}._dyn.js';;
    url = decodeURIComponent(url);
    url = rlMandator.replaceCoreUrl(url);

    return url;
  },

  getBrand : function(){
     return rlMandator.getBrand();
  }
};

rlGoogleMapsConfig = function(){
  var  mapsLoaded = false;
  var  mapsLoading = false;
  var callbacks = [];

  function processCallbacks(){
    jq.each(callbacks, function(idx,elem){
      elem();
    });
    callbacks = [];
  }

  return {
    initGoogleMaps : function(callbackFct){
      if (mapsLoaded){
        if (typeof callbackFct == "function"){
          callbackFct();
        }
        return;
      }

      if (typeof callbackFct == "function"){
        callbacks.push(callbackFct);
      }
      if (isDefined(google) && google) {
        if (!mapsLoaded && !mapsLoading){
          mapsLoading = true;
          google.load('maps', '3',
            {callback: function(){
                          processCallbacks();
                          mapsLoaded = true;
                       },
            other_params: 'libraries=geometry&sensor=false&client=gme-bmw&channel=BMWDIGITAL_DLO&language=zn&region=CN'});
        }
      }
    }
  };
}();

rlDealerConfig = {
  getAddressFormat : function(){
    return 'street|zip city';
  }
};

rlPreferredDealersModelConfig = {
  getNumMaxPreferredDealers : function(){
    return 3;
  }
};

rlSpeedTrapScriptUrl = 'https://input.bmw.com/SpeedTrapInsert.js';


/**
  * @description logComp=(exampleComp), logLevel=(0-2)
  *
**/
rlCompLog = {
    /**
    * @name rlCompLog
    * @description show or hide log output
    */

    displayLog: false, //show or hide log output
    logDetailLevel: 0, // 0=light; 1=moderate; 2=full

    urlAttributes: {},

    /**
    * @name getUrlVar
    * @param key the key to get the value
    * @description get the key value from url
    */
    getUrlVar: function(key) {
        var result = new RegExp(key + "=([^&]*)", "i").exec(window.location.search);
        return result && result[1] || false;
    },

    /**
    * @name getStack
    * @description generate calling stack
    */
    getStack: function(){
        fnRE  = /function\s*([\w\-$]+)?\s*\(/i;
        var caller = arguments.callee.caller;
        var stack = {};
        stack.path = "";
        stack.methods = [];
        var fn;

        while (caller){
            fn = fnRE.test(caller.toString()) ? RegExp.$1 || "{?}" : "{?}";
            stack.methods.push(caller);
            stack.path += "-->"+fn;
            caller = caller.arguments.callee.caller;
        };
        return stack;
    },

    /**
    * @name getLogStatus
    * @param comp component name
    * @description activate comp log output
    */
    getLogStatus: function(comp) {
        var urlAttributes = rlCompLog.getUrlVar("logComp");
        if (urlAttributes && urlAttributes.search(comp) != -1){
            rlCompLog.displayLog = true;
        }

        rlCompLog.logDetailLevel = rlCompLog.getUrlVar("logLevel");


    },

    /**
    * @name showLog
    * @param logTXT text for log output
    * @param type type of log output (log, debug, info, warn, error, time, timeEnd, trace, group, groupEnd, dir, dirxml)
    * @param detailLevel the detail level of the specific log output (0-2)
    * @param comp component name to get the log output only for this component
    * @param status status of log output (true, false)
    * @param logDetailLevel the detail level to show the logs
    * @description activate comp log output
    */
    showLog: function(logTXT, type, detailLevel, comp, status, logDetailLevel) {

        rlCompLog.getLogStatus(comp);

        if (!logDetailLevel){
            rlCompLog.logDetailLevel = 2;
        }

        if (!type) type = "log";
        if (!detailLevel) detailLevel = 2;

        if (rlCompLog.urlAttributes["debugComponents"] === false && rlCompLog.urlAttributes["debugStatus"] == "on" || rlCompLog.inArray(comp, rlCompLog.urlAttributes["debugComponents"]) && rlCompLog.urlAttributes["debugStatus"] == "on" || status === true){

            if (detailLevel <= rlCompLog.urlAttributes["debugLevel"]) {

                if (!jq.browser.msie) {
                    window.console[type]("["+comp+"] "+logTXT);
                } else {
                    window.console.log("["+comp+"] "+logTXT);
                }
            }
        }

        //window.console.log = function(message) {jq('#debugDiv').append('<p>' + message + '</p>');};
        //window.console.error = window.console.debug = window.console.info =  window.console.log
    },
    inArray: function inArray(needle, haystack) {
        var length = haystack.length;
        for(var i = 0; i < length; i++) {
            if(haystack[i] == needle) return true;
        }
        return false;
    },
    __init__: function(){
        rlCompLog.urlAttributes["debugStatus"] = rlCompLog.getUrlVar("debugJs");

        if (rlCompLog.getUrlVar("debugComp")){
            rlCompLog.urlAttributes["debugComponents"] = rlCompLog.getUrlVar("debugComp").split(",");
        }else{
            rlCompLog.urlAttributes["debugComponents"] = false;
        }
        if (rlCompLog.getUrlVar("debugLevel")){
            rlCompLog.urlAttributes["debugLevel"] = rlCompLog.getUrlVar("debugLevel");
        }else{
            rlCompLog.urlAttributes["debugLevel"] = 2;
        }


        if (rlCompLog.urlAttributes["debugStatus"] == "on"){
            rlCompLog.displayLog = true;
        }
    }

};

rlCompLog.__init__();


var rlContextObject = function() {
  /**
   * context object for displaying salesbar buttons 
   */
  var contextObject = {
    vehicle : {
      configId : undefined, // undefined / string
      publicConfigId: undefined, // undefined / string
      vehicleId: undefined, // undefined / string
      stayInformed : true, //undefined, // true / false
      TDA : true, // true / false 
      RFO : true, // true / false 
      RFP : true, // true / false 
      RFI : true, // true / false 
      ESP : undefined, // true / false
      seriesId : undefined,  // string (empty string signals no seriesId)
      modelRangeId : undefined,  // string 
      modelCode : undefined,  // string 
      bodyTypeId : undefined, // number 
      visualizer : undefined, // true / false 
      deliveryTime : undefined, // string (empty string signals no deliveryTime know) 
      isSOC : undefined, // legacy is overwritten by RFx properties
      isDirty : false // when true, configId has changed, waiting for new vehicle data (not in use)
      
    },    
    

/**
 * This will be overwritten by: /apps/bmwnext/dealer/pageComponents/dealerStandard/rlContextObject_dealer.jsp
 * 
 * needed properties:
 * @property TDA
 * @property RFO
 * @property RFI
 * @property contactForm
 * @property distributionPartnerId
 * @property outletId
 * 
 * */

outlet : {
  TDA : undefined, // true / false
  RFO : undefined, // true / false
  RFI : undefined, // true / false
  contactForm : undefined, // true / false
  distributionPartnerId : undefined, // number / false
  outletId : undefined ,// number / false
  outletType : undefined, // String /  FU,SE,SA,PO,UC,SP,TD
  BM : {
  TDA : undefined,  // true / false
  RFO : undefined, // true / false
  RFI : undefined // true / false
  },
  BI : {
  TDA : undefined,  // true / false
  RFO : undefined, // true / false
  RFI : undefined // true / false
  },
  
},    
    accessory : {
    
      accessoryId : undefined, // number / false
      accessoryName : undefined, // string / false
      priceFormatted : undefined, // string / false
      availableFor : undefined // string / false    
    },
    user : {
      savedConfigs : undefined, // true / false 
      savedVehicles : undefined, // true / false 
      loggedIn : undefined, // true / false
      roles : undefined, // Impulse
      campaingns : undefined
    },
    page :  {
      brand : undefined, // BM / MI
      market : undefined,
      isDealer : false, // true / false 
      brandSubbrand: undefined, // brand-bmwi / brand-bmw
      language : undefined,  // string 
      country : undefined,  // string 
      locale : undefined,  // string 
      persoContextId : undefined,  // string
      isNCC : false, // true / false
      isMyBMW : false // true / false
    }
  };
  
  function validateModelRangeId(_modelRangeId) {
    var modelRangeId = (_modelRangeId) ? _modelRangeId : (contextObject.vehicle.modelRangeId) ? contextObject.vehicle.modelRangeId : false;
    if(typeof modelRangeId != "string") {
      return false
    } else {
      return modelRangeId.toLowerCase();
    } 
  }
  
  function setCampaignsData(_campaignData){
    if(typeof _campaignData == "object") {
      contextObject.user.campaingns = _campaignData;
    } else {
      contextObject.user.campaingns = {};
    }
  }
  
  return {
    __init__ : function() {
      setCampaignsData({"e70":{"campaignParticipationForm":"/zh_CN/publicPools/campaignPool/crm2/public-soc-campaign/rfc.ajax.html","campaignId":"5284","campaignOfferId":"268437666","campaignResponseType":"COMM_RESPONSE_TYPE_12","leadContext":"TDA_Leadcontext","loginRequired":false}});
    },
    
    getContextObject : function() {
      // Returns a copy. Changing data must occur through a setter method from the context object
      return jq.extend(true,{},contextObject);
    },

    events: {
        BRAND_SUBBRAND_CHANGED : "BRAND_SUBBRAND_CHANGED"
    },
    
    getBrandSubbrand : function(){
      return contextObject.page.brandSubbrand;
    },
    getIsNCC : function() {
      return contextObject.page.isNCC;
    },
    setIsNCC : function(_value) {
      contextObject.page.isNCC = _value;
    },
    getIsMyBMW : function() {
    return contextObject.page.isMyBMW;
    },
    setIsMyBMW : function(_value) {
      contextObject.page.isMyBMW = _value;
    },

    getESP: function(){
      return contextObject.vehicle.ESP;
    },
    setESP: function(esp){
      contextObject.vehicle.ESP = esp;
    },
    
    getVehicleVisualizer : function() {
      return contextObject.vehicle.visualizer;
    },
    setVehicleVisualizer : function(_value) {
      contextObject.vehicle.visualizer = _value;
    },
    setBrandSubbrand : function(brandSubbrand){
      var brandBMWi = "brand-bmwi";
      var brandBMW  = "brand-bmw";
      if (brandSubbrand === brandBMWi || brandSubbrand === brandBMW){
        contextObject.page.brandSubbrand = brandSubbrand;        
      }else{
        contextObject.page.brandSubbrand = undefined;      
      }
      jq(window).trigger(rlContextObject.events.BRAND_SUBBRAND_CHANGED, [ brandSubbrand ]);
      jq(".subbrandsensitive").each(function(index, elem) {
        if (brandSubbrand === brandBMWi) {
          jq(elem).addClass(brandBMWi);
        } else {
          jq(elem).removeClass(brandBMWi);
        }
      });
    },
    dump: function(){
      console.dir(contextObject);
    },
    
    setIsLoggedIn : function(_value) {
      contextObject.user.loggedIn = _value;
    },
    
    getDlrPartnerKey: function(){
      if(contextObject.outlet && typeof contextObject.outlet.distributionPartnerId !== "undefined" && typeof contextObject.outlet.outletId !== "undefined"
        && contextObject.outlet.distributionPartnerId !== false && contextObject.outlet.outletId !== false){
        return contextObject.outlet.distributionPartnerId+'_'+contextObject.outlet.outletId;
      }
      else{
        return undefined;
      }
    },
    
    setRoutePlanningFlag: function(_value){
      contextObject.routePlanningFlag = _value;
    },
    
    getRoutePlanningFlag: function(){
      return contextObject.routePlanningFlag;
    },
        
    setDlrOutletId : function(_value) {
      contextObject.outlet.outletId = _value;
    },
        
    setDlrOutletType : function(_value) {
      contextObject.outlet.outletType = _value;
    },
        
    setDlrOutletTDA : function(_value) {
      contextObject.outlet.TDA = _value;
    },
        
    setDlrOutletRFO : function(_value) {
      contextObject.outlet.RFO = _value;
    },
        
    setDlrOutletRFI : function(_value) {
      contextObject.outlet.RFI = _value;
    },
        
    setDlrOutletContactForm : function(_value) {
      contextObject.outlet.contactForm = _value;
    },
        
    setDlrPartnerId : function(_value) {
      contextObject.outlet.distributionPartnerId = _value;
    },
       
    setBrand : function(_value) {
      contextObject.page.brand = _value;
    },
    setDlrOutletBiTDA : function(_value) {
      contextObject.outlet.BI.TDA = _value;
    },
        
    setDlrOutletBiRFO : function(_value) {
      contextObject.outlet.BI.RFO = _value;
    },
        
    setDlrOutletBiRFI : function(_value) {
      contextObject.outlet.BI.RFI = _value;
    },
    setDlrOutletBmTDA : function(_value) {
      contextObject.outlet.BM.TDA = _value;
    },
        
    setDlrOutletBmRFO : function(_value) {
      contextObject.outlet.BM.RFO = _value;
    },
        
    setDlrOutletBmRFI : function(_value) {
      contextObject.outlet.BM.RFI = _value;
    },
        
    setMarket : function(_value) {
      contextObject.page.market = _value;
    },
    
    setLanguage : function(_value) {
      contextObject.page.language = _value;
    },
    
    setCountry : function(_value) {
      contextObject.page.country = _value;
    },
    
    setLocale : function(_value) {
      contextObject.page.locale = _value;
    }, 
        
    setIsDealer : function(_value) {
      contextObject.page.isDealer = _value;
    },
    
    isDealer: function(){
      return contextObject.page.isDealer;
    },

    setVehicleStayInformed : function(_value) {
      contextObject.vehicle.stayInformed = _value;
    },
        
    setVehicleTDA : function(_value) {
      contextObject.vehicle.TDA = _value;
    },

    setVehicleRFO : function(_value) {
      contextObject.vehicle.RFO = _value;
    },
    
    setVehicleRFP : function(_value) {
      contextObject.vehicle.RFP = _value;
    },
    
    setVehicleRFI : function(_value) {
      contextObject.vehicle.RFI = _value;
    },
    setVehicleESP : function(_value) {
      contextObject.vehicle.ESP = _value;
    },
    setSeriesId : function(_value) {
      contextObject.vehicle.seriesId = _value !== "" ? _value : undefined;
    },
    setModelRangeId : function(_value) {
      /** BEGIN   tracking for webanalytics
      *          The attribute added to "window" object is used for tracking. Changes compromising its construction
      *          MUST be communicated to team Analysieren (mailto:dig.FT-Ana@list.bmw.com) */
      if( _value!="" && typeof _value !== 'undefined' && typeof ncc == 'undefined'){
        window.bmwCmxModelSelection = _value + "|-";
      }
      /** END     tracking for webanalytics */
      contextObject.vehicle.modelRangeId = _value;
    },

    setBodyTypeId: function(_value) {
        contextObject.vehicle.bodyTypeId = _value;
    },
    setModelCode : function(_value) {
      contextObject.vehicle.modelCode = _value;
    },
    
    setConfigId: function(_value) {
      contextObject.vehicle.configId = _value !== "" ? _value : undefined;
    },

    setPublicConfigId: function(_value) {
      contextObject.vehicle.publicConfigId = _value !== "" ? _value : undefined;
    },

    setDeliveryTime: function(_value) {
      contextObject.vehicle.deliveryTime = _value !== "" ? _value : undefined;
    },

    setVehicleId: function(_value) {
      contextObject.vehicle.vehicleId = _value !== "" ? _value : undefined;
    },
            
    setBodyType : function(_value) {
      contextObject.vehicle.bodyTypeId = _value;
    },
    
    setIsSOC : function(_value) {
      contextObject.vehicle.isSOC = _value;
    },
     setSavedConfigs : function(_value) {
        contextObject.user.savedConfigs = _value;
    },
    
    setAccessoryData : function(_obj) {
      contextObject.accessory.accessoryId = _obj.accessoryId;
      contextObject.accessory.accessoryName = _obj.accessoryName;
      contextObject.accessory.priceFormatted = _obj.priceFormatted;
      contextObject.accessory.availableFor = _obj.availableFor;
    },

    setPersoContext : function(_obj) {
      contextObject.page.persoContextId = _obj.persoContextId;
    },

    getIsSOC : function() {
        return contextObject.vehicle.isSOC;
    },

    getIsAccessory : function() {
        return (contextObject.accessory.accessoryId) ? true : false;
    },

    getHasSavedConfigs : function() {
        return contextObject.user.savedConfigs;
    },
    setHasSavedVehicles : function(_value){
         contextObject.user.savedVehicles = _value;
    }, 
    getHasSavedVehicles : function() {
        return contextObject.user.savedVehicles;
    },  
    getModelRangeId : function() {
      return contextObject.vehicle.modelRangeId;
    },  
    getModelCode : function() {
      return contextObject.vehicle.modelCode;
    }, 
    getDeliveryTime : function() {
      return contextObject.vehicle.deliveryTime;
    }, 
    getHasCampaign : function(_modelRangeId) {
      var modelRangeId = validateModelRangeId(_modelRangeId);
      return (modelRangeId) ? (modelRangeId in contextObject.user.campaingns) : false;
    },
    getCampaignForModelRangeId : function(_modelRangeId) {
      var modelRangeId = validateModelRangeId(_modelRangeId);
      return (modelRangeId) ? contextObject.user.campaingns[modelRangeId] : false;
    },
    isUserLoggedIn: function () {
      return isDefined(contextObject.user.loggedIn) ? contextObject.user.loggedIn : false;
    },
    isOutletContactHidden: function () {
      return contextObject.outlet ? contextObject.outlet.contactHidden : false;
    },
    resetVehicle : function() {
        rlContextObject.setConfigId(undefined);
        rlContextObject.setPublicConfigId(undefined);
        rlContextObject.setVehicleId(undefined);
        rlContextObject.setModelRangeId(undefined);
        rlContextObject.setModelCode(undefined);
        rlContextObject.setSeriesId(undefined);
        rlContextObject.setDeliveryTime(undefined);
        rlContextObject.setBodyTypeId(undefined);
        rlContextObject.setVehicleRFI(undefined);
        rlContextObject.setVehicleRFO(undefined);
        rlContextObject.setVehicleRFP(undefined);
        rlContextObject.setVehicleTDA(undefined);
        rlContextObject.setVehicleESP(undefined);
        rlContextObject.setIsSOC(undefined);
        rlContextObject.setBrandSubbrand("brand-bmw");
        rlContextObject.setVehicleVisualizer(undefined);
        rlContextObject.setVehicleStayInformed(undefined);
    },
    updateVehicleData : function(_vehicle) {
        rlContextObject.setConfigId(_vehicle.configId);
        rlContextObject.setVehicleId(_vehicle.vehicleId);
        rlContextObject.setModelRangeId(_vehicle.modelRangeId);
        rlContextObject.setModelCode(_vehicle.modelCode);
        rlContextObject.setSeriesId(_vehicle.seriesId);
        rlContextObject.setDeliveryTime(_vehicle.deliveryTime);
        rlContextObject.setBodyTypeId(_vehicle.bodyTypeId);
        rlContextObject.setVehicleRFI(_vehicle.RFI);
        rlContextObject.setVehicleRFO(_vehicle.RFO);
        rlContextObject.setVehicleRFP(_vehicle.RFP);
        rlContextObject.setVehicleTDA(_vehicle.TDA);
        rlContextObject.setIsSOC(_vehicle.isSOC);
        rlContextObject.setVehicleVisualizer(_vehicle.visualizer);
        rlContextObject.setVehicleStayInformed(_vehicle.stayInformed);
        rlContextObject.setVehicleESP(_vehicle.ESP);
    },
    getPersoContextId : function(){
        return contextObject.page.persoContextId;
    }
  };
}();

rlContextObject.__init__();
        var rlTranslator = function () {
            // generates objects matching key = "mb_*", "MB_*", "em_*" or "EM_*"
            var msgs_mb = {
	"mb_account_policy_revoke_link":"Yes, i want to delete my account",
	"mb_account_requiered_input":"* required input",
	"mb_address_addressCannotBeValidated":"Address could not be validated",
	"mb_address_addressUnknownButSaveable":"Adress unknown but saveable",
	"mb_address_addressInvalid":"Invalid address",
	"mb_bmwVIN":"Vehicle identification number (VIN) invalid",
	"mb_configstage_perspective_front":"Show front view",
	"mb_configstage_perspective_inside":"Show rear view",
	"mb_configstage_perspective_rear":"Show interior view",
	"mb_configure_no_config":"Do not edit configuration stage.",
	"mb_dateInPast":"Date is in the past",
	"mb_dateIntervalMonthsFuturePlural":"In {0} months",
	"mb_dateIntervalMonthsFutureSingular":"In {0} month",
	"mb_syntax":"Invalid format.",
	"mb_field_required":"Please complete the required field.",
	"mb_integer":"Please enter a number",
	"mb_invalid_email":"Invalid e-mail address",
	"mb_login_password_required":"Please enter your password.",
	"mb_my_configuration":"My configuration",
	"mb_myconfig_continue_configure":"Continue configuration",
	"mb_myconfig_no_item_selected":"None selected",
	"mb_myconfig_proceed_to_mybmw":"Go to My BMW",
	"mb_myconfig_proceed_to_target_url":"Proceed",
	"mb_passwordreset_close":"Close",
	"mb_passwordreset_forward":"Continue to",
	"mb_passwordreset_request":"Request password",
	"mb_passwordreset_send":"Submit changes",
	"mb_povs_ErrMsgIncompleteDate":"Incomplete date",
	"mb_povs_ErrMsgInvalidVIN":"Invalid vehicle identification number.",
	"mb_povs_ErrMsgMileage":"Invalid mileage.",
	"mb_povs_ErrMsgRequired":"Required information",
	"mb_povs_FindByModelTree":"Search by vehicle model",
	"mb_povs_FindByVIN":"Search by vehicle ID number",
	"mb_povs_PleaseChoose_Brand":"Select brand",
	"mb_povs_PleaseChoose_Model":"Select model",
	"mb_povs_PleaseChoose_ModelYear":"Filter by construction date",
	"mb_povs_PleaseChoose_Series":"Select series",
	"mb_profile_any_phone_required":"Please provide at least one telephone number.",
	"mb_profile_birthday_no_partial_date":"Please enter your date of birth.",
	"mb_profile_birthday_required":"Please enter your complete date of birth.",
	"mb_profile_business_mobile_required":"Please enter your mobile phone number.",
	"mb_profile_business_phone_required":"Please enter your telephone number.",
	"mb_profile_city_required":"Please enter your postcode and postal town or city.",
	"mb_profile_company_name_required":"Please enter your company name.",
	"mb_profile_confirm_equal":"Please repeat your password.",
	"mb_profile_confirm_required":"Please repeat your password.",
	"mb_profile_email_not_valid":"Please enter a valid e-mail address.",
	"mb_profile_email_required":"Please enter your e-mail address.",
	"mb_profile_fax_required":"Please enter your fax number.",
	"mb_profile_firstname_required":"Please enter your first name.",
	"mb_profile_instantcheck_accordionLink":"Your password check",
	"mb_profile_instantcheck_headline":"Your password must contain:",
	"mb_profile_instantcheck_lengthdescription":"At least 8 characters",
	"mb_profile_instantcheck_letter":"Letters",
	"mb_profile_instantcheck_letter_constraint":"(abc = ABC, not \u00C4\u00D6\u00DC)",
	"mb_profile_instantcheck_minimumdescription":"At least 2 of these 3 groups",
	"mb_profile_instantcheck_numbers":"Digits",
	"mb_profile_instantcheck_specials":"Special characters",
	"mb_profile_instantcheck_specials_constraint":",.+-()@:;*\'",
	"mb_profile_lastname_required":"Please enter your surname.",
	"mb_profile_login_required":"Please enter your e-mail address.",
	"mb_profile_mobile_required":"Please enter your mobile phone number.",
	"mb_profile_pager_required":"Please enter your pager number.",
	"mb_profile_password_required":"Please define your password.",
	"mb_profile_phone_format_invalid":"Please specify a valid telephone number.",
	"mb_profile_phone_required":"Please enter your telephone number.",
	"mb_profile_phone_validation":"Please specify a valid telephone number.",
	"mb_profile_postal_code_required":"Please enter your postcode and postal town or city.",
	"mb_profile_preferred_communication_required":"Please choose how you would prefer to be contacted.",
	"mb_profile_reCaptcha_reload":"Request new string of characters",
	"mb_profile_reCaptcha_required":"Please enter the string of characters.",
	"mb_profile_salutation_required":"Please enter your title.",
	"mb_profile_street_number_required":"Please enter your street address including your house number.",
	"mb_profile_street_required":"Please enter your street address.",
	"mb_scoring_complete":"Scoring complete",
	"mb_scoring_incomplete":"Scoring incomplete",
	"mb_set_as_primary":"Set as primary",
	"mb_vehicle_brand_required":"Please give details of your current vehicle.",
	"mb_vehicle_initial_registration_required":"Please enter the date on which your current vehicle was first registered.",
	"mb_vehicle_milage_required":"Please enter the milometer reading of your current vehicle.",
	"mb_vehicle_milage_year_required":"Please enter the annual mileage of your current vehicle.",
	"mb_vehicle_model_required":"Please complete your vehicle details.",
	"mb_vehicle_number_cars_in_household_required":"Please tell us how many vehicles there are in your household.",
	"mb_vehicle_number_family_members_required":"Please specify the number of people in your household.",
	"mb_vehicle_planned_purchase_required":"Please complete your time details.",
	"mb_vehicle_series_required":"Please complete your vehicle details.",
	"mb_vehicle_usage_required":"Please specify how your current vehicle is used.",
	"mb_vehicle_vehicle_type_required":"Please specify your current vehicle type.",
	"mb_view_config_details":"Show details",
	"mb_visual_settings":"Visual settings",
	"mb_acc_change_entry":"Change",
	"mb_acc_delete":"Delete account",
	"mb_acc_email":"User name \/ e-mail",
	"mb_acc_password":"Password",
	"mb_acc_username":"User name \/ e-mail",
	"mb_add_accessories":"Accessories",
	"mb_add_original_bmw_accessories":"Add genuine BMW accessories",
	"mb_alt_back_image":"View from behind",
	"mb_alt_front_image":"View from front",
	"mb_alt_interior_image":"Interior view",
	"mb_capacity":"Capacity",
	"mb_capacity_unit":"l",
	"mb_change_exterior":"Change exterior",
	"mb_change_interior":"Change interior",
	"mb_change_lines_edition":"Change lines \/ editions",
	"mb_change_packages":"Change packages",
	"mb_configurations":"Configurations",
	"mb_configure":"Configure",
	"mb_configure_now":"configure_now",
	"mb_consumption":"Consumption",
	"mb_consumption_unit":"l\/100 km",
	"mb_emissions":"CO2",
	"mb_emissions_unit":"g\/km",
	"mb_extended_options":"Extended options",
	"mb_exterior":"Exterior",
	"mb_free_slots":"Available configuration slots",
	"mb_fuel_type":"Fuel",
	"mb_fuel_type_D":"Diesel",
	"mb_fuel_type_O":"Petrol",
	"mb_info_delete":"Info: to be deleted",
	"mb_info_move_to_myvehicles":"Info: move to My Vehicles",
	"mb_info_set_primary":"Info: define as primary vehicle",
	"mb_interior":"Interior",
	"mb_last_change_date":"Last changed:",
	"mb_less_options":"Less options",
	"mb_lines_edition":"Lines \/ editions",
	"mb_make_appointment":"Make appointment",
	"mb_model":"Model",
	"mb_more_options":"More options",
	"mb_move_to_myvehicles":"Mark as purchased",
	"mb_my_recent_history_":"My enquiries",
	"mb_my_saved_configs":"My saved configurations",
	"mb_not_buildable":"The configuration you have requested can no longer be built.",
	"mb_not_buildable_infoicon":"You can delete your configuration or start the Configurator and find out which elements of your configuration can no longer be built. It may only be a few of its minor details.",
	"mb_original_bmw_accessories":"Genuine BMW accessories",
	"mb_output":"Power output",
	"mb_output_unit":"kW (PS)",
	"mb_packages":"Packages",
	"mb_paint":"Colour",
	"mb_preferred_number":"Preferred telephone number",
	"mb_preferred_number_readonly":"This is your preferred telephone number.",
	"mb_q_delete_config":"Do you want to permanently delete this configuration?",
	"mb_request_brochure":"Request brochure",
	"mb_request_offer":"Request offer",
	"mb_request_test_drive":"Arrange test drive",
	"mb_rim":"Wheels",
	"mb_sort_by":"Sort by",
	"mb_sort_by_body":"Vehicle type",
	"mb_sort_by_change_date":"Date of change",
	"mb_sort_by_model":"Model",
	"mb_transmission":"Transmission",
	"mb_trim":"Trim",
	"mb_upholstery":"Upholstery",
	"mb_comment_no_specialchars":"This box may not contain the following characters: < or >.",
	"mb_comment_required":"Please enter a message.",
	"mb_povs_ErrMsgUnknownVIN":"VIN does not exist.",
	"mb_textarea_max_length":"Please enter a message of no more than 750 characters.",
	"mb_myconfig_note":"Name of your configuration*",
	"mb_myconfig_note_hint":"You can create a new name for your configuration or use this suggestion.",
	"mb_myconfig_note_missing":"No Message displayed",
	"mb_myconfig_save_garage_full":"All of your slots are occupied. Please delete one of your configurations.",
	"mb_myconfig_save_load_error":"An error occured while loading your configuration.",
	"mb_myconfig_save_moreoptions_headline":"Additional options",
	"mb_myconfig_save_primary_changeable":"Add to my selection\u00A0",
	"mb_myconfig_save_primary_fix":"This is your preferred configuration",
	"mb_myconfig_save_configemailcheckbox_text":"Send this configuration to my e-mail address.",
	"mb_myconfig_save_requestforoffer_text":"[INSERT YOUR CONTENT] \nI would also like a non-binding offer for this configuration to be sent to the postal address registered on \u2018My BMW\u2019.",
	"mb_myconfig_save_save_as":"Save new configuration",
	"mb_myconfig_save_save_error":"An error occured while saving your configuration.",
	"mb_myconfig_save_save_overwrite":"Overwrite configuration",
	"mb_myconfig_save_textareacounter_msg":"You still have n characters left.",
	"mb_myconfig_save_usernote_already_used":"The selected name has already been assigned.",
	"mb_myconfig_save_usernote_empty":"Please enter a name for your configuration.",
	"mb_myconfig_save_usernote_illigal_chars":"The name for your configuration must not contain special characters.",
	"mb_myconfig_selector_delete_message":"All storage spaces for your configurations are taken. Please delete one of your configurations.",
	"mb_personalid_invalid":"Invalid Personal ID",
	"mb_view_vehcile_details":"Show details"};
            var msgs_MB = {
};
            var msgs_em = {
};
            var msgs_EM = {
	"EM_Global_VIN_already_used":"VIN already in use",
	"EM_Global_VIN_invalid":"VIN  invalid",
	"EM_Global_VIN_unknown":"VIN unknown",
	"EM_Global_VIN_not_matching_brand_series_model":"Brand and Series do not match VIN.",
	"EM_MyBMW_MyVehicles_Name_missing":"Please enter a name for your BMW.",
	"EM_MyBMW_MyVehicles_Illegal_characters":"The name of your vehicle may not contain special characters.",
	"EM_MyBMW_MyVehicles_Usernote_already_used":"The selected name has already been assigned.",
	"EM_lengthBetween":"EM_lengthBetween",
	"EM_INVALID_CAPTCHA_SOLUTION":"Please enter the displayed string of characters.",
	"EM_INVALID_OLD_PASSWORD":"INVALID_OLD_PASSWORD",
	"EM_UM_0000":"An unexpected error has occured.",
	"EM_UM_0201":"If \'No purchase planned\' is set, \'Planned purchase\' must not be filled.",
	"EM_UM_9000":"Data validation exceptions have occurred.",
	"EM_UM_ADDRESS_POSTAL_CODE_CITY_DONT_MATCH":"Your postcode and postal town or city do not match.",
	"EM_UM_ADDRESS_VALIDATION_INCOMPLETE":"Please enter your complete address.",
	"EM_UM_ADDRESS_VALIDATION_INVALID":"Address could not be validated, but you may save it if you wish.",
	"EM_UM_GCDM_AUTH_NOT_AUTHENTICATED":"Login not successful. Please check what you have entered.",
	"EM_UM_GCDM_AUTH_ACCOUNT_NOT_ACTIVATED":"Your access to My BMW has not been activated yet. Please request another activation e-mail.",
	"EM_UM_GCDM_AUTH_PASSWORD_EXPIRED":"Your password has expired and needs to be changed.",
	"EM_UM_GCDM_AUTH_ADMIN_LOCKED":"Access has been denied due to the account being locked.",
	"EM_UM_FORBIDDEN":"Field is forbidden for this market. No input possible.",
	"EM_UM_GENERALERROR_UPLOADEDIMAGE":"The uploaded image could not be processed.",
	"EM_UM_INVALID_ENUM":"Field value is not part of the valid enumerations.",
	"EM_UM_MANDATORY":"Field is mandatory. Please fill in.",
	"EM_UM_MISSING_UPLOADEDIMAGE":"Missing uploaded image for the impulse user.",
	"EM_UM_REGEX_VIOLATION":"Field value does not match a required regular expression.",
	"EM_UM_USER_ALREADY_REGISTERED":"UM_USER_ALREADY_REGISTERED",
	"EM_UM_SIZE_MAX_VIOLATION":"Field value is greater than the allowed max size.",
	"EM_UM_SIZE_UPLOADEDIMAGE":"The uploaded image is too large.",
	"EM_UM_V_profile_birthday_future":"Day of birth is in the future.",
	"EM_UM_V_profile_birthday_too_young":"Day of birth is too late.",
	"EM_UM_V_XSS":"This box may not contain the following characters: < or >.",
	"EM_UM_WRONG_IMAGE_FORMAT":"Only formats GIF, PNG and JPG are allowed.",
	"EM_UM_GCDM_1014-101":"Your authentication information is missing or invalid.",
	"EM_UM_GCDM_1014-102":"Sorry, your account is locked.",
	"EM_UM_GCDM_1014-103":"Sorry, you don\'t have the right to access this area.",
	"EM_UM_GCDM_1014-300":"The entity attached to the request could not be successfully validated. The entity in the response contains further information about the validation result:",
	"EM_UM_GCDM_EMPTY":"A provided value is empty where a non-empty value is expected.",
	"EM_UM_GCDM_ILLEGAL_CHARACTERS":"This box may not contain the following characters: <, >, \'\'or \'.",
	"EM_UM_GCDM_INVALID_FORMAT":"Entered value has the wrong format.",
	"EM_UM_GCDM_INVALID_KEY":"This value is not available for this field.",
	"EM_UM_GCDM_INVALID_REFERENCE":"Please add a valid reference.",
	"EM_UM_GCDM_NOT_EMPTY":"Field is forbidden for this market. No input possible.",
	"EM_UM_GCDM_NOT_UNIQUE":"Field value is invalid.",
	"EM_UM_GCDM_PASSWORD_COMPLEXITY":"This password does not comply with the valid password policy.",
	"EM_UM_GCDM_PASSWORD_HISTORY":"This password has been used before.",
	"EM_UM_GCDM_TOO_LARGE":"Field value is larger than expected.",
	"EM_UM_GCDM_TOO_LONG":"Field value is too large.",
	"EM_UM_GCDM_TOO_SHORT":"Field value is too short.",
	"EM_UM_GCDM_TOO_SMALL":"Field value is shorter than expected."};

            // DEPRECATED! Left here for compatibility reasons only.
            // Avoid to insert messages here. Better create a key prefixed with 'mb_' and let it
            // be inserted automatically!
            var messages = {

                // GENERAL VALIDATORS
                requiredValue:msgs_mb['mb_field_required'],
                requiredRadio:msgs_mb['mb_field_required'],
                requiredCheckbox:msgs_mb['mb_field_required'],
                email:msgs_mb['mb_invalid_email'],

                // personalId
                syntaxPersonalIdInvalid:msgs_mb['mb_personalid_invalid'],

                // NUMERIC
                integer:msgs_mb['mb_integer'],

                // DATES
                noPartialDate:'Date incomplete.',
                dateMustBeInFuture:msgs_mb['mb_dateInPast'],

                // ADDRESSES
                "profile.addresses.companyName#requiredValue":msgs_mb['mb_profile_company_name_required'],
                "profile.addresses.street#requiredValue":msgs_mb['mb_profile_street_required'],
                "profile.addresses.streetNumber#requiredValue":msgs_mb['mb_profile_street_number_required'],
                "profile.addresses.postalCode#requiredValue":msgs_mb['mb_profile_postal_code_required'],
                "profile.addresses.city#requiredValue":msgs_mb['mb_profile_city_required'],
                "addressCannotBeValidated":msgs_mb['mb_address_addressCannotBeValidated'],
                "addressZipCityDoNotMatch":msgs_mb['mb_address_addressZipCityDoNotMatch'],
                "addressUnknownButSaveable":msgs_mb['mb_address_addressUnknownButSaveable'],
                "addressInvalid":msgs_mb['mb_address_addressInvalid'],

                // SPECIFIC FIELD VALIDATORS
                "profile.salutation#requiredRadio":msgs_mb['mb_profile_salutation_required'],
                "profile.firstname#requiredValue":msgs_mb['mb_profile_firstname_required'],
                "profile.lastname#requiredValue":msgs_mb['mb_profile_lastname_required'],
                "account.confirmPassword#equalInput":msgs_mb['mb_profile_confirm_equal'],
                "account.login#email":msgs_mb['mb_profile_email_not_valid'],

                // CHANGE PASSWORD FORM
                "user.oldPassword#requiredValue":'Please enter your current password',
                "user.newPassword#requiredValue":'Please enter your new password',
                "user.confirmPassword#requiredValue":'Please repeat your Passwort',
                "user.confirmPassword#equalInput":'The new password does not match the repeated password',
                
                // COMMUNICATIONSFS
                "atLeastOneCommRequired":msgs_mb['mb_profile_any_phone_required'],

                // PLANNEDPURCHASEFS
                "vin":msgs_mb['mb_povs_ErrMsgInvalidVIN'],
                
                // TEXT AREA
                "textareaRequiredValue":msgs_mb['mb_comment_required'],
                "textareaMaxLength":msgs_mb['mb_textarea_max_length'],
                "textareaSpecialChars":msgs_mb['mb_comment_no_specialchars'],
                
                //CAPTCHAFS
                "captcha#requiredValue":msgs_mb['mb_profile_reCaptcha_required'],
                
                // POLICIES
                "policyCurrent_RFI":msgs_mb['mb_field_required'],
                "policyCurrent_CONTACT":msgs_mb['mb_field_required'],
                "policyCurrent_RFA":msgs_mb['mb_field_required'],
                "policyCurrent_RFO":msgs_mb['mb_field_required'],
                "policyCurrent_TDA":msgs_mb['mb_field_required'],
                
                //BIRTHDAY
                "profile.birthday#noPartialDate":msgs_mb['mb_profile_birthday_no_partial_date'],
                
                // VEHICLES
                "vehicle.mileage#integer":'Invalid mileage',
                "vehicle.mileage#maximum":'Invalid mileage',
                "vehicle.mileage#minimum":'Invalid mileage',
                "vehicle.initialRegistration#notBeforeModelYear":'The date of the initial registration has to be later than the model year.',
                "tradeInVehicle.mileage#integer":'Invalid mileage',
                "tradeInVehicle.mileage#maximum":'Invalid mileage',
                "tradeInVehicle.mileage#minimum":'Invalid mileage',
                "tradeInVehicle.initialRegistration#notBeforeModelYear":'The date of the initial registration has to be later than the model year.',
                "nbgv.mileage#integer":'Invalid mileage',
                "nbgv.mileage#maximum":'Invalid mileage',
                "nbgv.mileage#minimum":'Invalid mileage',
                "nbgv.initialRegistration#notBeforeModelYear":"The date of the initial registration has to be later than the model year.",
                "currentVehicle.mileage#integer":'Invalid mileage',
                "currentVehicle.mileage#maximum":'Invalid mileage',
                "currentVehicle.mileage#minimum":'Invalid mileage',
                "currentVehicle.initialRegistration#notBeforeModelYear":'The date of the initial registration has to be later than the model year.',

                // CHANGE LOGIN
                "user.newLogin#requiredValue":'Please enter your new email address',
                "user.newLogin#notEqualInput":'Please enter your new email address',
                "user.newLogin#email":msgs_mb['mb_profile_email_not_valid'],
                
                // IMPULSE IMAGE UPLOAD
                "impulse_upload_image_succes":'impulse_upload_image_succes',

                // SALESBAR BUTTONS
                "salesbar_button_tda":'\u9884\u7EA6\u8BD5\u9A7E',
                "salesbar_button_tda_dealer":'salesbar_button_label_tda_dealer',
                "salesbar_button_rfa":'Request a accessory',
                "salesbar_button_rfi":'\u7D22\u53D6\u4EA7\u54C1\u624B\u518C',
                "salesbar_button_rfo":'\u54A8\u8BE2\u62A5\u4EF7',
                "salesbar_button_rfp":'\u8F66\u578B\u4EF7\u683C\u548C\u9500\u552E\u54A8\u8BE2',
                "salesbar_button_rfs":'salesbar_button_label_rfs',
                "salesbar_button_dlo_bmw":'\u67E5\u627E\u7ECF\u9500\u5546',
                "salesbar_button_dlo_bmwi":'\u67E5\u627EBMW i \u5408\u4F5C\u4F19\u4F34',
                "salesbar_button_rfc_stay_informed":'\u54A8\u8BE2\u9500\u552E\u4FE1\u606F',
                "salesbar_button_rfc_campagne":'salesbar_button_label_rfc_campagne',
                "salesbar_button_rfc_contact_dealer":'\u67E5\u627E\u7ECF\u9500\u5546',
                "salesbar_button_save_config":'Save configuration',
                "salesbar_button_show_configs":'Show configuration',
                "salesbar_button_ncc":'\u5B9A\u5236\u4F60\u7684BMW',
                "salesbar_button_ncc_visualizer":'salesbar_button_label_ncc_visualizer',
                "salesbar_button_my_vehicles":'My vehicles',
                "salesbar_button_esp_start":'salesbar_button_label_esp_start',
                "salesbar_button_esp_continue":'salesbar_button_label_esp_continue'
            };

            (function upperCaseKeys() {
                var uppercaseKey, key;
                for (key in messages) {
                    uppercaseKey = key.toUpperCase();
                    var message = messages[key];
                    delete messages[key];
                    messages[uppercaseKey] = message;
                }
                for(key in msgs_mb) {
                    uppercaseKey = key.toUpperCase();
                    messages[uppercaseKey] = msgs_mb[key];
                }
                for(key in msgs_MB) {
                    uppercaseKey = key.toUpperCase();
                    messages[uppercaseKey] = msgs_MB[key];
                }
                for(key in msgs_em) {
                    uppercaseKey = key.toUpperCase();
                    // if we find a duplicate key (i.e. 'mb_bla' and 'EM_bla', we raise an exception)
                    if(messages.hasOwnProperty(uppercaseKey)) {
                      throw 'Duplicate message key: MB_' + uppercaseKey + ' and em_' + uppercaseKey + '!';
                    }
                    messages[uppercaseKey] = msgs_em[key];
                }
                for(key in msgs_EM) {
                    uppercaseKey = key.toUpperCase();
                    // if we find a duplicate key (i.e. 'mb_bla' and 'EM_bla', we raise an exception)
                    if(messages.hasOwnProperty(uppercaseKey)) {
                        throw 'Duplicate message key: MB_' + uppercaseKey + ' and EM_' + uppercaseKey + '!';
                    }
                    messages[uppercaseKey] = msgs_EM[key];
                }
            })();

            /*
             Create possible message-keys for this key.
             Example: key= user.profile.phone#syntax
             1. MB_USER_PROFILE_PHONE_SYNTAX
             2. MB_PROFILE_PHONE_SYNTAX
             3. MB_PHONE_SYNTAX
             4. MB_SYNTAX
             */
            function generateMessageSearchKeysImpl(messageKey) {
                var messageSearchKeys = [];

                var keyParts = messageKey.toUpperCase().split('#');
                var ucKey = keyParts[0];
                // match to all types of requiredValue, requiredCheckbox,...
                if(keyParts.length > 1) {
                    ucKey += keyParts[1].match('^REQUIRED') ? '_REQUIRED' :  '_' + keyParts[1];
                }
                // replace all dots within the key by underscores
                keyParts = ucKey.replace(/\./g,'_').split('_');
                // cut off left part of key and try to match
                for(var i = 0; i < keyParts.length; i++) {
                    var k = '';
                    for(var j = i; j < keyParts.length; j++) {
                        k += '_' + keyParts[j];
                    }
                    messageSearchKeys.push('EM' + k);
                    messageSearchKeys.push('MB' + k);
                }

                return messageSearchKeys;
            }

            /*
                Do a 'cascading find' over the keys within messages.
                Example: key= user.profile.phone#syntax
                1. MB_USER_PROFILE_PHONE_SYNTAX
                2. MB_PROFILE_PHONE_SYNTAX
                3. MB_PHONE_SYNTAX
                4. MB_SYNTAX
             */
            function getMessage(key) {
                var messageSearchKeys = generateMessageSearchKeysImpl(key);
                if(messageSearchKeys && messageSearchKeys.length > 0) {
                    for(var i = 0; i < messageSearchKeys.length; i++) {
                        if(messages.hasOwnProperty(messageSearchKeys[i]) && messages[messageSearchKeys[i]] != null) {
                            return messages[messageSearchKeys[i]];
                        }
                    }
                }

                // if new key cascading did not find a matching key, we fall back to old key handling
                return messages[key.toUpperCase()];
            }

            function setMessage(key, message) {
                messages[key.toUpperCase()] = message;
            }

            return {
                addMessage: function(key, message) {
                    setMessage(key, message);
                },
                /**
                 * Translates a given error key to an internationalised error message. errorKey can be case-insensitive!
                */
                translate : function(messageKey) {
                    if (messageKey == null) {
                        throw "[rlTranslator]: Invoking translate with null or undefined messageKey. Check your code.";
                    }
                    return getMessage(messageKey) || "NO_MESSAGE_DEFINED[key=" + messageKey + "]";
                },
                /**
                 * Translate an array of error keys, but only return the first(!) matching error message
                 */
                translateFirstFound: function(messageKeys) {
                    for (var i = 0; i < messageKeys.length; i++) {
                        var messageKey = messageKeys[i];
                        var message = getMessage(messageKey);

                        if (message != null) return message;
                    }
                    return "NO_MESSAGES_DEFINED[keys=" + messageKeys + "]";
                },
                generateMessageSearchKeys: function (messageKey) {
                    return generateMessageSearchKeysImpl(messageKey);
                },
                getMessageBySearchKey: function(messageSearchKey) {
                    return messageSearchKey ? messages[messageSearchKey.toUpperCase()] : undefined;
                }
            }
        }();


// if the code changed please update the formatterImpl.js from test
var rlFormatter = function() {
  
  /** Utility method for padding a string with zeroes, e.g. pad("X", 4) => "000X" */
  function pad(str, len) {
    if (typeof str === "number") {
      str = "" + str;
    }
    while (str.length < len) {
      str = "0" + str;
    }
    return str;
  }
  
  /** Formats a date. */
  function formatDate(date, fmt) {
  
    // Date components we'll be working with
    var year = date.getFullYear(),
        mo = date.getMonth() + 1,
        dy = date.getDate(),
        hr = date.getHours(),
        mn = date.getMinutes(),
        sc = date.getSeconds(),
        amPmLong = date.getHours() >= 12 ? rlFormatter.AMPM_LONG[1] : rlFormatter.AMPM_LONG[0],
        amPmShort = date.getHours() >= 12 ? rlFormatter.AMPM_SHORT[1] : rlFormatter.AMPM_SHORT[0],
        wd = date.getDay();
        
    // Map of format placeholder => value entries
    var map = {
      "yyyy": year,
      "yy": pad(year % 100, 2),
      "MMMM": rlFormatter.MONTHNAMES_LONG[date.getMonth()],
      "MMM": rlFormatter.MONTHNAMES_SHORT[date.getMonth()],
      "MM": pad(mo, 2),
      "M": mo,
      "dddd": rlFormatter.DAYNAMES_LONG[wd],
      "ddd": rlFormatter.DAYNAMES_SHORT[wd],
      "dd": pad(dy, 2),
      "d": dy,
      
      "HH": pad(hr, 2),
      "H": hr,
      "hh": pad(hr%12, 2),
      "h": hr==12 ? 12 : hr%12,
      "mm": pad(mn, 2),
      "m": mn,
      "ss": pad(sc, 2),
      "s": sc,
      "tt": amPmLong,
      "t": amPmShort
    };
    var sortedMapKeys = [
      "yyyy", "yy", "MMMM", "MMM", "MM", "M", "dddd", "ddd", "dd", "d",
      "HH", "H", "hh", "h", "mm", "m", "ss", "s", "tt", "t"
    ];
    
    // We're done here
    return replacePlaceholders(fmt, map, sortedMapKeys);
  }
  
  /**
   * Converts a format string by sequentially identifying and replacing
   * placeholders as defined in the placeholder map.
   */
  function replacePlaceholders(fmt, map, sortedMapKeys) {
    var from = fmt, to = "";
    while (from.length > 0) {
      var found = false;
      
      for (var i=0; i<sortedMapKeys.length; i++) {
        var key = sortedMapKeys[i];
        var val = map[key];
        if (from.substring(0, key.length) === key) {
          from = from.substring(key.length);
          to += val;
          found = true;
          break;
        }
      }
      
      if (!found) {
        to += from.substring(0, 1);
        from = from.substring(1);
      }
    }
    return to;
  }
  
  /**
   * Formats a number. Implementation liberated/adapted from:
   * http://www.queness.com/post/9806/5-missing-javascript-number-format-functions
   */
  function formatNumber (number, decimals, addThousandsSeparators) {
    var dec_point = rlFormatter.NUMBER_DECIMALSEPARATOR;
    var thousands_sep = rlFormatter.NUMBER_THOUSANDSSEPARATOR;
    
    number = (number + '').replace(/[^0-9+-Ee.]/g, '');
    var n = !isFinite(+number) ? 0 : +number,
        prec = !isFinite(+decimals) ? 0 : Math.abs(decimals),
        sep = (typeof thousands_sep === 'undefined') ? ',' : thousands_sep,
        dec = (typeof dec_point === 'undefined') ? '.' : dec_point,
        s = '',
        toFixedFix = function (n, prec) {
            var k = Math.pow(10, prec);
            return '' + Math.round(n * k) / k;
        };
    // Fix for IE parseFloat(0.55).toFixed(0) = 0;
    s = (prec ? toFixedFix(n, prec) : '' + Math.round(n)).split('.');
    if (addThousandsSeparators) {
      if (s[0].length > 3) {
        s[0] = s[0].replace(/(?=(?:\d{3})+(?!\d))/g, sep);
        if (s[0].substring(0, 1) == sep) {
          s[0] = s[0].substring(1);
        }
    }
    }
    if ((s[1] || '').length < prec) {
        s[1] = s[1] || '';
        s[1] += new Array(prec - s[1].length + 1).join('0');
    }
    return s.join(dec);
  }

  function formatNameImpl (user, options) {
    options = options || {};
    if(!user) return null;
    user.profile = user.profile || {};

    var name = '';
    function appendToName(val) {
      return (name += (name != '' && jq.trim(val) != '') ? ' ' + jq.trim(val) : jq.trim(val));
    }

    (options.useSalutation === true) && appendToName(user.salutation);
    (name === appendToName(user.firstName)) && appendToName(user.profile.initials);

    appendToName(user.lastName);
    appendToName(user.profile.additionalFamilyName);

    return (jq.trim(name) != '') ? name : null;
  }

/** Public interface */
  return {
    formatDate: function(date) {
      return formatDate(date, rlFormatter.DATE_FORMAT);
    },
    formatDateTime: function(date) {
      return formatDate(date, rlFormatter.DATETIME_FORMAT);
    },
    formatMonthYear: function(date) {
      return formatDate(date, rlFormatter.DATE_MONTHYEAR_FORMAT);
    },
    formatTime: function(date) {
      return formatDate(date, rlFormatter.TIME_FORMAT);
    },
    formatNumber: function(num, decimals, addThousandsSeparators) {
      return formatNumber(num, decimals, addThousandsSeparators);
    },
    formatName: function(user, options) {
      return formatNameImpl(user, options);
    }
};
}();

rlFormatter.TIME_FORMAT = "HH:mm";
rlFormatter.DATE_FORMAT = "dd.MM.yyyy";
rlFormatter.DATETIME_FORMAT = "dd.MM.yyyy HH:mm";
rlFormatter.DATE_MONTHYEAR_FORMAT = "MM/yyyy";
rlFormatter.DATE_ENDIANNESS = "little";

rlFormatter.DAYNAMES_LONG = "Sonntag,Montag,Dienstag,Mittwoch,Donnerstag,Freitag,Samstag".split(",");
rlFormatter.DAYNAMES_SHORT = "So,Mo,Di,Mi,Do,Fr,Sa".split(",");
rlFormatter.MONTHNAMES_LONG = "Januar,Februar,März,April,Mai,Juni,Juli,August,September,Oktober,November,Dezember".split(",");
rlFormatter.MONTHNAMES_SHORT = "Jan,Feb,Mär,Apr,Mai,Jun,Jul,Aug,Sep,Okt,Nov,Dez".split(",");
rlFormatter.AMPM_LONG = "am,pm".split(",");
rlFormatter.AMPM_SHORT = "a,p".split(",");

rlFormatter.NUMBER_DECIMALSEPARATOR = ",";
rlFormatter.NUMBER_THOUSANDSSEPARATOR = ".";


 

  rlFormatter.formatName = function(user, options) {
    options = options || {};
    if(!user) return null;
    user.profile = user.profile || {};

    var name = '';
    function appendToName(val) {
      return (name += (name != '' && jq.trim(val) != '') ? ' ' + jq.trim(val) : jq.trim(val));
    }

    (options.useSalutation === true) && appendToName(user.salutation); (name === appendToName(user.firstName)) && appendToName(user.profile.initials); appendToName(user.lastName); appendToName(user.profile.additionalFamilyName);

    return (jq.trim(name) != '') ? name : null;
  };


  var cfSearchQueryBarLabel = '';  
  var searchPagePath = '';
  var externalSearchPagePath = '';
  var cfMinCharAutoSuggest = '3';  
  var cfMinCharLiveSearch = '3'; 
  var cfNumLiveSearchResults = '3';
  var cfNumAutoSuggestResults = '3';
  var cfNumResultsInPage = '';  
  var cfTextAutosuggestTitle = '';
  var cfTextLiveSearchTitle = '';  
    
  var cfMsgErrorNoResultsHeadline = '';
  var cfMsgErrorNoResultsFirstLine = '';
  var cfMsgErrorNoResultsSecondLine = '';
  var cfMsgSearchEngineTechnicalError = '';
  var cfMsgSearchResultStatistics = '';
  var cfMsgSearchResultsStatistics = '';
  var cfMsgTellafriendEngineTechnicalError = '';
  var cfGsaBaseUrl = '/crossfunctions-searchintegration-service/services';
  var cfGsaAsrUrl = '/crossfunctions-searchintegration-service/services/asr';  
  
  var cfFilterByHeadline = 'No Message displayed';
  var cfClearFilterLinkName = 'Reset filter';  
  var searchEngineSuggestLabel = 'Did you mean ?';  
 

var cookieControllerList = {"cookies":[{"key":"backToDealer","expiry":null,"needsConsent":true},{"key":"languageCookie","expiry":31536000000,"needsConsent":true},{"key":"sessionDisclaimer","expiry":null,"needsConsent":false},{"key":"bmwcsaP3P","expiry":630720000000,"needsConsent":false},{"key":"bmwcsaP4P","expiry":630720000000,"needsConsent":false},{"key":"vinToolUnsavedVehicles","expiry":null,"needsConsent":false},{"key":"vehiclesSortBy","expiry":null,"needsConsent":false},{"key":"configsSortBy","expiry":null,"needsConsent":false},{"key":"cookieDisclaimer","expiry":31536000000,"needsConsent":false},{"key":".*FSComponent","expiry":null,"needsConsent":true},{"key":"saves tab navigation cookie, the cookie name is the component\n      ID","expiry":null,"needsConsent":true},{"key":"bmwWorkflowHash","expiry":null,"needsConsent":false},{"key":"LOGGEDIN","expiry":7200000,"needsConsent":false},{"key":"SMSESSION","expiry":7200000,"needsConsent":false},{"key":"visitorid","expiry":126144000000,"needsConsent":true},{"key":"bmwcsakey","expiry":null,"needsConsent":false},{"key":"bmwcsaDBID","expiry":157680000000,"needsConsent":false},{"key":"bmwcsauvt","expiry":2678400000,"needsConsent":false},{"key":"usy46gabsosd","expiry":null,"needsConsent":false},{"key":"bmwcsaCDuvt","expiry":2678400000,"needsConsent":false},{"key":"vtz47gabsosd","expiry":null,"needsConsent":false},{"key":"bmwcsaCDID","expiry":null,"needsConsent":false},{"key":"consentCookie","expiry":31536000000,"needsConsent":false},{"key":"espBasket","expiry":null,"needsConsent":false},{"key":"baoManualDisclaimer","expiry":null,"needsConsent":false},{"key":"diagnosticsBox","expiry":null,"needsConsent":false},{"key":"debugJs","expiry":null,"needsConsent":false},{"key":"vehicleManualTestPage","expiry":null,"needsConsent":false},{"key":"wcmModeGlobalUrls","expiry":null,"needsConsent":false},{"key":"randomiseGlobalUrls","expiry":null,"needsConsent":false},{"key":"randomiseJavascriptUrls","expiry":null,"needsConsent":false},{"key":"coreLogging","expiry":null,"needsConsent":false},{"key":"coreLoggingUsername","expiry":null,"needsConsent":false},{"key":"espPriceNotification","expiry":null,"needsConsent":false}]};
var cookieRegulation = { policy: 'NONE', timestamp: 1447874565536 };

