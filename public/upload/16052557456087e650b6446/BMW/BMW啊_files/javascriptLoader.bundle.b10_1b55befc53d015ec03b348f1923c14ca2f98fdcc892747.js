var rlESPButton=function(){function B(){if(C()!=="SHOW"){return }ncc.isConfigurationComplete({onComplete:A,onIncomplete:function(){}})}function A(){if(rlEspBasket.getCurrentInstance().isActive()){E()}else{D()}}function C(){var F=rlContextObject.getContextObject();if(F.page.isNCC&&F.vehicle.ESP){return"SHOW"}else{return"HIDE"}}function E(){var G=rlEspBasket.getCurrentInstance();var H=rlContextObject.getContextObject().vehicle;var F=G.addBasketIdToURL(GLOBAL_ESP_ORDER_PAGE_URL,true);F=G.addConfigIdToURL(F,H.configId,true);F=G.addPublicConfigIdToURL(F,H.publicConfigId,true);document.location.href=F}function D(){rlComponentLoader.requireComponentWithDeferredExec("espProcessOverview",function(){rlEspProcessOverview.openLayer()})}return{__init__:function(){},__start__:function(){},getLabel:function(){if(rlEspBasket.getCurrentInstance().isActive()){return rlTranslator.translate("salesbar_button_esp_continue")}return rlTranslator.translate("salesbar_button_esp_start")},getStatus:C,click:B,isEspActive:function(){return rlEspBasket.getCurrentInstance().isActive()}}}();var rlNCCButton=function(){function A(){if(B()==="SHOW"){var C=rlContextObject.getContextObject();var K=C.vehicle.modelRangeId;var G=C.page.market;var E=C.page.brand;var F=C.page.country;var J=C.page.locale;var H=C.vehicle.configId;var I="";I="/cn/zh/general/h5vco/index.html";if(K!=undefined){I+="?modelRange="+K}var D=GLOBAL_COUNTRY_SERVER+I;console.log("NCCButton: Forwarding to Ncc with url "+D);window.location.href=D}}function B(){var D=rlContextObject.getContextObject();var C=D.page.isNCC;if(C){return"HIDE"}if(D.page.isDealer===true){if("SE"===D.outlet.outletType){return"HIDE"}else{return"SHOW"}}else{return"SHOW"}}return{__init__:function(){},__start__:function(){},getLabel:function(){if(rlContextObject.getVehicleVisualizer()){return rlTranslator.translate("salesbar_button_ncc_visualizer")}else{return rlTranslator.translate("salesbar_button_ncc")}},getStatus:function(){return B()},click:function(){A()}}}();var rlRFIButton=function(){function A(){if(B()==="SHOW"){var D={};var C=rlContextObject.getContextObject();D.configId=C.vehicle.configId;D.bodyTypeId=C.vehicle.bodyTypeId;D.modelRangeId=C.vehicle.modelRangeId;D.seriesId=C.vehicle.seriesId;rlUserDialog.showRequestRFI(D)}}function B(){var C=rlContextObject.getContextObject();if(C.page.isDealer===true){if("SE"===C.outlet.outletType){return"HIDE"}else{return"SHOW"}}else{if(C.vehicle.RFI==undefined){return"SHOW"}else{return(C.vehicle.RFI===true)?"SHOW":"HIDE"}}}return{__init__:function(){},__start__:function(){},getLabel:function(){return rlTranslator.translate("salesbar_button_rfi")},getStatus:function(){return B()},click:function(){A()}}}();var rlRFOButton=function(){function A(){var H={};var D=rlContextObject.getContextObject();var I=D.vehicle.configId;var L=D.vehicle.modelRangeId;var G=D.page.market;var E=D.page.brand;var F=D.page.country;var K=D.page.locale;var J="";var C="&brand="+E+"&country="+F+"&market="+G+"&locale="+K+"&entryType=rfo";rlUserDialog.showRequestRFO(H)}function B(){var C=rlContextObject.getContextObject();var E=C.vehicle.configId;var D=C.vehicle.modelRangeId;if(C.page.isDealer===true){return"HIDE"}else{if(C.vehicle.RFO===undefined){return"WAIT"}else{if(C.vehicle.RFO===false){return"HIDE"}else{if(E!=undefined&&E!=""){return"SHOW"}if(D!=undefined&&D!=""){return"SHOW"}}}}return"HIDE"}return{__init__:function(){},__start__:function(){},getLabel:function(){return rlTranslator.translate("salesbar_button_rfo")},getStatus:function(){return B()},click:function(){A()}}}();var rlRFPButton=function(){function A(){if(B()==="SHOW"){var H={};var D=rlContextObject.getContextObject();var I=D.vehicle.configId;var L=D.vehicle.modelRangeId;var G=D.page.market;var E=D.page.brand;var F=D.page.country;var K=D.page.locale;var J="";var C="&brand="+E+"&country="+F+"&market="+G+"&locale="+K+"&entryType=rfo";if(I!=undefined&&I!=""){H.configId=D.vehicle.configId;rlUserDialog.showRequestRFP(H)}else{if(L!=undefined&&L!=""){J="/vc/ncc/xhtml/start/startEngineSelectionWithParams.faces?productType=1";J+="&modelRangeId="+L;J+=C;window.location.href=J}else{}}}}function B(){var D=rlContextObject.getContextObject();var E=D.vehicle.modelRangeId;var F=D.vehicle.configId;var G=D.vehicle.seriesId;if(G){G=G.toUpperCase()}var C=D.page.brandSubbrand;if(D.page.isDealer===true){return"HIDE"}else{if(D.vehicle.RFP===undefined){return"WAIT"}else{if(D.vehicle.RFP===false){return"HIDE"}else{if(G!="I"&&C!="brand-bmwi"){return"HIDE"}if(F!=undefined&&F!=""){return"SHOW"}if(E!=undefined&&E!=""){return"SHOW"}}}}return"HIDE"}return{__init__:function(){},__start__:function(){},getLabel:function(){return rlTranslator.translate("salesbar_button_rfp")},getStatus:function(){return B()},click:function(){A()}}}();var rlSaveConfigButton=function(){function A(){if(B()==="SHOW"){var D={};var C=rlContextObject.getContextObject();D.configId=C.vehicle.configId;rlUserDialog.showNccSave(D)}}function B(){var C=rlContextObject.getContextObject();if(C.page.isDealer===true){return"HIDE"}if(C.vehicle.configId===undefined){return"WAIT"}else{if(C.vehicle.configId===""){return"HIDE"}else{if(rlContextObject.getIsSOC()){return"HIDE"}else{if(C.page.isNCC){return"SHOW"}}}}return"HIDE"}return{__init__:function(){},__start__:function(){},getLabel:function(){return rlTranslator.translate("salesbar_button_save_config")},getStatus:function(){return B()},click:function(){A()}}}();var rlShowConfigsButton=function(){function A(){if(B()==="SHOW"){rlUserDialog.showConfigSelector()}}function B(){if(rlContextObject.getPersoContextId()==="myconfigurations"||rlContextObject.getIsNCC()){return"SHOW"}else{return"HIDE"}}return{__init__:function(){},__start__:function(){},getLabel:function(){return rlTranslator.translate("salesbar_button_show_configs")},getStatus:function(){return B()},click:function(){A()}}}();var rlTDAButton=function(){function A(){if(B()==="SHOW"){var D={};var C=rlContextObject.getContextObject();if(C.vehicle.configId!=undefined){D.configId=C.vehicle.configId}if(C.vehicle.bodyTypeId!=undefined){D.bodyType=C.vehicle.bodyTypeId}if(C.vehicle.modelRangeId!=undefined){D.modelRangeId=C.vehicle.modelRangeId}if(C.vehicle.seriesId!=undefined){D.seriesId=C.vehicle.seriesId}if(C.outlet.distributionPartnerId!=undefined){D.distributionPartnerId=C.outlet.distributionPartnerId}if(C.outlet.outletId!=undefined){D.outletId=C.outlet.outletId}rlUserDialog.showRequestTDA(D)}}function B(){var C=rlContextObject.getContextObject();if(C.page.isDealer===true){if(C.page.brandSubbrand==="brand-bmwi"){if(C.outlet.BI!=undefined){return C.outlet.BI.TDA?"SHOW":"HIDE"}}else{if(C.outlet.BM!=undefined){return C.outlet.BM.TDA?"SHOW":"HIDE"}}}else{if(C.vehicle.TDA===undefined){return"SHOW"}else{return C.vehicle.TDA?"SHOW":"HIDE"}}return"HIDE"}return{__init__:function(){},getLabel:function(){var C=rlContextObject.getContextObject();if(C.page.isDealer){label=rlTranslator.translate("salesbar_button_tda_dealer")}else{label=rlTranslator.translate("salesbar_button_tda")}return label},getStatus:function(){return B()},click:function(){A()}}}();var rlAbstractLayer=function(){function A(){var F=30;var E="abstractLayer";var D="#abstractLayer";var B="layerContent";var C={layer_show:function(){var I=arguments[0]||{};var J=arguments[1]||"false";var H=arguments[2]||"none";var G=jq('<div id="'+E+'"><div class="'+B+'"></div></div>');jq("body").append(G);jq(D).css("position","fixed");jq(D).css("z-index","10501");jq(D).css("padding","0");var K=0;if(J===""){jq(D).css("border","0")}else{if(J==="true"){jq(D).css("border","15px solid white");K=30}}switch(H){case"small":jq(I).prepend('<div class="spriteIconCloseSmall baseIconSizeSmall baseIconSprite"></div>');jq(I+" .spriteIconCloseSmall").css("position","absolute");jq(I+" .spriteIconCloseSmall").css("right","6px");jq(I+" .spriteIconCloseSmall").css("top","6px");jq(I+" .spriteIconCloseSmall").css("z-index","10502");break;case"big":jq(I).prepend('<div class="spriteIconCloseBig baseIconSizeBig baseIconSprite"></div>');jq(I+" .spriteIconCloseBig").css("position","absolute");jq(I+" .spriteIconCloseBig").css("right","6px");jq(I+" .spriteIconCloseBig").css("top","6px");jq(I+" .spriteIconCloseBig").css("z-index","10520");break;default:break}jq(I).appendTo(D+" ."+B);this.position_layer(K);jq(D).fadeTo(0,1)},layer_hide:function(){jq(D).fadeTo(0,0);window.setTimeout(function G(){jq(D).remove()},500)},position_layer:function(){var I=arguments[0]||0;var J=jq(window).width();var L=jq(window).height();var G=jq(D).width();var N=jq(D).height();var Q=(J-(F+I))/G;var K=(L-(F+I))/N;var P=null;var M=null;var H="";var O="";if(Q<1||K<1){if(Q<K){P=Q*G;M=Q*N;H="15px";O=(L-F-M)/2+"px"}else{P=K*G;M=K*N;H=(J-F-P)/2+"px";O="15px"}P=P+"px";M=M+"px";jq(D+" img:first").css("width",P);jq(D+" img:first").css("height",M)}else{H=(J-F-G)/2+"px";O=(L-F-N)/2+"px"}jq(D).css("left",H);jq(D).css("top",O)}};return C}abstractLayer=A();return{__init__:function(){}}}();var rlAbstractLayerImage=function(){function A(){var G=30;var C=30;var F="abstractLayer";var E="#abstractLayer";var B="layerContent";var D={showLayer:function(){var K=arguments[0]||{};var J=arguments[1]||"none";var H=jq('<div id="'+F+'"><div class="'+B+'"></div></div>');jq("body").append(H);var I=jq(E);var L=jq(K);L.appendTo(" ."+B,I).show();var N=null;var M=null;if(J==="small"&&jq(".closeButton",I).length<1){M="spriteIconCloseSmall baseIconSizeSmall baseIconSprite"}else{if(J==="big"&&jq(".closeButtonBig",I).length<1){M="spriteIconCloseBig baseIconSizeBig baseIconSprite"}}if(M!=null){N=jq("<div>").addClass(M);L.prepend(N)}I.fadeTo(0,1);if(jq("html").hasClass("ie7")||jq("html").hasClass("ie8")){jq(I).get(0).style.removeAttribute("filter")}},hideLayer:function(){window.setTimeout(function H(){jq(E).remove()},500)},getOriginalResolution:function(){var J=arguments[0]||"";var I=arguments[1]||"";var H=jq(E);if(J===""){J=H.data("originalWidth")}if(I===""){I=H.data("originalHeight")}if(!J){J=H.width();I=H.height();console.log("Original size of layer is "+J+"/"+I);H.data("originalWidth",J);H.data("originalHeight",I)}return{w:J,h:I}},positionLayer:function(){var H=arguments[0]||"";var N=arguments[1]||"";var K=jq(window).width();var M=jq(window).height();var O=this.getOriginalResolution(H,N);var I=O.w;var Q=O.h;var T=(K-(G+C))/I;var L=(M-(G+C))/Q;var S=null;var P=null;var J="";var R="";if(T<1||L<1){if(T<L){S=T*I;P=T*Q;J=G/2+"px";R=(M-G-P)/2+"px"}else{S=L*I;P=L*Q;J=(K-G-S)/2+"px";R=G/2+"px"}S=S+"px";P=P+"px";jq(E+" .abstractLayerContent").css("width",S);jq(E+" .abstractLayerContent").css("height",P)}else{J=(K-G-I)/2+"px";R=(M-G-Q)/2+"px"}jq(E).css("left",J);jq(E).css("top",R)}};return D}abstractLayerImage=A();return{__init__:function(){}}}();var rlAcceptedWebPolicyFS=function(){var A=function(B,F){var C=CoreFormsBase.inheritanceFrom(rlPolicyBaseFS.createFS(B,F));var E=C.parent;C.typeName="rlAcceptedWebPolicyFS";var D=rlAcceptedWebPolicyLegacyFS.createInstance(C,B,F);C.getValueRenderers=function(G){G.policyText=function(K,J,H,I){if(J){C.determinePolicyVersion(J.text);if(C.policyVersion===rlPolicyBaseFS.POLICY_VERSION_1){D.policyTextValueRenderer(K,J,H,I)}else{if(C.policyVersion===rlPolicyBaseFS.POLICY_VERSION_2){C.renderPolicyViewMode(J.id,J.text);C.applyPolicy(J)}}}};G.applyUsagesToPolicyText=function(K,J,H,I){if(C.policyVersion===rlPolicyBaseFS.POLICY_VERSION_1){D.applyUsagesToPolicyTextValueRenderer(K,J,H,I)}};return G};C.getFieldMappers=function(G){G.policyText={get:function(I,H){return undefined},set:function(J,I,H){if(I&&C.policyVersion===rlPolicyBaseFS.POLICY_VERSION_1){H.html(I.text)}else{if(I&&C.policyVersion===rlPolicyBaseFS.POLICY_VERSION_2){C.renderPolicyEditMode(I.id,I.text)}}}};G.policyWithUsages={get:function(I,H){if(C.policyVersion===rlPolicyBaseFS.POLICY_VERSION_1){return D.policyWithUsagesMapper.get(I,H)}else{if(C.policyVersion===rlPolicyBaseFS.POLICY_VERSION_2){return C.getPolicyFromEditMode()}}},set:function(J,I,H){if(C.policyVersion===rlPolicyBaseFS.POLICY_VERSION_1){D.policyWithUsagesMapper.set(J,I,H)}else{if(C.policyVersion===rlPolicyBaseFS.POLICY_VERSION_2){C.applyPolicy(I)}}}};return G};C.supportsEditMode=function(){if(C.policyVersion===rlPolicyBaseFS.POLICY_VERSION_1){return D.supportsEditMode()}else{if(C.policyVersion===rlPolicyBaseFS.POLICY_VERSION_2){return B.find("[data-policyfield='usage']").length>0}}};return C};return{__init__:function(){},__start__:function(){},createFS:function(B,C){return A(B,C)}}}();var rlAcceptedWebPolicyFormDS=(function(){function A(F){F.data=true;F.meta=true;var B=CoreFormsBase.inheritanceFrom(rlUserFormDS.createDS(F));var E=B.parent;B.typeName="rlAcceptedWebPolicyFormDS";B.getMetaData=function(H,G){H({})};B.getUserData=function(I,H){if(this.getUseMock()){I({id:"dummy_policy_v_1_0",text:"This is a placeholder for the policy the user last consented to.<br><br>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Vestibulum eget nunc quis augue commodo semper. Morbi arcu elit, lacinia ut convallis sed, laoreet a lacus. Nam vulputate placerat ultricies. Mauris eros ipsum, viverra ut gravida sit amet, tristique id nisi. In porta ornare ante, id viverra nunc sagittis vitae. Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas. Nam semper tellus justo, vitae scelerisque elit. Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas. Sed rutrum imperdiet aliquam.",revokedUsages:[]});return }var G=function(K){var J=rlMandator.getShortPolicyUrlFromLongUrl(K.policy.cmxUrl);jq.ajax({type:"GET",url:J+"?wcmmode=disabled",success:bindToScope(C,this,[I,K],true),error:bindToScope(D,this,[H],true)})};E.getUserData(G,H)};function C(H,J,I,L,G){var K={id:G.policy.cmxUrl,text:H.substring(H.indexOf("<body>")+6,H.indexOf("</body>")),revokedUsages:G.policy.revokedUsages};L(K)}function D(J,H,G,I){console.error(J);I(J)}return B}return{__init__:function(){},__start__:function(){},createDS:function(B){return A(B)}}}());var rlAccessoriesSearchFilter=function(){var B="";var E;var F=0;var K=0;var H="";var J="";var I=false;var D=false;var A=false;var C;var G="(\\(\\d+\\))";return{__start__:function(){},__init__:function(){},clearCountDynamicNavigation:function(){rlSearchUtil.afClearCountDynamicNavigation()},setVinToolSeriesLoaded:function(){A=true},getVinToolSeriesLoaded:function(){return A},clearCountVinTool:function(L,O){resetOptions=function(P){var Q=new RegExp(G);P.each(function(T,U){if(T>0){var V=jq(U);var S=U.text;var R=Q.exec(S);if(R!=null){S=S.replace(R[0],"(0)");V.html(S)}else{V.html(S+" (0)")}V.addClass("inactive").attr("disabled","disabled")}})};if(L==="vinToolSelectSeries"){var M=jq("#vinToolSelectSeries option");resetOptions(M)}else{if(L==="vinToolSelectModel"){var N=jq("#vinToolSelectModel option");resetOptions(N)}}if(O){O()}},resetCategoryAccordion:function(){var L="";if(typeof dynamicNavigationPropertiesActive!=="undefined"){for(var M in dynamicNavigationPropertiesActive.productCategory){L=M;break}}jq(".searchResultDynamicNavigationFacetteHeadline").each(function(){var P=jq(this);var O=P.attr("id");P.unbind().bind("click",function(){return false});if((L===""||L!==O)&&H!==O){P.addClass("inactive");var N=jq(":first-child",P);if(N.hasClass("spriteIconMinusMedium")){rlSearchUtil.closeAccordionContent(P)}}})},updateFilterUrls:function(O,N){setURLForFilter=function(c,R,T,S,Z){var U;if(T=="productGroups"){U=jq("#"+Z).next().find(".searchResultDynamicNavigationFacetteItemFCB")}else{if(T=="productTopics"){U=jq("#searchResultDynamicNavigationTopic .searchResultDynamicNavigationFacetteItemFCB")}else{if(T=="productCategory"){U=jq("#searchResultDynamicNavigation .searchResultDynamicNavigationFacetteHeadline")}}}for(var Y=0;Y<=U.length;Y++){var a=jq(U[Y]);var b=jq(a).attr("id");var X;var W=a.parent().next();if(typeof c[b]!=="undefined"){if(R==="input"){a.removeAttr("disabled");W.find(".accessoriesFinderGroupCount").html(" ("+c[b].count+")");if(T=="productGroups"&&a.attr("checked")==="checked"){continue}var d="";if(T=="productGroups"){W.find("label").removeClass("inactive");if(typeof dynamicNavigationPropertiesActive!=="undefined"){d=dynamicNavigationPropertiesActive.basicUrlFilterGroup}}else{if(T=="productTopics"&&typeof dynamicNavigationPropertiesActive!=="undefined"){d=dynamicNavigationPropertiesActive.basicUrlFilterTopic}}var V="";if(d===""){V=S+"="+c[b].url}else{V=rlSearchUtil.mergeBasicUrlParameters(d,c[b].url,S)}a.attr("value",V);jq(a).unbind();if(T=="productTopics"){X=a.parent().next().find("a");X.unbind().removeClass("inactive");X.parent().removeClass("inactive");if(location.href.indexOf(E)!=-1||K==1){if(K==1){V=V+" inmeta:productCategory%3D"+H;a.attr("value",V)}X.attr("href",V);rlSearchUtil.linkWithAnchor(rlAccessoriesSearchField.getSearchResult,"href",X);rlSearchUtil.linkWithAnchor(rlAccessoriesSearchField.getSearchResult,"value",a)}else{(function(e){a.bind("click",function(){location.href=e.attr("href")})})(X)}}else{rlSearchUtil.linkWithAnchor(rlAccessoriesSearchField.getSearchResult,"value",a)}}else{if(R==="accordion"){jq(a).unbind();if(location.href.indexOf(E)!=-1||F==1){rlAccessoriesSearchFilter.enableClickableAccordion(a)}if(c[b].count>0){a.removeClass("inactive")}a.find(".accessoriesFinderCategoryCount").html(" ("+c[b].count+")")}}}}};if(N==="productGroups"){var M=H;if(M===""&&typeof dynamicNavigationPropertiesActive!=="undefined"){var P;for(P in dynamicNavigationPropertiesActive.productCategory){M=P;break}var Q="";for(P in O.productGroups){Q=P;break}}if(M!==""&&Q!==""){setURLForFilter(O.productGroups,"input","productGroups","as_oq",M)}}else{if(N==="productTopics"){setURLForFilter(O.productTopics,"input","productTopics","as_q")}else{if(N==="productCategory"){setURLForFilter(O.productCategory,"accordion","productCategory","as_q")}else{if(N==="productCategory"){setURLForFilter(O.productCategory,"accordion","productCategory","as_q")}else{if(N==="availableForModelSeries"){var L=function(){if(jq.browser.msie){window.setTimeout(function(){rlAccessoriesSearchFilter.updateVinCounter(O.availableForModelSeries,"vinToolSelectSeries")},1000)}else{rlAccessoriesSearchFilter.updateVinCounter(O.availableForModelSeries,"vinToolSelectSeries")}};if(rlAccessoriesSearchFilter.getVinToolSeriesLoaded()){rlAccessoriesSearchFilter.clearCountVinTool("vinToolSelectSeries",L)}else{window.setTimeout(function(){if(rlAccessoriesSearchFilter.getVinToolSeriesLoaded()){rlAccessoriesSearchFilter.clearCountVinTool("vinToolSelectSeries",L)}else{var R=0;var S=window.setInterval(function(){if(R>10){window.clearInterval(S)}window.setTimeout(function(){if(rlAccessoriesSearchFilter.getVinToolSeriesLoaded()){window.clearInterval(S);rlAccessoriesSearchFilter.clearCountVinTool("vinToolSelectSeries",L)}},500);R++},50)}},1000)}}else{if(N==="availableForModels"){rlAccessoriesSearchFilter.updateVinCounter(dynamicNavigationPropertiesavailableForModels.availableForModels,"vinToolSelectModel")}}}}}}},updateVinCounter:function(L,M){var N=new RegExp(G);jq("#"+M+" option").each(function(S,T){var U=jq(T);var V="";if(M!=="vinToolSelectModel"){var Q=U.text();V=Q.substr(0,Q.lastIndexOf("(")-1)}else{V=U.attr("value")}var P=L[V];if(V&&V!==""&&typeof P!=="undefined"){var R=T.text;var O=N.exec(R);if(O!=null){R=R.replace(O[0],"("+P.count+")");U.html(R).removeClass("inactive").removeAttr("disabled");if(jq.browser.msie){U.attr("title",R)}}}})},updateVinModelCounter:function(){var L=function(){if(jq.browser.msie){window.setTimeout(function(){rlAccessoriesSearchFilter.updateVinCounter(dynamicNavigationPropertiesavailableForModels.availableForModels,"vinToolSelectModel")},1000)}else{rlAccessoriesSearchFilter.updateVinCounter(dynamicNavigationPropertiesavailableForModels.availableForModels,"vinToolSelectModel")}};if(typeof dynamicNavigationPropertiesavailableForModels!=="undefined"){rlAccessoriesSearchFilter.clearCountVinTool("vinToolSelectModel",L)}},loadThemePage:function(L,M){rlAccessoriesSearchField.getSearchResult(L,M)},setAccessoriesSearchPagePath:function(L){E=L+".html"},setIsCategoriesPage:function(L){K=L},setActiveCategory:function(L){H=L;rlAccessoriesSearchField.setActiveCategory(L)},setActiveTopic:function(L){J=L;rlAccessoriesSearchField.setActiveTopic(L)},getActiveCategory:function(){return H},getActiveTopic:function(){return J},setIsTopicPage:function(L){F=L},activateTopic:function(N){var M=jq("#"+N);M.attr("checked",true);var L=M.parent().next().find(".searchResultDynamicNavigationFacetteItemFCBL");L.removeClass("inactive").addClass("active")},updateResetFilter:function(N){if(jq("#ManufacturerAccessorySpecial0").length==1){rlAccessoriesFinder.setResetButton(N.basicUrlFilterTopic,"ManufacturerAccessorySpecial0","value","basicUrlFilterTopic")}var L="",O;for(O in dynamicNavigationPropertiesActive.availableForModelSeries){L=O;break}if(L===""&&typeof dynamicNavigationPropertiesActive.availableForModels!=="undefined"){for(O in dynamicNavigationPropertiesActive.availableForModels){L=O;break}}if(L!==""){jq("#vinToolConfigTab .vinToolSelectFormResetButton").addClass("linkArrow13px").removeClass("linkArrow13pxInactive");rlAccessoriesFinder.setResetButton(N.basicUrlFilterSeries,"vinToolConfigTab .vinToolSelectFormResetButton","href","basicUrlFilterCategory")}else{jq("#vinToolConfigTab .vinToolSelectFormResetButton").unbind();jq("#vinToolConfigTab .vinToolSelectFormResetButton").addClass("linkArrow13pxInactive").removeClass("linkArrow13px")}var M="";for(O in dynamicNavigationPropertiesActive.productCategory){M=O;break}if(M!==""){jq("#accessoriesFinderDynamicNavigationFormResetButton").addClass("linkArrow13px").removeClass("linkArrow13pxInactive");rlAccessoriesFinder.setResetButton(N.basicUrlFilterCategory,"accessoriesFinderDynamicNavigationFormResetButton","href","basicUrlFilterCategory")}else{jq("#accessoriesFinderDynamicNavigationFormResetButton").unbind();jq("#accessoriesFinderDynamicNavigationFormResetButton").addClass("linkArrow13pxInactive").removeClass("linkArrow13px")}if(N.basicUrlFilterCategory.indexOf("&q=")!=-1){jq("#accessoriesFinderSearchFieldFormResetButton").addClass("linkArrow13px").removeClass("linkArrow13pxInactive");rlAccessoriesFinder.setResetButton(N.basicUrlSearch,"accessoriesFinderSearchFieldFormResetButton","href","basicUrlSearch")}else{jq("#accessoriesFinderSearchFieldFormResetButton").unbind();jq("#accessoriesFinderSearchFieldFormResetButton").addClass("linkArrow13pxInactive").removeClass("linkArrow13px")}},updateDynamicNavigationAktiveState:function(U){activateInputFilter=function(X,a,Z){X.removeAttr("disabled");var Y=X.parent().next().find(".searchResultDynamicNavigationFacetteItemFCBL");X.attr("checked",true);X.attr("value",a.url);jq(X).unbind();rlSearchUtil.linkWithAnchor(rlAccessoriesSearchField.getSearchResult,"value",X);Y.removeClass("inactive").addClass("active");if(jq("html").is(".ie7")){window.setTimeout(function(){X.attr("checked",true)},100)}};deaktivateInputFilter=function(X,a,Z){X.attr("checked",false);var Y=X.parent().next().find(".searchResultDynamicNavigationFacetteItemFCBL");Y.removeClass("active")};updateCategoryFilter=function(Y,Z){var X=jq(":first-child",Y);if(X.hasClass("spriteIconPlusMedium")){rlSearchUtil.openAccordionContent(Y)}};closeCategoryFilter=function(X){rlSearchUtil.closeAccordionContent(X)};initFilter=function(Z,X,b,a){var Y=false;var c=Z.attr("id");if(typeof X[c]!=="undefined"){Y=true}else{Y=false}if(Y){if(a==="group"||a==="topic"){activateInputFilter(Z,X[c],b)}else{if(a==="category"){updateCategoryFilter(Z,X[c])}}}else{if(a==="group"||a==="topic"){deaktivateInputFilter(Z)}else{if(a==="category"){rlSearchUtil.closeAccordionContent(Z)}}}};var W="",Q,P;for(Q in dynamicNavigationPropertiesActive.productCategory){W=Q;break}if(W!==""){var M=jq("#searchResultDynamicNavigation .searchResultDynamicNavigationFacetteHeadline");for(P=0;P<M.length;P++){initFilter(jq(M[P]),U.productCategory,"as_q","category")}}var L="";for(Q in dynamicNavigationPropertiesActive.productGroups){L=Q;break}if(W!==""&&L!==""){var T=jq("#"+W).next().find(".searchResultDynamicNavigationFacetteItemFCB");for(P=0;P<T.length;P++){initFilter(jq(T[P]),U.productGroups,"as_oq","group")}}var N="";for(Q in dynamicNavigationPropertiesActive.productTopics){N=Q;break}if(N!==""){jq("#searchResultDynamicNavigationTopic .accessoriesFinderTopicUncheck label").removeClass("active").addClass("inactive");var R=jq("#searchResultDynamicNavigationTopic .searchResultDynamicNavigationFacetteItemFCB");for(P=0;P<R.length;P++){initFilter(jq(R[P]),U.productTopics,"as_q","topic")}}else{jq("#searchResultDynamicNavigationTopic .accessoriesFinderTopicUncheck label").removeClass("inactive").addClass("active")}if(D){D=false}else{var O="";for(Q in U.availableForModelSeries){O=Q;break}if(O!==""){I=true;C=jq("#vinToolSelectRegistrationCode").val();var V=jq("#vinToolSelectSeries option");V.each(function(Y,Z){if(Y>0){var X=Z.text;O=decodeURI(decodeURI(O));if(X.indexOf(O)!=-1){jq("#vinToolSelectSeries").val(Z.value).change();return false}}});var S="";for(Q in U.availableForModels){S=Q;break}if(S!==""){window.setTimeout(function(){jq("#vinToolSelectModel").val(S);jq("#vinToolSelectModel").change();jq("#vinToolSelectRegistrationCode").val(C);I=false},1000)}else{I=false}}else{I=true;jq("#vinToolSelectSeries").val("");jq("#vinToolSelectSeries").change();jq("#vinToolExistingVin").val("");I=false}}},updateStateDynamicNavigation:function(M,N,L){if(N==="Active"){rlAccessoriesSearchFilter.updateDynamicNavigationAktiveState(M);rlAccessoriesSearchFilter.resetCategoryAccordion();rlAccessoriesSearchFilter.updateResetFilter(M);B=M.basicUrlFilterGroup}if(N==="Default"){rlAccessoriesSearchFilter.updateFilterUrls(M,L)}},searchOneParameter:function(L){},filterByVintool:function(O){if(typeof O==="undefined"||!("series" in O)||I||jq("#vinToolSelectSeries option").length<2){return true}else{if(O.series===null&&O.model===null){}}var P="";var Q="";if(O.series&&typeof dynamicNavigationPropertiesavailableForModelSeries!="undefined"){var L=jq("#vinToolSelectSeries option[value='"+O.series+"']").text();L=L.substr(0,L.lastIndexOf("(")-1);var N=dynamicNavigationPropertiesavailableForModelSeries.availableForModelSeries[L].url;P=N;if(typeof dynamicNavigationPropertiesActive!=="undefined"){Q=dynamicNavigationPropertiesActive.basicUrlFilterSeries}if(O.model){P="inmeta:availableForModels%3D"+O.model;if(typeof dynamicNavigationPropertiesActive!=="undefined"&&typeof dynamicNavigationPropertiesActive.basicUrlFilterModels!=="undefined"){Q=dynamicNavigationPropertiesActive.basicUrlFilterModels}else{P=N+" inmeta:availableForModels%3D"+O.model}}}var R="as_q="+P;if(typeof dynamicNavigationPropertiesActive!=="undefined"&&Q!==""){R=rlSearchUtil.mergeBasicUrlParameters(Q,P,"as_q")}var M=rlSearchUtil.convertSeachParametersToBase64(R);if(location.href.indexOf(E)!=-1){D=true;location.href="#"+M}else{location.href=E+"#"+M}},loadCategoryPage:function(M){if(typeof dynamicNavigationPropertiesActive==="undefined"||(typeof dynamicNavigationPropertiesActive.basicUrlFilterCategory!=="undefined"&&dynamicNavigationPropertiesActive.basicUrlFilterCategory===""&&F==0)){return true}var N="inmeta:productCategory%3D"+jq(M).attr("id");var P="as_q="+N;if(F==1){P=P+" inmeta:productTopics%3D"+J}else{if(typeof dynamicNavigationPropertiesActive!=="undefined"&&dynamicNavigationPropertiesActive.basicUrlFilterCategory!==""){var O=dynamicNavigationPropertiesActive.basicUrlFilterCategory;P=rlSearchUtil.mergeBasicUrlParameters(O,N,"as_q")}}var L=rlSearchUtil.convertSeachParametersToBase64(P);if(location.href.indexOf(E)!=-1){location.href="#"+L}else{location.href=E+"#"+L}return false},getBasicUrlFilterGroup:function(){return B},enableClickableAccordion:function(L){jq(L).click(function(O){var N=true;var M=jq(":first-child",L);if(M.hasClass("spriteIconMinusMedium")){jq("#accessoriesFinderDynamicNavigationFormResetButton").click();N=false}else{N=rlAccessoriesSearchFilter.loadCategoryPage(L)}if(jq.browser.msie){O.returnValue=N}return N})},loadDetailPage:function(L){location.href=L+location.hash;return false}}}();var rlAccordion=function(){var U="clickableIconPlusMedium spriteIconPlusMedium";var W="clickableIconMinusMedium spriteIconMinusMedium";var P="bmwAccordionClosed";var B="accordionOpenClose";var S="accordionItemWrap";var R="accordionHeadline";var A="accordionContent";var O="bmwAccordionToggleCloseAll";var V="bmwAccordionToggleOpenAll";var H="accordion";var L="openAllAccordionTabsForPrinting";function J(a,Z){var Y=jq(a.item,a.element);!Z?a.element.addClass(H):jq.noop();var X=true;Y.each(function(){var g=jq(this);if(typeof g.attr("initialized")!=="undefined"){return true}var f=jq(a.head,g);var e=jq(a.content,g);!Z?g.addClass(S):jq.noop();!Z?f.addClass(R):jq.noop();!Z?e.addClass(A):jq.noop();var d=g.is("."+P)||e.is(":hidden");X=X&d;if(d){g.addClass(P)}var h=Q(d,e);C(d,e);f.addClass("clearfix").prepend(h).click(function(){K(g,e,h);var j=D(Y);N(j,a)});g.after(jq("<hr>"));g.attr("initialized",true)});N(X,a);jq(a.togglerCloseAll,a.element).click(function(){M(a);N(true,a)});jq(a.togglerOpenAll,a.element).click(function(){b(a,false)});function c(){jq(window).unbind(L);jq(window).bind(L,function(d){b(a,true)})}function b(e,d){Y.each(function(){var f=jq(this);F(f,e.content,true,d)});N(false,e)}c()}function Q(Y,X){var Z=jq("<div>").addClass(B+" baseIconSprite baseIconSizeMedium");Y?Z.addClass(U):Z.addClass(W);return Z}function C(Y,X){Y?X.hide().css("opacity",0):X.show().css("opacity",1);G(X)}function D(Y){var X=true;Y.each(function(){X=X&&jq(this).is("."+P)});return X}function N(Y,X){if(Y){jq(X.togglerCloseAll,X.element).hide();jq(X.togglerOpenAll,X.element).show()}else{jq(X.togglerCloseAll,X.element).show();jq(X.togglerOpenAll,X.element).hide()}}function M(Y,Z){if("undefined"===Z){Z=Y.noAnimation}var X=jq(Y.item,jq(Y.element));X.each(function(){var a=jq(this);F(a,Y.content,false,Z)})}function F(a,Y,X,b){var Z=jq(Y,a);var c=jq("."+B+":first",a);a.toggleClass(P,X);K(a,Z,c,b)}function K(Y,X,a,Z){if(!X.is(":animated")){I(Y,X,a,Z)}}function T(a,Z){var Y=jq(".dealerTeamBlock").length>0;var X=jq("."+R,Z);jq("."+R).removeAttr("id");if(Y){jq(X).each(function(){if(!a){jq(this).attr("id",jq(this).find(".trackingHeadline").attr("id")+"_opened")}else{jq(this).removeAttr("id")}})}}function I(b,Z,d,c){var Y=b.is("."+P);var a=null;var X=null;if(Y){d.removeClass(U).addClass(W);T(false,b);a=1;X="show"}else{T(true,b);d.removeClass(W).addClass(U);a=0;X="hide"}if(c){Z.css("opacity",a);Y?Z.show():Z.hide()}else{Z.css("height",Z.height());Z.animate({opacity:a,height:X},{step:function(){G(this)}},Y?700:400)}b.toggleClass(P)}function E(X){var Y=window.location.hash;var Z=X.element;jq(Y,Z).each(function(){var c=jq(this);M(X,true);var b=c.is(X.item)?c:c.parents(X.item+":first");var a=jq(X.content,b);var d=jq("."+B,b);b.queue(function(){I(b,a,d,true);b.dequeue()})})}function G(X){if(jq("html").hasClass("ie7")||jq("html").hasClass("ie8")){jq(X).get(0).style.removeAttribute("filter")}}return{__init__:function(){var X="."+H;jq(X).each(function(Z,a){var b=jq(a);var Y={element:b,item:"."+S,head:"."+R,content:"."+A,togglerCloseAll:"."+O,togglerOpenAll:"."+V};J(Y,true);E(Y)})},bmwAccordionInit:function(X){var Y={element:jq(X.id),item:X.item,head:X.head,content:X.content,togglerCloseAll:X.togglerCloseAll,togglerOpenAll:X.togglerOpenAll};J(Y,false);E(Y)},closeAll:function(X){M(X)}}}();var rlAdditionalFieldFS=function(){function A(B,F){var C=CoreFormsBase.inheritanceFrom(rlFormFieldSet.createFS(B,F));var D=C.parent;C.typeName="rlAdditionalFieldFS";var E=null;C.init=function(){D.init()};C.getFieldMappers=function(G){G.additionalFieldDropdown=G.dropdown;return G};return C}return{__init__:function(){},__start__:function(){},createFS:function(B,C){return A(B,C)}}}();var rlAsrInclude=function(){return{__start__:function(){},__init__:function(){},registerLoad:function(B,C,A){rlAsrInclude.registerClick("load",A,C,null,null,B)},registerClick:function(G,B,E,D,F,C){var A={site:B,page:E,url:D,rank:F,query:C,clickType:G,charset:"UTF-8"};rlCrossSubDomainAjax.call({url:rlPage.getNextCoreUrl()+cfGsaAsrUrl+"/click",type:"POST",scriptCharset:"UTF-8",data:A,beforeSend:function(H){H.setRequestHeader("Accept-Charset","UTF-8")},success:function(H){},error:function(H,J,I){}});return true}}}();var rlAutosuggest=function(){var C,A,B;return{__start__:function(){},__init__:function(){},autosuggest:function(H,W){var Q,S,V,P,I,K,R,E;var G=false;function T(Z,Y,a){Q=document.createElement("li");jq(Q).attr({"class":"searchQueryLiveSearchLayerListItem"});S=document.createElement("a");jq(S).attr({"class":"searchQueryLiveSearchLayerListItemLink"});if(a=="livesearch"){if(Y.url){jq(S).attr({href:Y.url})}jq(S).html(Y.name.replace(I,"<em class='searchQueryLiveSearchLayerHighlight'>$1</em>"))}else{jq(S).html(Y.replace(I,"<em class='searchQueryLiveSearchLayerHighlight'>$1</em>"))}Q.appendChild(S);P.appendChild(Q)}function X(Y,Z,a){if(Z.headline){V=document.createElement("div");if(Z.headline.indexOf("##textAutosuggestTitle##")>-1){jq(V).html(rlAutosuggest.getTextAutosuggestTitle())}else{if(Z.headline.indexOf("##textLiveSearchTitle##")>-1){jq(V).html(rlAutosuggest.getTextLiveSearchTitle())}}K.append(V);jq(V).attr({"class":"searchQueryLiveSearchLayerListSection"})}P=document.createElement("ul");if(a.results.length==(Y+1)){jq(P).attr({"class":"searchQueryLiveSearchLayerList searchQueryLiveSearchLayerListLast"})}else{jq(P).attr({"class":"searchQueryLiveSearchLayerList"})}if(Z.suggest&&Z.suggest.length>1){jq(P).addClass("searchQuerySuggestList");jq(Z.suggest[1]).each(function(c,b){T(c,b,"suggest")})}jq(Z.list).each(function(c,b){T(c,b,"livesearch")});K.append(P);jq("."+W.className+" .searchQueryLiveSearchLayer > div ul li.searchQueryLiveSearchLayerListItem").live("mouseover",function(){jq(this).parent().parent().find("li[class='searchQueryLiveSearchLayerListItem searchQueryLiveSearchLayerListSelected']").removeClass("searchQueryLiveSearchLayerListSelected");jq(this).addClass("searchQueryLiveSearchLayerListSelected")})}function O(Z,Y,a){if(Z.query&&Z.results&&Z.results.length>0){E=Z.query;K=jq("div."+Y.className).find(".searchQueryLiveSearchLayer > div");jq(K).html("");jq("div."+Y.className).children("div.searchQueryLiveSearchLayer").fadeIn();I=new RegExp("(?![^&;]+;)(?!<[^<>]*)("+Z.query+")(?![^<>]*>)(?![^&;]+;)","gi");jq(Z.results).each(function(b,c){X(b,c,Z)})}else{jq("div."+Y.className).children("div.searchQueryLiveSearchLayer").fadeOut()}}function U(b,f,d,a,e){var c=jq("."+a.className+" #"+a.id);switch(b.which){case 40:D(f,"next",c);break;case 38:D(f,"prev",c);break;case 27:d.children("div.searchQueryLiveSearchLayer").hide();break;case 13:if(G){window.clearTimeout(G)}var Y=jq("li[class='searchQueryLiveSearchLayerListItem searchQueryLiveSearchLayerListSelected'] a");if(typeof Y.attr("href")!="undefined"&&Y.attr("href")){window.location.href=Y.attr("href");return false}else{var Z=c.val();d.children("div.searchQueryLiveSearchLayer").hide();a.searchFunction(Z);return false}break;case 9:R(e);N();break}}function D(e,d,c){var Z=-1;var a=e.find("li.searchQueryLiveSearchLayerListItem");a.each(function(f,g){if(jq(this).attr("class")=="searchQueryLiveSearchLayerListItem searchQueryLiveSearchLayerListSelected"){Z=f}});var Y;if(Z>=0){var b=e.find("li[class='searchQueryLiveSearchLayerListItem searchQueryLiveSearchLayerListSelected']");if(d=="next"){Y=a[Z+1]}else{Y=a[Z-1]}Y=jq(Y);Y.addClass("searchQueryLiveSearchLayerListSelected");b.removeClass("searchQueryLiveSearchLayerListSelected")}else{if(d=="next"){Y=e.find("li.searchQueryLiveSearchLayerListItem:first")}else{Y=e.find("li.searchQueryLiveSearchLayerListItem:last")}Y.addClass("searchQueryLiveSearchLayerListSelected")}Z=jq("li[class='searchQueryLiveSearchLayerListItem searchQueryLiveSearchLayerListSelected'] a");if(Y&&Y.length>0){if(typeof Z.attr("href")!="undefined"&&Z.attr("href")){c.val(E)}else{c.val(Y.text())}}else{if(E&&E!=""){c.val(E)}else{c.val("")}}}var L={id:"searchQueryBarInputField",className:"searchQueryLiveSearchLayerSuggest",methodType:"POST",addParams:"",rtnIDs:false,fadeTime:100,minCharsForAutoSuggest:3,minCharsForLiveSearch:3,numLiveSearchResults:3,numAutoSuggestResults:3};W=jq.extend(L,W);jq("#"+W.id).attr("autocomplete","off");W.addParams=(W.addParams!="")?"&"+W.addParams:"";jq('<div class="searchQueryLiveSearchLayer shadow"><div></div></div>').appendTo("."+W.className);function F(Y){var Z=jq("div."+W.className);if(Y.type==="focus"||(Y.which!=39&&Y.which!=37&&Y.which!=38&&Y.which!=40&&Y.which!=13&&Y.which!=27&&Y.which!=9)){if(G){window.clearTimeout(G)}G=window.setTimeout(function(){N();fieldVal=Z.find("input:eq(0)").val();J(fieldVal,this.id,H)},400)}else{var b=Z.find(".searchQueryLiveSearchLayer > div");var a=this;U(Y,b,Z,W,a)}}jq("."+W.className+" #"+W.id).bind("keyup paste focus",function(Y){F(Y)});M(W);jq("#"+W.id).live("blur",function(){R(this);N()});function N(){jq("li.searchQueryLiveSearchLayerListItem").removeClass("searchQueryLiveSearchLayerListSelected")}function J(a,c,b){if(a.length<W.minCharsForAutoSuggest){jq("."+W.className).children("div.searchQueryLiveSearchLayer").fadeOut()}else{var Z=(W.suggestServletName)?W.suggestServletName:"/";if(B){var Y=B(a,Z,W);rlCrossSubDomainAjax.call({url:Y[0]+b+"/suggest/",type:"POST",scriptCharset:"UTF-8",dataType:"json",data:Y[1],beforeSend:function(d){d.setRequestHeader("Accept-Charset","UTF-8")},success:function(d){O(d,W,c)}})}else{return false}}}R=function(Z){var Y=jq("div."+W.className);Y.children("div.searchQueryLiveSearchLayer").delay(W.fadeTime).fadeOut();N()};function M(Y){var Z=jq("."+Y.className+" #"+Y.id);jq("."+Y.className+" .searchQueryLiveSearchLayer > div ul li.searchQueryLiveSearchLayerListItem").live("click",function(){var a=jq("div."+Y.className);if(typeof jq("a",this).attr("href")=="undefined"||!jq("a",this).attr("href")){Z.val(jq("a",this).text());Y.searchFunction()}a.children("div.searchQueryLiveSearchLayer").fadeOut()})}},setTextAutosuggestTitle:function(D){C=D},setTextLiveSearchTitle:function(D){A=D},getTextAutosuggestTitle:function(){return C},getTextLiveSearchTitle:function(){return A},setHelperGetGSASuggestPath:function(D){B=D}}}();var rlBackToDealer=function(){var F="backToDealer";var B=false;var D=true;var P=700;var O="#backToDealerLayer";var H="#backToDealerLayer .backToDealerLayerWrapper";function I(){if(rlMandator.isDealer()){K();jq(window).bind("hashchange",K)}else{if(GLOBAL_BACK_TO_DEALER_LAYER_PAGE_URL!=="false"&&M()){G();C();L()}}}function J(){document.location.href=B}function C(){jq("#backToDealerLayer .backToDealerLayerSwitch").click(function(){rlBackToDealer.showLayer()});jq("#backToDealerLayer .baseIconSprite").click(function(){rlBackToDealer.hideLayer()});jq("#backToDealerLayer").click(function(Q){Q.stopPropagation()});jq("html").click(function(Q){if(A()){rlBackToDealer.hideLayer();Q.stopPropagation()}})}function G(){var Q='<div id="backToDealerLayer"><div class="backToDealerLayerSwitch"></div><div class="backToDealerLayerWrapper "><div class="shadow"><div class="spriteIconCloseMedium baseIconSizeMedium baseIconSprite"></div><div class="backToDealerLayerContent"></div></div></div></div>';jq("body").append(Q)}function E(){if(jq(".backToDealerLayerContent div").length<1){jq.get(GLOBAL_BACK_TO_DEALER_LAYER_PAGE_URL+".ajax.html",function(Q){jq("#backToDealerLayer .backToDealerLayerContent").html(Q)}).done(function(){jq("#backToDealerLayer .backToDealerButton a").click(function(){rlBackToDealer.backToDealer()});E()})}else{jq(H).css({display:"block",visibility:"visible",left:"-"+(jq(H).width()+20)+"px"});jq(".backToDealerLayerSwitch").animate({left:"-25px"},300);jq(H).delay(300).animate({left:"-10px"},400)}jq(O).attr({"data-visibility":"visible"})}function N(){jq(O).attr({"data-visibility":"hidden"});jq(H).animate({left:"-"+jq(H).width()+"px"},400).hide(1).delay(1);jq(".backToDealerLayerSwitch").delay(400).animate({left:0},300)}function A(){return(jq(O).attr("data-visibility")==="visible")?true:false}function M(){rlComponentLoader.requireComponents("cookieController");var Q=rlCookieController.getCookie({cookieKey:F});if(Q&&typeof Q.cookieValue==="string"){B=Q.cookieValue;if(B.substr(0,1)==="#"){B=B.substr(1);D=false}return true}else{return false}}function L(){if(D){var Q={cookieKey:F,cookieValue:"#"+B};rlCookieController.setCookie(Q);setTimeout("rlBackToDealer.showLayer()",P)}}function K(){var Q={cookieKey:F,cookieValue:document.location.href.substr(document.location.protocol.length)};rlCookieController.setCookie(Q)}return{__init__:function(){if(!rlPage.isEditMode()){jq(window).one(rlComponentLoader.getPageReadyTriggerName(),function(){I()})}},showLayer:E,hideLayer:N,backToDealer:J,layerIsVisible:A,initialize:I,storeDealerPath:K}}();var rlBackToTop=function(){var B;var A;var D;function C(){B=jq(".backToTopLink");jq(window).bind("scrollstart",function(){if(B.css("display")!="none"&&rlSalesBarAnimation.getSalesBarStatus()!="static"){if(D>0&&D<=8){B.hide()}else{B.fadeOut(700)}}});jq(window).bind("scrollstop",function(){A=jq(window).scrollTop();if(A>0){if(D>0&&D<=8){B.show()}else{B.fadeIn(700)}}});B.bind("click",function(){if(D>0&&D<=8){B.hide()}else{B.fadeOut(700)}})}return{__init__:function(){D=rlBrowser.getInternetExplorerVersion();if(jq(window).scrollTop()>0){if(D>0&&D<=8){jq(".backToTopLink").show()}else{jq(".backToTopLink").fadeIn(700)}}jq(window).bind(rlComponentLoader.getPageReadyTriggerName(),function(){setTimeout("rlBackToTop.bindWindowEvents()",500)});if(typeof window.chrome==="object"){jq(".backToTopLink > .jumpMarkUpIcon").css("margin-top","1px")}},bindWindowEvents:function(){C()}}}();var rlBaseDataSource=function(){var A=function(H){if(typeof H==="undefined"){H={}}var K=CoreFormsBase.inheritanceFrom(CoreFormsBase.createBaseType());var J=K.parent;K.typeName="rlBaseDataSource";var F=H.meta===true;var G=H.data===true;var B=false;var E=false;var I;K.create=function(L){K.createUser(L.data,L.success,L.error,L.validation)};K.remove=function(L){K.deleteUser(L.data,L.success,L.error)};K.update=function(L){K.updateUser(L.data,L.success,L.error,L.validation)};K.get=function(N){var M=N;var L={};if(!G&&!F){M.success(L)}else{if(G){K.getUserData(function(O){G=false;L.data=O;C(L,M)},function(O){D(O,M)})}else{K.getDefaultData(function(O){G=false;L.data=O;C(L,M)},function(O){D(O,M)})}if(F){K.getMetaData(function(O){F=false;L.metaData=O;C(L,M)},function(O){if(O&&O.responseText!=undefined){D(O.responseText,M)}else{D(O,M)}})}}K.get=function(){throw ("Cannot execute 'get' more than once.")}};K.createUser=function(M,L,O,N){};K.updateUser=function(M,L,O,N){};K.deleteUser=function(M,L,N){};K.getUserData=function(M,L){};K.getDefaultData=function(M,L){};K.getMetaData=function(M,L){};K.setUseMock=function(L){I=L};K.getUseMock=function(){return rlPage.isPreviewMode()||rlPage.isDesignMode()||rlPage.isEditMode()||I===true};K.postProcessLoadedData=function(L){};function C(L,M){if(!B&&!G&&!F){B=true;M.success(L)}}function D(M,L){console.error(M);if(!E){E=true;L.error(M)}}return K};return{__init__:function(){},__start__:function(){},createDS:function(B){return A(B)}}}();var rlBirthdayFS=function(){return{__init__:function(){},__start__:function(){},createFS:function(A,B){return rlBirthdayFSInstance(A,B)}}}();function rlBirthdayFSInstance(J,D){var I=CoreFormsBase.inheritanceFrom(rlFormFieldSet.createFS(J,D));var F=I.parent;I.typeName="rlBirthdayFS";var B=jq("#"+I.getFieldSetId()+"_day");var E=jq("#"+I.getFieldSetId()+"_month");var H=jq("#"+I.getFieldSetId()+"_year");I.getMetaDataRenderers=function(K){K.birthdayYear=function(P,M,O){var L="";for(var N=M.maxYear;N>=M.minYear;N--){L+="<option value="+N+">"+N+"</option>"}O.find(".date_year").append(L)};return K};I.getMailSummary=function(K,M,N){var L=J.find(".date_day").val();var Q=J.find(".date_month").val();var O=J.find(".date_year").val();if(L&&Q&&O){var P=rlFormatter.formatDate(new Date(O,Q-1,L));K.push({id:(N!==true)?undefined:J.find('[data-field]:not([data-field=""])').attr("data-field"),type:M.KEY_VALUE,key:J.find(".fieldSetLayoutCol1 label.fieldSetRowLabel").first().text().replace("*",""),value:P})}};function G(){J.find(".date_month, .date_year").change(function(){C(J)})}function C(L){var O=rlTime.getMaxDaysForMonth(E.val(),H.val());if(O==undefined){return }var P=B.find("option");if(O>P.length-1){for(var N=P.length;N<=O;N++){var K=(N<10?"0":"")+N;B.append("<option value="+K+">"+K+"</option>")}}else{if(O<P.length-1){for(var M=P.length-1;M>O;M--){jq(B.find("option").get(M)).remove()}}}}function A(){var K=J.find("span.birthdaySel");if(rlFormatter.DATE_ENDIANNESS==="big"||rlFormatter.DATE_ENDIANNESS==="ymd"){B.remove();E.remove();H.remove();K.append(H);K.append(E);K.append(B)}else{if(rlFormatter.DATE_ENDIANNESS==="middle"||rlFormatter.DATE_ENDIANNESS==="mdy"){B.remove();E.remove();H.remove();K.append(E);K.append(B);K.append(H)}}}A();G();return I}var rlBmwLoadingState=function(){var F=18;var I=72;var H=[];function D(M){var N=jq(H[M].IconAreaId).find(".bmwLoadingStateImage")[0];var O=0;if(jq(N).length>0){var J=jq(N).css("background-position");if(J!==undefined){O=parseInt(J.replace(/px/g,""),10)}else{if(jq(N).css("background-position-x")!==undefined){O=parseInt(jq(N).css("background-position-x").replace(/px/g,""),10)}}}var L=jq(N).width();var K=(O-L);H[M].Counter++;if(H[M].Counter==F){K=0;H[M].Counter=0}jq(N).css("background-position",K)}function A(J){if(H[J].Loading){jq(H[J].IconAreaId).show();H[J].AnimationTimer=window.setInterval(function(){D(J)},I)}H[J].Timer=null}function G(J){H[J]={WrapperId:"#"+J,IconAreaId:"#"+J+"LoadingIcon",Timer:null,AnimationTimer:null,Counter:0,Loading:false}}function E(J){if(H[J]==null){console.log("missing call showAfterLoad("+J+")");return }H[J].Loading=false;if(H[J].Timer!=null){window.clearTimeout(H[J].Timer)}window.clearInterval(H[J].AnimationTimer);H[J].Counter=0;jq(H[J].IconAreaId).hide();jq(H[J].WrapperId).css("visibility","visible")}function C(J){if(H[J]==null){console.log("missing call initLoadingState("+J+")");return }H[J].Loading=false;if(H[J].Timer!=null){window.clearTimeout(H[J].Timer);window.clearInterval(H[J].AnimationTimer);H[J].Counter=0}else{jq(H[J].IconAreaId).hide()}}function B(J){if(H[J]==null){console.log("missing call hideDuringLoad("+J+")");return }jq(H[J].WrapperId).css("visibility","hidden");H[J].Timer=window.setTimeout(function(){A(J)},2000);H[J].Loading=true}return{__init__:function(){},__start__:function(){},initLoadingState:function(J){G(J)},hideDuringLoad:function(J){B(J)},showAfterLoad:function(J){E(J)},showAfterLoadWithError:function(J){C(J)},showLoadIcon:function(J){A(J)}}}();var rlBottom=function(){return{__init__:function(){jq(".languageNavLink").bind("click",function(A){if(jq(this).hasClass("existingPath")==false){rlGlassPaneLayerNext.openDialog({url:jq(this).attr("href")});A.preventDefault()}else{window.location.href=jq(this).attr("href")+document.location.hash;A.preventDefault()}})},openNCCLanguageLink:function(A){}}}();var rlButtonIe7=function(){function A(B){var C=0;jq(B).each(function(E){var D=jq(this).height();if(typeof D!="undefined"){if(D>C){C=D}}});if(C>0){}}return{__init__:function(){jq(".flexbox").each(function(){A(jq(this).find(".buttonComp"))})},__start__:function(){},same_Height:function(){}}}();var rlConfigselector=function(){var I=null;var B=false;var M=false;var K=false;var O=undefined;var G=[];var S="/vc/ncc/xhtml/start/startWithConfigId.faces?configId=";var W=".gplnAjaxContent";function Z(){var d=jq("#myconfigSortSelector").val();rlMyConfigsController.sortConfigurations(d)}function Q(){jq("#myconfigSortSelector").change(Z)}function C(){I=null;jq(".myconfigSelectorRemoveButton").unbind("click").click(function(){if(I!=null){I.css("visibility","hidden")}I=jq(this).parent().siblings(".myConfigDeleteLayer");I.css("visibility","visible")});jq(".myconfigDeleteConfButton").unbind("click").click(function(){var d=I.attr("name");if(I!=null){jq(I).delay(10).fadeOut(10);B=true;console.log("Deleting currently shown config");rlDither.on(W,10);rlMyConfigsController.deleteConfig({configId:d,noConfirmationLayer:true,success:function(e){O&&O();jq(I).parent().delay(10).fadeOut(10);rlDither.off(W)},error:function(e){rlErrorService.handleError({actor:rlErrorService.ACTOR_USER})}})}});jq(".myconfigDeleteCancelButton").unbind("click").click(function(){if(I!=null){I.css("visibility","hidden");I=null}})}function V(){rlNccServices.getConfigCount({success:function(e){var d=parseInt(e);if(!isNaN(d)&&d!=G.length){Y()}},error:function(){L("getConfigCount()")},fail:function(){L("getConfigCount()")}})}function Y(){rlNccServices.getShortConfigList({success:function(d){G=d;N()},error:function(){L("getShortConfigList()")}})}function L(d){console.log("Error by calling method: "+d+". Cannot retrieve config count or config list from NCC.")}function R(){var e=function(f){f.find(".myConfigSelectorSelect_ChooseButton").stop(true,true);f.find(".myconfigSelectorRemoveButton").stop(true,true);f.find(".myConfigSelectorSelect_DividerBar").stop(true,true)};var d=jq(".myconfigSelectorConfigItem .myconfigSelectorContent");d.mouseenter(function(){var f=jq(this);e(f);f.find(".myConfigSelectorSelect_DividerBar").delay(200).animate({opacity:1,top:"0"},400);f.find(".myconfigSelectorRemoveButton").stop(true,true).delay(600).fadeIn(400);f.find(".myconfigSelectorThumbHeadlineContainer").css("background-color","#e6e6e6")});d.mouseleave(function(){var f=jq(this);e(f);f.find(".myConfigSelectorSelect_DividerBar").animate({opacity:0,top:"100px"},400);f.find(".myconfigSelectorRemoveButton").delay(400).fadeOut(400);f.find(".myconfigSelectorThumbHeadlineContainer").css("background-color","#ffffff")})}function F(){rlComponentLoader.deferredExec(["myConfigsController"],function(){rlMyConfigsController.addConfigListLoadedListener({success:function(d){G=d;N()}})})}function D(){rlGlassPaneLayerNext.addOpenListener(function(){Q();J(G.length);var e=jq("#myconfigSortSelector");var d=rlMyConfigsController.getCurrentSortKey();if(isDefined(d)){e.val(d.cookieValue)}setTimeout(jq.proxy(Z,e.get(0)),0);if(K){c()}},true)}function U(){jq(window).bind(rlNccServices.EVENT_CONFIG_USERNOTE_CHANGED,function(g,e){if(e&&e.configId){if(G&&G.length>0){for(var f=0;f<G.length;f++){var d=G[f];if(d&&d.configId==e.configId){d.note=e.userNote;break}}}N()}})}function H(d){if(K){return }if(!M){rlMyConfigsController.loadConfiguration(d);rlGlassPaneLayerNext.closeDialog()}else{document.location=S+d}}function b(){M=(typeof nccData!=="undefined");N();rlGlassPaneLayerNext.contentReady()}function A(){var d=jq(".myconfigselector");return(d.length>0)}function N(){if(A()==false){return }var q=jq("#myconfigSelectorThumbContainerContentTemplate > div");var g=jq("#myconfigSelectorThumbContainerContent_bmw");var t=jq("#myconfigSelectorThumbContainerContent_bmwi");g.empty();t.empty();var d=jq("#myconfigSelectorThumbContainerContent_bmw,#myconfigSelectorThumbContainerContent_bmwi");var n=function(u,w){var v=jq("<h1></h1>");v.text(w);v.addClass("subBrandLabel fontBold");u.append(v)};n(g,"BMW");n(t,"BMW i");J(G.length);var r=undefined;if(!M&&!K){r=rlMyConfigOverview.getCurrentConfigId()}var h=0,o=0,k;for(k=0;k<G.length;k++){if(rlMyConfigsController.isSubBrandBMWi(G[k])){o++}else{h++}}var j=Math.max(h,o);if(j==0){jq(".myConfigSelectorNoConfiguration").css("display","block");rlGlassPaneLayerNext.contentReady();return }else{jq(".myConfigSelectorNoConfiguration").css("display","none")}if(j==1){d.removeClass("myconfigSelectorTwoColumns");d.addClass("myconfigSelectorOneColumns");jq(".imageArea")[0].coords="15,20,400,210"}else{if(j<3){d.addClass("myconfigSelectorTwoColumns");jq(".imageArea")[0].coords="15,20,240,150"}}jq(".myconfigselector .gplContentBody").addClass("myConfigSelectorMarginRight");var m;for(k=0;k<G.length;k++){var p=G[k];m=p.configId;var f=(m===rlMyConfigsController.getCurrentConfigId());var e=q.clone();e.attr("configid",m);if(f){e.addClass("selectedConfiguration")}e.find(".myconfigSelectorThumbnail").each(function(){var u=m;var v;if(j==1){v=rlNccServices.getCosyUrl(p.multipleImageUrl.bigUrl)}else{if(j==2){v=rlNccServices.getCosyUrl(p.multipleImageUrl.mediumUrl)}else{v=rlNccServices.getCosyUrl(p.multipleImageUrl.smallUrl)}}jq(this).attr("src",v).stop(true,true).hide().fadeIn(600);jq(this).attr("usemap","#map"+u)});var s=function(v,u){v.find(".imageMap").each(function(){jq(this).attr("name","map"+u)});v.find(".imageArea").click(function(){H(u)});v.find(".myConfigSelectorSelect_DividerBarLink").click(function(){H(u)})};s(e,m);e.find(".myConfigDeleteLayer").each(function(){jq(this).attr("name",p.configId)});if(p.primary=="true"){e.find(".myconfigSelPrimaryFlag").each(function(){jq(this).css("display","inline-block");jq(this).addClass("spriteLabelFavoritGrey12")})}if(p.valid=="false"){e.find(".myconfigInvalidFlag").each(function(){jq(this).css("display","inline-block");jq(this).addClass("spriteLabelWarningGrey12")});e.find(".myConfigSelectorSelect_invalidConfigText").css("display","block");e.find(".myConfigSelectorAnimationWrapper").addClass("myConfigIsInvalid")}e.attr("configId",m);e.find(".myconfigSelectorThumbHeadline > span").each(function(){jq(this).text(p.model.name)});e.find(".myconfigSelectorThumbSubHeadline > span").each(function(){var u=E(p.note,300);jq(this).text(u)});if(m==r){e.find(".myConfigSelectorSelectIndicator").css("display","block")}if(rlMyConfigsController.isSubBrandBMWi(p)){e.appendTo(t)}else{e.appendTo(g)}}if(g.find(".myconfigSelectorConfigItem").length===0){g.hide()}else{g.show()}if(t.find(".myconfigSelectorConfigItem").length===0){t.hide()}else{t.show()}rlDither.center(W);R();C()}function J(d){jq("#myconfigCount").html(d);jq("#myconfigEmptySlots").html((rlNccServices.getMaxNumberOfConfigs()-d));if(d==0){jq(".subBrandContainer").hide()}}function E(g,e){g=g.replace(/\s{2,}/g," ");var h=jq("<span></span>");h.addClass("pixelRuler").css("visibility","hidden").css("position","absolute").css("left","-1000px").css("font-size","13px").css("line-height","15px");jq("body").append(h);var f=g;var d=g;if(X(f,h)>e){d+="...";while(X(d,h)>e){f=f.substring(0,f.length-1);d=f+"..."}}jq(".pixelRuler").remove();return d}function X(d,e){e.text(d);return e.width()}function a(){rlComponentLoader.requireComponentWithDeferredExec(["glassPaneLayerNext"],function(){rlGlassPaneLayerNext.openDialog({url:GLOBAL_CONFIG_SELECTOR_PATH,headerContent:".gplContentHeader",waitforcallback:true})})}function T(){M=true;K=false;a();console.log("ConfigSelector Layer opened")}function P(d,e){M=false;K=true;O=d;a()}function c(){jq(".myconfigDeleteMessage").css("display","block");jq(".myconfigSelectorSubHeaderContainer").addClass("myconfigSelectorDeleteAdjust")}return{setParams:function(d){},bindOnConfigItemHover:function(){R()},openDeleteDialog:function(d){P(d)},openLoadDialogLoggedIn:function(){T()},initUi:function(){b()},__init__:function(){rlCoreServices.isLoggedIn({loggedIn:function(){F();U()}});D()},__start__:function(){rlCoreServices.isLoggedIn({loggedIn:function(){V()}})}}}();var rlContactFormDropDownListFS=function(){function A(B,F){var C=CoreFormsBase.inheritanceFrom(rlFormFieldSet.createFS(B,F));var D=C.parent;C.typeName="rlContactFormDropDownListFS";var E=null;C.init=function(){D.init();E=C.getFieldsetProperties()};C.getFieldMappers=function(G){G.contactFormDropdown=G.dropdown;return G};C.getInputCacheCookieName=function(){var G=B.attr("data-inputcachekey");var H=E.contactformdropdownlisttype;return G+"_"+H};return C}return{__init__:function(){},__start__:function(){},createFS:function(B,C){return A(B,C)}}}();var rlContactSet=function(){var Q=["phone","businessPhone","mobile","businessMobile","pager","fax","email"];var C=[["phone","preferredPhone"],["businessPhone","preferredBusinessPhone"],["mobile","preferredMobile"],["businessMobile","preferredBusinessMobile"]];var F="";var L={getListAreaId:function(){return F},errorPlacements:function(){return{phone:jq("#errorMsg_phone"),businessPhone:jq("#errorMsg_businessPhone"),mobile:jq("#errorMsg_mobile"),businessMobile:jq("#errorMsg_businessMobile"),pager:jq("#errorMsg_pager"),fax:jq("#errorMsg_fax"),email:jq("#errorMsg_email")}},groups:{},groupFields:{},groupLabels:{},clickedElem:"undefined",formHeader:"undefined",listEditArea:{initFields:function(Y){}},bindEvents:function(){bindEvents()},isValid:function(){return jq("#"+F+"form").valid()}};function O(){return Q}function N(){return Q.concat(["preferredContact"])}function K(Z,Y){B(Z,Y)}function B(Y,Z){rlAbstractForm.setData(Y,Z.value,undefined,F);if(typeof Z.preferred!=="undefined"){D(Y)}if(Z.preferred=="true"||Z.preferred==true){jq.each(jq("input[name=preferredContact]"),function(a,b){if(b.value==Y){b.checked=true}});jq.each(jq(".componentPreferredContactMarker"),function(a,b){jq(b).hide()});jq("."+Y+"ReadOnlyPreferred").show()}}function M(Z){var Y=0;if(Z.fax==null){delete Z.fax}if(Z.email==null){delete Z.email}if(Z.phone==null){delete Z.phone}if(Z.mobile==null){delete Z.mobile}if(Z.businessPhone==null){delete Z.businessPhone}if(Z.businessMobile==null){delete Z.businessMobile}if(Z.pager==null){delete Z.pager}jq.each(Z,function(b,a){Y++});return(Y===0)?undefined:Z}function R(c,a,Y){var b=rlAbstractForm.getData(Q,undefined,F);var Z=null;jq.each(jq("#"+F+" input[name=preferredContact]"),function(d,e){if(Z==null||e.checked){Z=e.value}});c.fax=!b||!b.fax||rlAbstractForm.isFieldEmpty(b.fax)?null:{value:b.fax,preferred:(Z=="fax")};c.email=!b||!b.email||rlAbstractForm.isFieldEmpty(b.email)?null:{value:b.email,preferred:(Z=="email")};c.phone=!b||!b.phone||rlAbstractForm.isFieldEmpty(b.phone)?null:{value:b.phone,preferred:(Z=="phone")};c.mobile=!b||!b.mobile||rlAbstractForm.isFieldEmpty(b.mobile)?null:{value:b.mobile,preferred:(Z=="mobile")};c.businessPhone=!b||!b.businessPhone||rlAbstractForm.isFieldEmpty(b.businessPhone)?null:{value:b.businessPhone,preferred:(Z=="businessPhone")};c.businessMobile=!b||!b.businessMobile||rlAbstractForm.isFieldEmpty(b.businessMobile)?null:{value:b.businessMobile,preferred:(Z=="businessMobile")};c.pager=!b||!b.pager||rlAbstractForm.isFieldEmpty(b.pager)?null:{value:b.pager,preferred:(Z=="pager")};return M(c)}function J(Z,Y){B(Z,Y)}function H(Z,Y){return rlAbstractFormFieldSet.onError(Z,Y)}function X(){jq.each(C,function(a,Z){var Z=C[a];var b=jq("#"+F+' input[name="'+Z[0]+'"]');var Y=jq("#"+F+Z[1]);if(b.length>0&&Y.length>0){b.keyup(function(g){if(g.keyCode==0){var f=true;for(var c=0;c<C.length;c++){if(a==c){continue}var d=jq("#"+F+' input[name="'+C[c][0]+'"]');if(d.length>0&&d.val().length>0){f=false}}if(f){Y.attr("checked",true)}}})}})}function W(Y){jq.each(jq("#"+Y+" input[name=preferredContact]"),function(a,b){var c=b.value;var Z=jq("#"+Y+" input[name="+c+"]");if(!Z.is(".required")){Z.bind("change keyup",function(){if(this.value==""){V(this.name)}else{D(this.name)}});V(c)}})}function D(Z){var Y=jq("#"+F+" input[value="+Z+"]");if(typeof Y.attr("disabled")!=="undefined"){Y.removeAttr("disabled").hide().show();if(jq("#"+F+" input[name=preferredContact]").filter(":checked").length==0){G()}}}function V(Z){var Y=jq("input[value="+Z+"]");if(typeof Y.attr("disabled")==="undefined"){Y.attr("disabled","disabled");if(typeof Y.attr("checked")!="undefined"){Y.removeAttr("checked");G()}}}function G(){var Y=false;jq.each(jq("input[name=preferredContact]"),function(Z,a){if(!Y&&!a.disabled){a.checked=true;Y=true}})}function I(){jq(".componentPreferredContactMarker").hide();jq.each(Q,function(Z,Y){rlAbstractForm.setData(Y,"",undefined,F)})}function P(a,Z){var Y=Z||{};var c=R(jq.extend({},Y),a);var b=jq.merge([],Q);jq.merge(b,["value"]);var d=rlAbstractFormFieldSet.getDiffs(b,Y,c);return d}function T(){var Y={name:"contactSet",coreId:["communications"],getFieldsNames:O,getCacheFieldsNames:N,callbackLoadedData:K,callbackBeforeSaveData:R,callbackAfterSaveData:J,callbackError:H,callbackStartEdit:U,callbackClearData:I,getDiffs:P};rlAbstractForm.registerComponent(Y)}function U(Y){}function S(a,Y){var Z="";jq.each(L.groupFields,function(d,e){Z+=e.value});var c=(Y)?(Z.length>0):true;if(c){var b=jq("#"+L.getListAreaId()+"form").closest("form");if(typeof b!=="undefined"){b.validate(L.groups)}}return c}function E(){var Z=jq("#"+F+"form").closest("form");if(Z&&Z.hasClass("formBoxForm")){var Y=jq.data(Z[0],"validator");if(typeof Y!=="undefined"){Y.settings.onkeyup=false}}}function A(Y){return(typeof Y==="object"&&typeof Y.phones==="string"&&Y.phones.length>0)}return{__init__:function(){},registerComponent:function(){T()},initForm:function(m,s,f,t){console.log("contactSetComponent::initForm: "+m);if(typeof t==="object"&&typeof t.phones==="string"){while(t.phones.length>0&&t.phones.charAt(0)===" "){t.phones=t.phones.substring(1)}}L.groups=t;var Z=rlPage.isEditMode()||rlPage.isDesignMode();if(!Z){var r=false;var h=false;var n=/^((?!.*(--|\/\/|  ))(?!.*\(.*\()(?!.*\).*\))[0-9-\/() ]{6,20}|\+[0-9-\/() ]{5,20})$/;var k=function(w,v){console.log("phone");console.dir({th:this,value:w,element:v});var u=r||w.length==0||n.test(w);if(u){}else{}return u};var g=function(w,v){console.log("anyphone");console.dir({th:this,value:w,element:v});var u=h||S(v,f);if(u){}else{}return u};F=m;var c="#"+F;rlAbstractFormFieldSet.initDefaultActions(L);var a=jq("#"+m+"form").closest("form");if(a){a.bmwValidate("addErrorPlacements",L.errorPlacements());if(A(t)){a.bmwValidate("modifyGroups",t);var d=t.phones.split(/\s/);var Y="";var b="";var o={};for(var q=0;q<d.length;q++){if(Y.length>0){Y+=", "}if(b.length>0){b+=", "}b+="#"+d[q]+"Label";Y+=c+" input:[name='"+d[q]+"']"}L.groupFields=jq(Y);L.groupLabels=jq(b);a.bmwValidate("addGroupLabels",{phones:L.groupLabels});a.bmwValidate("addGroupElements",{phones:L.groupFields});var e=jq.data(a[0],"validator");var j=e.settings.bmwValidate.grpElements.phones;for(var q=0;q<d.length;q++){o[d[q]]=e.groups[d[q]];delete e.groups[d[q]]}delete e.settings.bmwValidate.grpElements.phones;var p=e.settings.bmwValidate.grpLabels.phones;delete e.settings.bmwValidate.grpLabels.phones;jq(".required",jq(c)[0]).focusout(function(){var u=jq.data(a[0],"validator");u.element(this)});jq(".anyphone",jq(c)[0]).focusout(function(){var v=jq.data(a[0],"validator");r=true;h=true;v.element(this);h=false;r=false;if(!S(this,f)){v.settings.bmwValidate.grpElements.phones=j;v.settings.bmwValidate.grpLabels.phones=p;for(var u=0;u<d.length;u++){v.groups[d[u]]=o[d[u]]}r=true;v.element(this);r=false}else{r=true;v.element(this);r=false;delete v.settings.bmwValidate.grpElements.phones;for(var u=0;u<d.length;u++){delete v.groups[d[u]]}delete v.groups.phone;delete v.settings.bmwValidate.grpLabels.phones}})}else{jq(".required",jq(c)[0]).focusout(function(){var u=jq.data(a[0],"validator");u.element(this)})}a.bmwValidate("modifyValidationMessages",s)}else{console.warn("contactSetComponent::initForm: form not found")}E();jQuery.validator.addMethod("phone",k);jQuery.validator.addMethod("anyphone",g);X()}W(m)}}}();var rlContextObjectHelper=function(){function C(){rlCoreServices.isLoggedIn({loggedIn:function(){rlContextObject.setIsLoggedIn(true)},loggedOut:function(){rlContextObject.setIsLoggedIn(false)}})}function D(){var F,E;F=(rlMandator.getDlrOutletId()=="")?false:rlMandator.getDlrOutletId();E=(rlMandator.getDlrPartnerId()=="")?false:rlMandator.getDlrPartnerId();rlContextObject.setBrand(rlMandator.getBrand());rlContextObject.setDlrOutletId(F);rlContextObject.setDlrPartnerId(E);rlContextObject.setMarket(rlMandator.getMarket());rlContextObject.setLanguage(rlMandator.getLanguage());rlContextObject.setCountry(rlMandator.getCountry());rlContextObject.setLocale(rlMandator.getLocale());rlContextObject.setIsDealer(rlMandator.isDealer())}function B(){var E={accessoryId:false,accessoryName:false,priceFormatted:false,availableFor:false};if(jq('meta[name="productId"]').length==1){E.accessoryId=jq('meta[name="productId"]').attr("content");if(jq('meta[name="productName"]').length==1){E.accessoryName=escape(jq('meta[name="productName"]').attr("content"))}if(jq('meta[name="productPriceFormatted"]').length==1){E.priceFormatted=escape(jq('meta[name="productPriceFormatted"]').attr("content"))}if(jq('meta[name="availableForModelSeries"]').length==1){E.availableFor=escape(jq('meta[name="availableForModelSeries"]').attr("content"))}}rlContextObject.setAccessoryData(E);var F={persoContextId:""};if(jq('meta[name="bmwnext-teaser-contentSubType"]').length==1){F.persoContextId=jq('meta[name="bmwnext-teaser-contentSubType"]').attr("content")}rlContextObject.setPersoContext(F)}function A(){}return{__start__:function(){},__init__:function(){if(rlCoreServices){C()}if(rlMandator){D()}B();A()}}}();rlContextObjectModelCodeUpdater=function(){function B(C){rlNccServices.loadModelCodeMetaData({success:function(E){var D=E[C];if(D){rlContextObject.setModelCode(C);rlContextObject.setVehicleRFI((D.rfi==1));rlContextObject.setVehicleRFI((D.rfi==1));rlContextObject.setVehicleRFO((D.rfo==1));rlContextObject.setVehicleTDA((D.tda==1));rlContextObject.setVehicleRFP((D.rfp==1));rlContextObject.setIsSOC((D.soc==1));rlContextObject.setVehicleStayInformed((D.stayInformed==1));rlContextObject.setVehicleVisualizer((D.visualizer==1));rlContextObject.setVehicleESP((D.esp==1));rlContextObject.setDeliveryTime((D.deliveryTime!="")?D.deliveryTime:false)}jq(window).trigger("renderSalesBar");A()},error:function(D){console.error("rlNccServices.loadModelCodeMetaData failed:"+D)}})}function A(){var E=jq("#nccNavigationList").next();var D=E.attr("id");if(D==undefined||D!="howToBuyButtonLink"){var C=jq(".howToBuyButton").clone();jq("#nccNavigationList").after(C)}if(rlContextObject.getBrandSubbrand()=="brand-bmwi"&&rlContextObject.getContextObject().vehicle.RFP){jq("#module-navigation .howToBuyButton:hidden").fadeIn(1000)}else{jq("#module-navigation .howToBuyButton:visible").hide()}}return{setModelCode:B}}();rlCookieDisclaimerType=function(){function B(){if(cookieRegulation.policy=="OPT_OUT"){jq(".cookieDisclaimerContainerOptOut").show();jq("#cookieDisclaimerButtonAcceptOptOut").bind("click",function(){rlCookieController.setRegulationsAccepted();A(true)})}if(cookieRegulation.policy=="OPT_IN"){jq(".cookieDisclaimerContainerOptIn").show();jq("#cookieDisclaimerButtonAcceptOptIn").bind("click",function(){rlCookieController.setRegulationsAccepted();A(true)});jq("#cookieDisclaimerButtonRejectOptIn").bind("click",function(){rlCookieController.setRegulationsRejected();A()})}jq(".cookieDisclaimerContainerWrapper").delay(200).animate({height:jq(".cookieDisclaimerContainer:visible").height()},700)}function A(C){jq(".cookieDisclaimerContainerWrapper").animate({height:0},700,function(){if(C){window.setTimeout(function(){window.location.reload()},1400)}})}return{__init__:function(){if(rlCookieController.showDisclaimer()&&!rlPage.isEditMode()){B()}},showDisclaimerLayer:function(){B()}}}();rlCookieTable=function(){function A(C){accordionItemElem=jq(C).parent();var B=accordionItemElem.find(".tableCommon").height()+20;console.log("animateHeight: "+B);if(accordionItemElem.find(".cookieTableContentWrapper").height()!=0){accordionItemElem.find(".cookieTableContentWrapper").css({height:B,overflow:"hidden"});accordionItemElem.find(".cookieTableContentWrapper").stop(true,true).animate({height:"0"},700,function(){accordionItemElem.find(".baseIconSprite").removeClass("spriteIconMinusMedium").addClass("spriteIconPlusMedium");accordionItemElem.find(".cookieTableContentWrapper").css({overflow:"hidden"})})}else{accordionItemElem.find(".cookieTableContentWrapper").animate({height:B},700,function(){accordionItemElem.find(".cookieTableContentWrapper").css({height:"auto"});accordionItemElem.find(".baseIconSprite").removeClass("spriteIconPlusMedium").addClass("spriteIconMinusMedium")})}}return{__init__:function(){jq(".tableContainer .accordionToggle").unbind("click");jq(".tableContainer .accordionToggle").live("click",function(B){A(this)});if(document.location.search.indexOf("designbg")>0){jq("body").css({"background-image":"url(https://bmwnext-build.bmwgroup.net:4000/confluence/download/attachments/23698521/cookiesPolicyPage_M.jpg?version=2&modificationDate=1381157273000)","background-position":"176px -119px","background-repeat":"no-repeat"});jq(".standardContent").css({"background-color":"rgba(255,100,100,0.2)"})}}}}();var rlCookiesDisabledBanner=function(){function B(){jq.fx.interval=10;jq(".cookiesDisabledBanner").animate({height:jq(".cookiesDisabledBannerContainer").height()+"px"},300);jq.fx.interval=13}function A(){jq(".cookiesDisabledBanner").animate({height:"0px"},300)}return{__init__:function(){jq(window).bind(rlComponentLoader.getPageReadyTriggerName(),function(){if(navigator.cookieEnabled!==true){B()}});jq(".cookiesDisabledBannerClose").bind("click",function(){A()})},show:function(){B()},hide:function(){A()}}}();var rlCookiesDisclaimer=function(){function J(){return(jq.cookie("cookieDisclaimer")===GLOBAL_COOKIEDISCLAIMER_TIMESTAMP)}function C(){return(jq(".threeColumnsCenter > .cookiesDisclaimerCenterColumn").size()>0)}function F(K){jq("#cookieDisclaimerInfoLink .baseLabelSprite").addClass("spriteLabelWarningRed12").removeClass("spriteLabelCheckedGreen12");jq(".cookiesButtonRetry").css("display","none");jq(".cookiesButtonTextAccept").css("display","table-cell");jq(".cookiesButtonTextReject").css("display","none")}function A(K){jq("#cookieDisclaimerInfoLink .baseLabelSprite").addClass("spriteLabelCheckedGreen12").removeClass("spriteLabelWarningRed12");jq(".cookiesButtonRetry").css("display","none");jq(".cookiesButtonTextAccept").css("display","none");jq(".cookiesButtonTextReject").css("display","table-cell");if(typeof K!=="undefined"){jq(K.target).parents(".contextLayerDialogMain:first").css("display","none")}}function D(){rlComponentLoader.deferredExec(["contextLayer"],function(){var K=rlContextLayer.getJavaScriptInterface("#cookieDisclaimerInfo");if(K!=undefined){K.openLayer()}})}function E(K){if(J()){A(K)}else{F(K)}}function B(K,M,L){document.cookie=K+"="+((M)?";path="+M:"")+((L)?";domain="+L:"")+";expires=Thu, 01 Jan 1970 00:00:01 GMT"}function G(){var M={path:"/"};var N="."+I();if(N&&N!="localhost"){M.domain=N}var S=document.cookie.split(";");for(var O=0;O<S.length;O++){var L=S[O];var P=L.indexOf("=");var K=P>-1?L.substr(0,P):L;var R=B(K,M.path,location.host);var Q=B(K,M.path,M.domain)}location.href=GLOBAL_COUNTRY_SERVER+"/"+mandatorLocaleNodeName+GLOBAL_COOKIES_ERROR_PAGE_PATH}function H(L,M){var K=I();var N={path:"/"};if(L){N.expires=365}if(K&&K!="localhost"){N.domain=K}jq.cookie("cookieDisclaimer",L,N);E(M)}function I(){return rlCrossSubDomainAjax.getAllowedAJAXDomain()}return{__init__:function(){if(GLOBAL_COOKIEDISCLAIMER_TIMESTAMP==""||GLOBAL_COOKIEDISCLAIMER_TIMESTAMP===null){GLOBAL_COOKIEDISCLAIMER_TIMESTAMP="accepted"}jq(".cookiesButtonTextAccept").bind("click",rlCookiesDisclaimer.acceptCookieDisclaimer);jq(".cookiesButtonRetry").bind("click",rlCookiesDisclaimer.acceptCookieDisclaimer);jq(".cookiesButtonTextReject").bind("click",rlCookiesDisclaimer.rejectCookieDisclaimer);jq(".cookiesButtonDelete").bind("click",rlCookiesDisclaimer.deleteAllCookies);E();if(!J()&&!C()){D()}},__start__:function(){},deleteAllCookies:function(){G();if(window.rlCoreServices&&window.rlCoreServices.trackEventAsClick){var K=(jq(event.target).parents(".InfoLayer").length>0?"Layer":"Page");window.rlCoreServices.trackEventAsClick("ckdsDeleteButtonClick_From"+K,"genericAction/button/click")}},acceptCookieDisclaimer:function(K){if(navigator.cookieEnabled){jq(".cookiesLayerFailedToDeleteCookiesText").hide();jq(".cookiesLayerDescriptionDelete").show();H(GLOBAL_COOKIEDISCLAIMER_TIMESTAMP,K);if(window.rlCoreServices&&window.rlCoreServices.trackEventAsClick){var L=(jq(K.target).parents(".InfoLayer").length>0?"Layer":"Page");window.rlCoreServices.trackEventAsClick("ckdscAcceptButtonClick_From"+L,"genericAction/button/click")}}else{jq(".cookiesButtonRetry").css("display","table-cell");jq(".cookiesButtonTextAccept").css("display","none");jq(".cookiesLayerDescriptionDelete").hide();jq(".cookiesLayerFailedToDeleteCookiesText").show()}},rejectCookieDisclaimer:function(K){H(null,K);if(window.rlCoreServices&&window.rlCoreServices.trackEventAsClick){var L=(jq(K.target).parents(".InfoLayer").length>0?"Layer":"Page");window.rlCoreServices.trackEventAsClick("ckdscRevokeButtonClick_From"+L,"genericAction/button/click")}}}}();var rlCtxObjConfigCountListener=function(){function C(){rlContextObject.setSavedConfigs(undefined);rlNccServices.getConfigCount({success:function(D){rlContextObject.setSavedConfigs(D&&parseInt(D)>0);jq(window).trigger("renderSalesBar")},error:function(){rlContextObject.setSavedConfigs(false);if(!rlContextObject.getIsNCC()){rlContextObject.resetVehicle()}jq(window).trigger("renderSalesBar")}})}function A(){jq(window).bind(rlNccServices.EVENT_CONFIG_WASDELETED,C);jq(window).bind(rlNccServices.EVENT_CONFIG_WASCREATED,C)}function B(){rlCoreServices.isLoggedIn({loggedIn:function(){C()},loggedOut:jq.noop})}return{__init__:function(){rlComponentLoader.deferredExec(["nccServices"],function(){A();B()})},__start__:function(){}}}();var rlCtxObjConfigIdListener=function(){var H=0;function B(J,K){if(!rlContextObject.getContextObject().page.isNCC){E(K)}}function I(K,J){if(!rlContextObject.getContextObject().page.isNCC){E(J.configId);G(J)}}function F(K,J){if(!rlContextObject.getContextObject().page.isNCC){E(J.configId)}}function E(J){rlContextObject.resetVehicle();H++}function G(J){rlContextObject.setConfigId(J.configId);rlContextObject.setBrandSubbrand(rlNccServices.isSubBrandBMWi(J)?"brand-bmwi":"brand-bmw");rlContextObject.setModelRangeId(J.modelSection.marketingModelRangeCode.value);rlContextObject.setSeriesId(J.modelSection.series.value);rlContextObject.setBodyTypeId(J.modelSection.bodyType.value);rlContextObject.setVehicleRFI(J.rfxCapabilities.rfi);rlContextObject.setVehicleRFO(J.rfxCapabilities.rfo);rlContextObject.setVehicleRFP(J.rfxCapabilities.rfp);rlContextObject.setVehicleTDA(J.rfxCapabilities.tda);rlContextObject.setIsSOC(J.rfxCapabilities.soc);rlContextObject.setVehicleESP(J.rfxCapabilities.esp);jq(window).trigger("renderSalesBar")}function D(){jq(window).bind("configIdChanged",B);jq(window).bind("configChanged",I);jq(window).bind(rlNccServices.EVENT_CONFIG_WASDELETED,F)}function A(){C()}function C(){if(typeof nccData!=="undefined"){rlContextObject.setModelRangeId(nccData.getModelCode())}else{if(typeof cmxData!=="undefined"){rlContextObject.setModelRangeId(cmxData.getModelRangeId())}}if(rlContextObject.getContextObject().vehicle.modelRangeId==""){rlContextObject.setModelRangeId(undefined)}}return{__init__:function(){D();A()},__start__:function(){}}}();var rlCtxObjVehicleCountListener=function(){function C(){rlContextObject.setHasSavedVehicles(undefined);rlNccServices.getPreOwnedVehicleCount({success:function(D){rlContextObject.setHasSavedVehicles(D&&parseInt(D.bmws)>0);jq(window).trigger("renderSalesBar")},error:function(){rlContextObject.setHasSavedVehicles(false);if(!rlContextObject.getIsNCC()){rlContextObject.resetVehicle()}jq(window).trigger("renderSalesBar")}})}function A(){jq(window).bind(rlNccServices.EVENT_POV_WASDELETED,C);jq(window).bind(rlNccServices.EVENT_POV_WASCREATED,C)}function B(){rlCoreServices.isLoggedIn({loggedIn:function(){C()},loggedOut:jq.noop})}return{__init__:function(){rlComponentLoader.deferredExec(["nccServices"],function(){A();B()})},__start__:function(){}}}();var rlCtxObjVehicleListener=function(){function B(D,E){if(!rlContextObject.getContextObject().page.isNCC){rlContextObject.resetVehicle();if(E){rlContextObject.setVehicleId(E.vehicleId);rlContextObject.setBrandSubbrand(rlNccServices.isSubBrandBMWi(E)?"brand-bmwi":"brand-bmw");rlContextObject.setModelRangeId(E.series);rlContextObject.setSeriesId(undefined);rlContextObject.setBodyTypeId(undefined)}jq(window).trigger("renderSalesBar")}}function C(){if(!rlContextObject.getContextObject().page.isNCC){rlContextObject.resetVehicle()}}function A(){jq(window).bind("vehicleChanged",B);jq(window).bind(rlNccServices.EVENT_POV_WASDELETED,C)}return{__init__:function(){rlComponentLoader.deferredExec(["nccServices"],function(){A()})},__start__:function(){}}}();var rlCurrentDealerRfxFS=function(){function A(L,D){var K=CoreFormsBase.inheritanceFrom(rlCurrentDealerBaseFS.createFS(L,D));var J=K.parent;K.typeName="rlCurrentDealerRfxFS";var I=false;K.selectedDealer=null;K.init=function(){J.init()};K.onFormReady=function(){J.onFormReady();rlDloWorkflowController.getController(L).addWorkflowListener(K);rlDloEventsController.getController(L).addSelectEventListener(K);rlPreferredDealersModel.addChangeListener(K)};K.onFormClosing=function(){J.onFormClosing();rlDloWorkflowController.getController(L).removeWorkflowListener(K);rlDloEventsController.getController(L).removeSelectEventListener(K);rlPreferredDealersModel.removeChangeListener(K)};K.onPreferredDealersModelChange=function(N){K.updateView()};K.onSelectionEvent=function(O,N){if((O=="select")&&isDefined(N)){rlCurrentDealerModel.requestCurrentDealer(function(P){if(P!==null&&N.id===P.id){K.selectedDealer=N}},function(P){})}J.onSelectionEvent(O,N)};K.onWorkflowStepChanged=function(P,Q,O,N){I=false;switch(P){case 1:break;case 2:I=true;break;case 3:J.hideComponent();break;default:console.error(componentLogPrefix+"Unrecognized workflow step!")}if(N!==null){K.updateView(N);if(!H(N)&&P===1||P===2){C(N)}}};K.updateView=function(N){G(N,{onComponentVisible:function(){E(N);J.showComponent()},onComponentInvisible:function(){J.hideComponent()}})};K.buildDealerInfo=function(P){var O=J.buildDealerInfo(P);if(!H(P)){O.click(M(P))}else{O.addClass("contextMismatch");var N=jq("<div/>").addClass("dealerNotAvailable").text(rlDloSharedConfig.messages.contextMismatch);O.append(N)}return O};K.createDealerLinksMarkup=function(N){var Q=rlDloBaseFS.getDloId(L);var O=rlDloEventTracker.create("CurrentDealer",D.formType,Q);var P=rlDealerLinksBuilder.create(N,O);if(K.isHomepageLinkEnabled()){P.addHomepageLink()}if(K.isDloMapVisible()===true){P.addDetailsLink(K.onDetailsLinkClicked(N))}P.addSelectDealerLink(B(N));P.addActiveSelectionIndicator();return P.build()};K.isDloMapVisible=function(){return I&&(rlComponentLoader.isRunning("dloMapRfxFS"))};K.getEditedData=function(N){return N};function E(O){var P=L.find(K.options.divCurrentDealerContent);P.empty();var N=K.buildDealerInfo(O);P.append(N)}function C(N){L.find(".dloDealer").removeClass("selected");if(K.selectedDealer&&K.selectedDealer.key==N.key){L.find(".dloDealer").addClass("selected")}else{rlDloWorkflowController.getController(L).requestPreselectedDealer(D.formType,function(O){if(O){rlDloEventsController.getController(L).fireSelectionEvent("preselect",O)}},function(O){console.error(O)})}}function G(O,N){if(!O||F()){N.onComponentInvisible();return }rlPreferredDealersModel.requestPreferredDealers(function(P){var Q=false;jq.each(P,function(R,S){if(O.key==S.key){Q=true;return false}});if(Q){N.onComponentInvisible()}else{N.onComponentVisible()}},function(P){})}function F(){return typeof rlContextObject==="object"&&typeof rlContextObject.getDlrPartnerKey()!=="undefined"}function H(O){var P=rlDloBaseFS.getDloId(L);var N=rlDloSubBrandService.getSubBrand(P);return rlDealerFilterHelper.hasMismatch(O,D.formType,N)}function B(N){return function(){if(rlDloWorkflowController.getController(L).getCurrentStep()===2){jq(window).trigger(rlFormFieldSet.EVENT_FIELDSET_SIZE_CHANGED,rlDloSharedConfig.domSelectors.rfxScrollToElem)}rlDloEventsController.getController(L).fireSelectionEvent("select",N)}}function M(N){return B(N)}return K}return{__init__:function(){},__start__:function(){},createFS:function(B,C){return A(B,C)}}}();var rlCurrentVehicleFS=function(){function A(B,E){var C=CoreFormsBase.inheritanceFrom(rlVehicleDetailsFS.createFS(B,E));var D=C.parent;C.typeName="rlCurrentVehicleFS";C.getEditedData=function(F){F=D.getEditedData(F);if(F.vehicle&&F.vehicle.annualUse){F.vehicle.mileageYear=F.vehicle.annualUse;delete F.vehicle.annualUse}return F};return C}return{__init__:function(){},__start__:function(){},createFS:function(B,C){return A(B,C)}}}();var rlCustomDealerPolicyFS=function(){var B={consentedUsages:[],revokedUsages:[],cmxUrl:"DUMMY_POLICY_URL"};function A(O,E){var N=CoreFormsBase.inheritanceFrom(rlFormFieldSet.createFS(O,E));var J=N.parent;N.typeName="rlCustomDealerPolicyFS";N.init=function(){J.init();F();D();K()};N.getFormSummary=function(Q,P){return Q};N.getMailSummary=function(P){return P};N.getPdfSummary=function(Q,P){return Q};function H(){return O.find(".fieldSetEditMode .customDealerPolicyContent")}function C(R,P){var S=(R instanceof jQuery&&R.length>0)?R[0]:R;if(!S){return false}if(typeof S.hasAttribute==="function"){return S.hasAttribute(P)}var T=S.getAttribute(P);if(typeof T==="undefined"||T===null){return false}var Q=S.outerHTML;return new RegExp("\\s+"+P+"(\\W|$)","i").test(Q.substr(0,Q.search(/\/?['"]?>(?![^<]*<['"])/)))}function M(P){var Q="["+P+'!=""]';return function(R,T){var S=(T instanceof jQuery)?T:jq(T);return C(T,P)&&S.is(Q)}}function I(P){var Q=M(P);return function(R,S){return !Q(R,S)}}N.getEditedData=function(Q){Q=J.getEditedData(Q)||{};var P=H();var R=G(P,{});R=L(P,R);Q.policyCurrent_CONTACT_DEALER=jq.extend(true,Q.policy||{},B);Q.policy=Q.policyCurrent_CONTACT_DEALER;Q.customDealerPolicyInfo=jq.extend(true,Q.customDealerPolicyInfo||{},R);return Q};function G(P,Y){Y=Y||{};var S=I("value");var U={};P.find(':checkbox[name][name!=""]').each(function(d,f){var e=jq(f);var c=e.attr("name");U[c]=U[c]||[];U[c].push(e)});for(var Q in U){if(U.hasOwnProperty(Q)){var X=U[Q];var a=jq(jq.map(X,function(c){return c.get()})).filter(":checked");var Z=a.filter(S);var R=null;for(var T=0,b=X.length;T<b;T++){var V=X[T];var W=null;if(a.length<1){if(a.length<1&&X[X.length-1][0]===V[0]){W="false"}}else{if(Z.length<1){if(V.prop("checked")){W=V.attr("value")}}else{if(V.prop("checked")){W=C(V,"value")?V.attr("value"):"true"}else{W="false"}}}if(typeof W!=="undefined"&&W!==null){R=R?R+", "+W:W}}Y[Q]=R}}return Y}function L(P,Q){Q=Q||{};P.find(':radio[name][name!=""]').each(function(U,T){var R=jq(T);var S=R.attr("name");var V=null;if(R.prop("checked")){V=C(T,"value")?R.attr("value"):"true";Q[S]=Q[S]?Q[S]+", "+V:V}else{if(!Q[S]&&P.find(':radio[name="'+S+'"]:checked').length<1){Q[S]="false"}}});return Q}function K(){var R=H();var Q=R.find(":checkbox, :radio");if(E&&typeof E.sortPolicyControls==="function"){Q=E.sortPolicyControls(Q)}function S(T){return T.is('[data-disable-followers][data-disable-followers!="false"]]')}function P(){var U=jq(this);var V=!U.prop("checked");var T=false;Q.each(function(X,Z){var Y=jq(Z);var a=false;if(T){var W=Y.data("initial-value")==="true";if(V&&Y.prop("checked")!==W){Y.prop("checked",W)}if(!Y.prop("checked")&&S(Y)){a=true}Y.prop("disabled",V)}else{T=(U[0]===Z)}if(a){(jq.proxy(P,Z))();return false}})}Q.each(function(T,V){var U=jq(V);U.data("initial-value",String(U.prop("checked")))});Q.filter(function(T,U){return S(jq(U))}).each(function(T,W){var V=jq(W);var U=/msie/i.test(navigator.userAgent)?"propertychange":"change";V.unbind(U,P)&&V.bind(U,P);if(T<1){(jq.proxy(P,W))()}})}function F(){if(O.closest("form").find(".customDealerPolicyFS,.policyBaseFS").length>1){O.find(".fieldSetEditMode div.tooManyPolicyFSError").addClass("showError");var P=O.closest("div.customDealerPolicyFS");!P.hasClass("customDealerPolicyFSError")&&P.addClass("customDealerPolicyFSError")}}function D(){var P=H();P.find(":checkbox, :radio").not('[name][name!=""]').each(function(Q,S){var R=jq(S);O.find(".fieldSetEditMode div.tooManyPolicyFSError").removeClass("showError");O.find(".fieldSetEditMode div.controlHasNoNameError").addClass("showError");!R.hasClass("controlHasNoNameError")&&R.addClass("controlHasNoNameError");var T=O.closest("div.customDealerPolicyFS");!T.hasClass("customDealerPolicyFSError")&&T.addClass("customDealerPolicyFSError")})}return N}return{__init__:function(){},__start__:function(){},createFS:function(C,D){return A(C,D)}}}();var rlDashboardmodule=(function(){var M={};var L=false;var G=false;var F=false;var D={};var C;function A(O){jq.each(M,function(P,Q){jq("#"+Q.id+" .dashboardModuleLoggedOut").css("visibility","visible");if(Q.isLoggedIn&&jq("#"+Q.id+" .dashboardModuleLoggedIn .dashboardModuleTeaser_isEmpty").length===0){Q.isLoggedIn=false;jq("#"+Q.id+" .dashboardModuleLoggedIn").hide();jq("#"+Q.id+" .dashboardModuleLoggedOut").show();jq(window).trigger(rlDashboardmodule.getLogoutTriggerName(),[Q.id,false])}});F=true;I();E(false)}function K(O){jq.each(M,function(P,Q){jq("#"+Q.id+" .dashboardModuleLoggedIn").css("visibility","visible");jq("#"+Q.id+" .dashboardModuleLoggedOut").css("visibility","visible");if(!Q.isLoggedIn&&jq("#"+Q.id+" .dashboardModuleLoggedIn .dashboardModuleTeaser_isEmpty").length===0){Q.isLoggedIn=true;if(D[Q.id]){D[Q.id]()}else{jq("#"+Q.id+" .dashboardModuleLoggedOut").hide();jq("#"+Q.id+" .dashboardModuleLoggedIn").show()}jq(window).trigger(rlDashboardmodule.getLoginTriggerName(),[Q.id,true])}});F=true;I();E(true)}function B(){if(!L){rlCoreServices.addLoggedInListener(K);rlCoreServices.addLoggedOutListener(A);L=true}}function I(){var O=jq(".dashboardmodule .dashboardModule");jq.each(M,function(P,Q){if(Q.visibilityFn){var R=Q.id;Q.visibilityFn(function(S){if(S){jq("#"+R).parent().show()}else{jq("#"+R).parent().hide()}})}})}function H(O){if(O.roles.length==O.index+1){rlCoreServices.checkForRole({role:O.roles[O.index],yes:O.yes,no:O.no})}else{rlCoreServices.checkForRole({role:O.roles[O.index],yes:O.yes,no:function(){O.index++;H(O)}})}}function J(O){if(this.roles&&this.roles.length>1){var P=this.roles.split(";");H({roles:P,index:0,yes:function(){O(true)},no:function(){O(false)}})}else{O(true)}}function N(P,O){return function(Q){P(function(R){if(!R){Q(R)}else{O(Q)}})}}function E(O){var S="myBMWPageMydashboard.myBMWContentArea.myBMWMainContentModules/";var P=[];var Q=0;jq.each(jq(".dashboardmodule .dashboardModule"),function(T,U){jq.each(jq(U).children(),function(a,X){if(jq(X).is(":visible")){var W=jq(jq(X).find("h2")[0]).text();var Z=U.getAttribute("data-trackingid")+"."+W;var V=S+Z;P[Q++]=Z;var Y=jq(X).find("a");jq.each(Y,function(b,c){jq(c).click(function(){C.trackCustomEvent(V+"/"+jq(c).text(),"mybmwAction/clickDashboardModule")})})}})});function R(T){if(!T||!jq.isArray(T)||T.length<1){return T}var V={};for(var U=0;U<T.length;U++){if(V[T[U]]){T.splice(U--,1)}else{V[T[U]]=true}}return T}window.mybmwDisplayedDashobardModules=R(P).join("|")}return{__init__:function(){C=rlEventTracker.create("mybmwDashboardModule");var O=rlPage.isEditMode()||rlPage.isDesignMode();if(!O){jq(".dashboardmodule").hide();jq.each(jq(".dashboardmodule .dashboardModule"),function(P,Q){M[Q.id]={id:Q.id,isLoggedIn:false,jsObj:null,visibilityFn:J,roles:jq("#"+Q.id).attr("data-roles")};console.log("Dashboard Module with id "+Q.id+" is registered")});rlCoreServices.isLoggedIn({loggedIn:K,loggedOut:A});B()}else{jq(".dashboardModuleLoggedOut").css("visibility","visible")}},__start__:function(){},reorderModules:function(){I()},registerModule:function(P,O){if(!G){jq.each(M,function(Q,R){if(R.id===P&&!R.jsObj){console.log("Register module with id "+P);R.jsObj=O;var S=jq("#"+P).attr("data-roles");if(O.visibilityCheckCallback){if(R.visibilityFn===null){R.visibilityFn=O.visibilityCheckCallback}else{R.visibilityFn=N(R.visibilityFn,O.visibilityCheckCallback)}}else{if(R.visibilityFn===null){R.visibilityFn=function(T){T(true)}}}if(O.changeLoginStateCallback){jq(window).bind(rlDashboardmodule.getLoginTriggerName(),O.changeLoginStateCallback);jq(window).bind(rlDashboardmodule.getLogoutTriggerName(),O.changeLoginStateCallback);if(F){O.changeLoginStateCallback(null,P,R.isLoggedIn);I()}}jq(window).bind(rlDashboardmodule.getShowAllTriggerName(),O.showAllCallback);return false}})}return !G},showAll:function(Q,P){try{window.bmwcsacaptureEvent(P)}catch(O){console.error("Tracking error ",O)}jq(window).trigger(this.getShowAllTriggerName(),Q)},getShowAllTriggerName:function(){return"DashboardModule_ShowAll_Trigger"},getLoginTriggerName:function(){return"DashboardModule_Login_Trigger"},getLogoutTriggerName:function(){return"DashboardModule_Logout_Trigger"},haveAlreadyCalledLoggedInTrigger:function(){return F},openForAuthor:function(P,O){if(!rlPage.isEditMode()){if(typeof O==="string"&&O!==""){window.open(P,O)}else{window.open(P)}}},addLoginCallback:function(P,O){D[P]=O}}}());var rlDataSheet=function(){var D="-";function C(F){function G(H){if(typeof H!="undefined"&&H!=D){if(H=="0"){return false}else{if(H=="1"){return true}else{return false}}}}if(F in attributes){var E=attributes[F];rlContextObject.setVehicleRFI(G(E.RFI));rlContextObject.setVehicleRFO(G(E.RFO));rlContextObject.setVehicleRFP(G(E.RFP));rlContextObject.setVehicleTDA(G(E.TDA));rlContextObject.setVehicleStayInformed(G(E.StayInformed));rlContextObject.setModelCode(F);jq(window).trigger("renderSalesBar")}}function B(F){if(F!==null&&F!=="undefined"&&F!==""){window.bmwModelCode=F;C(F);rlSalesBarAnimation.updateModelCodeUrl()}var E=jq("#datasheet-"+F).find("a").attr("href");if(E!==null&&typeof E!=="undefined"&&E!==""){window.bmwModelCodeUrl=E}}function A(E){jq(".specContainerDataSheet").hide();jq("#datasheet-"+E).show();jq("#dataSheetChanger").val(E);B(E)}return{__init__:function(){var F=jq("#dataSheetChanger option:first").val();var E=window.location.hash;if(E.length>0&&jq(E).length>0){F=jq(E).attr("id")}A(F);jq("#dataSheetChanger").bind(jq("html").is(".ie7, .ie8")?"propertychange":"change",function(){A(jq(this).val())})}}}();var rlDateFormat=function(){return{__init__:function(){Date.prototype.getMDay=function(){return(this.getDay()+6)%7};Date.prototype.getISOYear=function(){var B=new Date(this.getFullYear(),this.getMonth(),this.getDate()+3-this.getMDay());return B.getFullYear()};Date.prototype.getISOWeek=function(){var B=new Date(this.getISOYear(),0,1);var C=Math.ceil((((this-B)/86400000)+B.getMDay()+1)/7);if(B.getMDay()>3){C--}return C};Date.prototype.getJulian=function(){return Math.floor((this/86400000)-(this.getTimezoneOffset()/1440)+2440587.5)};Date.prototype.getMonthName=function(){var B=["January","February","March","April","May","June","July","August","September","October","November","December"];return B[this.getMonth()]};Date.prototype.getMonthShort=function(){var B=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];return B[this.getMonth()]};Date.prototype.getDayName=function(){var B=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];return B[this.getDay()]};Date.prototype.getDayShort=function(){var B=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];return B[this.getDay()]};Date.prototype.getOrdinal=function(){var B=this.getDate();switch(B){case 1:case 21:case 31:return"st";case 2:case 22:return"nd";case 3:case 23:return"rd";default:return"th"}};Date.prototype.getDOY=function(){var B=new Date(this.getFullYear(),0,1);if(B.getDST()){B.addHours(1)}if(this.getDST()){B.addHours(-1)}return Math.ceil((this-B+1)/86400000)};Date.prototype.getWeek=function(){var B=new Date(this.getFullYear(),0,1);return Math.ceil((((this-B)/86400000)+B.getDay()+1)/7)};Date.prototype.getStdTimezoneOffset=function(){var B=new Date(this.getFullYear(),0,1);var C=new Date(this.getFullYear(),6,1);return Math.max(B.getTimezoneOffset(),C.getTimezoneOffset())};Date.prototype.getDST=function(){return this.getTimezoneOffset()<this.getStdTimezoneOffset()};Date.prototype.getSwatch=function(){var B=((this.getUTCHours()+1)%24)+this.getUTCMinutes()/60+this.getUTCSeconds()/3600;return Math.floor(B*1000/24)};function A(D,C){var B=new Date(C,D,0);return B.getDate()}Date.prototype.format=function(H){var B=H.split("");var J="";for(var F=0,D=B.length;F<D;F++){switch(B[F]){case"^":J+=B[++F];break;case"d":var I=this.getDate();J+=((I<10)?"0":"")+I;break;case"D":J+=this.getDayShort();break;case"j":J+=this.getDate();break;case"l":J+=this.getDayName();break;case"S":J+=this.getOrdinal();break;case"w":J+=this.getDay();break;case"z":J+=this.getDOY()-1;break;case"R":var M=this.getDOY();if(M<9){M="0"+M}J+=(M>99)?M:"0"+M;break;case"F":J+=this.getMonthName();break;case"m":var C=this.getMonth()+1;J+=((C<10)?"0":"")+C;break;case"M":J+=this.getMonthShort();break;case"n":J+=(this.getMonth()+1);break;case"t":J+=A(this.getMonth()+1,this.getFullYear());break;case"L":J+=(A(2,this.getFullYear())==29)?1:0;break;case"Y":J+=this.getFullYear();break;case"y":var K=this.getFullYear().toString().substr(3);J+=((K<10)?"0":"")+K;break;case"a":J+=(this.getHours()>11)?"pm":"am";break;case"A":J+=(this.getHours()>11)?"PM":"AM";break;case"g":var G=this.getHours()%12;J+=(G==0)?12:G;break;case"G":J+=this.getHours();break;case"h":var G=this.getHours()%12;J+=(G==0)?12:(G>9)?G:"0"+G;break;case"H":var G=this.getHours();J+=(G>9)?G:"0"+G;break;case"i":var C=this.getMinutes();J+=(C>9)?C:"0"+C;break;case"s":var N=this.getSeconds();J+=(N>9)?N:"0"+N;break;case"O":var C=this.getTimezoneOffset();var N=(C<0)?"+":"-";C=Math.abs(C);var G=Math.floor(C/60);C=C%60;J+=N+((G>9)?G:"0"+G)+((C>9)?C:"0"+C);break;case"P":var C=this.getTimezoneOffset();var N=(C<0)?"+":"-";C=Math.abs(C);var G=Math.floor(C/60);C=C%60;J+=N+((G>9)?G:"0"+G)+":"+((C>9)?C:"0"+C);break;case"U":J+=Math.floor(this.getTime()/1000);break;case"I":J+=this.getDST()?1:0;break;case"K":J+=this.getDST()?"DST":"Std";break;case"c":J+=this.format("Y-m-d^TH:i:sP");break;case"r":J+=this.format("D, j M Y H:i:s P");break;case"Z":var E=this.getTimezoneOffset()*-60;J+=E;break;case"W":J+=this.getISOWeek();break;case"X":J+=this.getWeek();break;case"x":var L=this.getWeek();J+=((L<10)?"0":"")+L;break;case"B":J+=this.getSwatch();break;case"N":var I=this.getDay();J+=I?I:7;break;case"u":J+=this.getMilliseconds()*1000;break;case"o":J+=this.getISOYear();break;case"J":J+=this.getJulian();break;case"e":case"T":break;default:J+=B[F]}}return J}}}}();var rlDealerBuilder=function(){function A(D){var B={};var E=H();function H(){return jq("<div/>").addClass("dloDealer").attr("data-dealerkey",D.key)}B.addId=function(I){E.attr("id",I)};B.addShadow=function(){E.addClass("shadow")};B.addHtml=function(I){E.append(I)};B.wrapWithInnerAndOuterBorder=function(){var I=jq("<div/>").addClass("innerBorderHelper");E.children().wrapAll(I);var J=jq("<div/>").addClass("outerBorderHelper");E.children().wrapAll(J)};B.addRemoveIcon=function(J){var I=jq("<a/>").attr("href","javascript://").addClass("removeFromWatchlist baseIconSprite baseIconSizeMedium spriteIconDeleteMedium");I.attr("title",rlDloSharedConfig.labels.deleteTooltip);I.click(G(J));E.append(I)};function G(I){return function(){E.addClass("isShowingDeleteDialog");I();return false}}B.addDeleteDialog=function(O,K){var N=jq("<div/>").addClass("deleteDialogContent");var L=jq("</p>").addClass("deleteConfirmationMessage").html(rlDloSharedConfig.messages.deleteDialogIntro);var I=jq("<div/>").addClass("deleteDialogLinks");var M=F().addClass("buttonBlue").addClass("deleteLink").html(rlDloSharedConfig.labels.deleteLink);M.click(C(O));var J=F().addClass("buttonGrey").addClass("cancelLink").html(rlDloSharedConfig.labels.cancelLink);J.click(C(K));I.append(M);I.append(J);N.append(L);N.append(I);E.append(N)};function F(){return jq("<a/>").attr("href","javascript://").addClass("buttonComp")}function C(I){return function(){E.removeClass("isShowingDeleteDialog");I();return false}}B.build=function(){return E};return B}return{__init__:function(){},__start__:function(){},create:function(B){return A(B)}}}();var rlDealerInfoBox=function(){return{isDealerStored:false,__start__:function(){rlComponentLoader.requireComponentWithDeferredExec("preferredDealersModel",function(){rlDealerInfoBox.installPreferredDealersModelListener()})},__init__:function(){},installPreferredDealersModelListener:function(){rlPreferredDealersModel.addErrorListener({onPreferredDealersModelError:function(A){if(A==rlPreferredDealersModel.errorTypes.ERROR_PDM_MAXIMUM_REACHED){var B={initialError:A};rlUserDialog.showRequestDealerWatchlist(B)}}});rlPreferredDealersModel.addChangeListener({onPreferredDealersModelChange:function(A){rlDealerInfoBox.checkStoredDealers(A,true)}});rlPreferredDealersModel.requestPreferredDealers(function(A){rlDealerInfoBox.checkStoredDealers(A)},function(A){})},checkStoredDealers:function(B,E){var D=rlMandator.getDlrPartnerId()+"_"+rlMandator.getDlrOutletId();var A=jq(".dealerMarker");if(B){for(var C=0;C<B.length;C++){if(B[C].key==D){if(B[C].primary==true){A.addClass("dealerInfoIconPrimaryDealer")}else{A.addClass("dealerInfoIconMarkPrimaryDealer")}this.displayManageDealersLink(E);return }}}this.hideManageDealersLink()},displayManageDealersLink:function(A){if(this.isDealerStored){return }this.isDealerStored=true;jq("#prefDealerRemember").hide();if(A){jq("#prefDealerStoredMsg").show().delay(1500).animate({opacity:"toggle"},500,"linear",function(){jq("#prefDealerManage").fadeIn()})}else{jq("#prefDealerManage").fadeIn()}},hideManageDealersLink:function(){if(!this.isDealerStored){return }this.isDealerStored=false;jq("#prefDealerStoredMsg").hide();jq("#prefDealerManage").hide();jq("#prefDealerRemember").show()}}}();var rlDealerOfferRequestButton=function(){return{__start__:function(){},__init__:function(){},openDialog:function(B){var C=jq(B).parent("div").attr("offerRequestId");var A={dealerOfferReferenceId:C};rlUserDialog.showContactForm(A)}}}();var rlDealerSearchBaseFS=function(){function A(K,D){var J=CoreFormsBase.inheritanceFrom(rlFormFieldSet.createFS(K,D));var H=J.parent;J.typeName="rlDealerSearchBaseFS";var L={};var F;J.init=function(){H.init();B()};J.onFormReady=function(){H.onFormReady();F=rlDloBaseFS.getDloId(K);J.initFilter();rlDloSubBrandService.addListener(F,E);I()};J.onFormClosing=function(){H.onFormClosing();rlDloSubBrandService.removeListener(F,E)};J.supportsInputCache=function(){return false};J.getDataSources=function(){var M=[];return M};J.initFilter=function(){var N=false;var M=false;if(rlDloSubBrandService.getSubBrand(F)==="BI"){M=J.getFieldsetProperties()["isfilterretailcheckedbi"]==="true";N=J.getFieldsetProperties()["isfilterservicecheckedbi"]==="true"}else{M=J.getFieldsetProperties()["isfilterretailcheckedbm"]==="true";N=J.getFieldsetProperties()["isfilterservicecheckedbm"]==="true"}K.find(L.filterForService).attr("checked",N);K.find(L.filterForRetail).attr("checked",M)};J.fireSearchEvent=function(){var M=J.getSearchParams();if(M.searchString!==""){rlDloEventsController.getController(K).fireSearchEvent(M)}};J.fireFilterChangedEvent=function(){var M=J.getSearchParams();rlDloEventsController.getController(K).fireFilterChangedEvent(M)};J.getSearchParams=function(){var N={searchString:"",filter:[]};var M=K.find("input[name='dloSearchInput']");N.searchString=M.hasClass("empty")?"":M.val();K.find(".dloSearchFilters input").each(function(){N.filter.push({label:jq.trim(jq(this).parent("label").text()),type:jq(this).val(),checked:jq(this).is(":checked")})});return N};function E(){G();C();J.initFilter()}function I(){var N=L.searchButton+", "+L.searchIconLink;K.find(N).click(function(){J.fireSearchEvent()});var M=L.filterForService+", "+L.filterForRetail;K.find(M).click(function(){J.fireFilterChangedEvent()});K.find(L.dloSearchInput).keypress(function(O){if(O.keyCode=="13"){O.preventDefault();jq(this).blur();J.fireSearchEvent()}});K.find(L.dloSearchInput).focus(function(){if(jq(this).hasClass("empty")){G();jq(this).removeClass("empty");jq(this).attr("value","")}});K.find(L.dloSearchInput).blur(function(){if(jq.trim(jq(this).val())==""){C()}})}function C(){var M=K.find(L.dloSearchInput);M.addClass("empty");M.attr("value",this.emptyValue)}function G(){var M=K.find(L.dloSearchInput);if(!M.emptyValue){M.emptyValue=M.val()}}function B(){L.params=J.getFieldsetProperties();L.searchButton=".dloSearchButton";L.searchIconLink=".dloSearchIconLink";L.dloSearchInput=".dloSearchInput";L.filterForService="#rfxDloFilterForService";L.filterForRetail="#rfxDloFilterForRetail"}J.testMethods=function(){return{}};return J}return{__init__:function(){},__start__:function(){},createFS:function(B,C){return A(B,C)}}}();var rlDealerShowMore=function(){var G;var C=700;var E=400;var M=".dealerItemSmall";var L=".dealerItemBig";var K=".dealerItemSingle";var H=".slideShowContent";var B=".dealerServiceOfferItemPrice";var A=".dealerItemMore";var F=".dealerLinkOpen";var D=".dealerLinkClose";function J(){jq(K+" "+L+":visible").each(function(){I(jq(this).parent(K),true)})}function I(O,P){if(G!=null&&G.attr("id")){G.attr("id",G.attr("id").replace("_opened",""))}if(!P){J();G=jq(F,O);if(G!=null&&G.attr("id")){G.attr("id",G.attr("id")+"_opened")}}var N=P?M:L;var Q=P?L:M;jq(O).find(Q).animate({opacity:"toggle",height:"toggle"},E,function(){jq(F,O).toggle();jq(D,O).toggle();jq(B,O).animate({opacity:"toggle"});jq(N,O).animate({opacity:"toggle",height:"toggle"},C,function(){if(jq(H,O).length>0){jq(D,O).is(":visible")?rlSlideShow.play(jq(H,O)):rlSlideShow.pause(jq(H,O))}});if(!P){window.location.hash=O.attr("id")}})}return{__start__:function(){jq(A).each(function(){jq(this).click(function(){var N=jq(this).closest(K);var O=jq(D,N).is(":visible");I(N,O)})})},__init__:function(){var O=window.location.hash;if(O.length>0){if(jq("html").is(".ie7, .ie8")){jq(O+" "+B+", "+O+" "+F).fadeOut(E);jq(O+" "+L+", "+O+" "+D).fadeIn(C)}var N=jq(O+" "+H);if(N){rlSlideShow.play(N)}}}}}();var rlDisclaimerConsent=function(){function A(){jq("#disclaimerConsentAcceptedButton").click(function(){rlCookieController.setRegulationsAccepted();top.document.location.reload()})}return{__start__:function(){A()}}}();var rlDloInfoWindow=function(){function A(N,S,I,D){var G={};var H;var a;var P={};P.getDealerInfoWindowHtml=function(){jq.extend(G,S);var c=F();var e=c.wrap("<div/>").parent();var d=jq("<div/>").addClass("dloInfoWindowPointer");e.append(d);return e.html()};P.closeInfoWindow=function(){if(typeof H=="function"){H()}rlPreferredDealersModel.removeChangeListener(P);N.removeClass("dloInfoWindowOpen")};P.onInfoWindowShown=function(){U();rlPreferredDealersModel.addChangeListener(P);N.addClass("dloInfoWindowOpen");N.find(".dloInfoWindow img:first").bind("click",function(){P.closeInfoWindow()})};P.onInfoWindowClosed=function(c){if(typeof c=="function"){H=c}};P.onPreferredDealersModelChange=function(c){J(c)};P.addEventTracker=function(c){a=c};function F(){var c=rlDealerBuilder.create(G);c.addId("dloInfoWindow");c.addHtml(E());c.addHtml(C());c.addDeleteDialog();c.wrapWithInnerAndOuterBorder();c.addShadow();window.setTimeout(function(){rlBmwStateOverlay.addAndInitDitherLayer("dloInfoWindow",".dealerLinks","dloInfoWindow")},500);return c.build()}function J(c){if(N.find(".dloInfoWindow").length!=0){T(c)}}function T(c){G.preferred=false;G.primary=false;for(var d=0;d<c.length;d++){if(c[d].key===G.key){jq.extend(true,G,c[d]);G.preferred=true}}N.find(".dloInfoWindow .dloDealer").replaceWith(F());U()}function E(){var c=rlDealerDataBuilder.create(G);c.addName();c.addAddress();if(O()){c.addTelephoneAndFax()}return c.build()}function C(){var c=rlDealerLinksBuilder.create(G,a);if(b()){c.addEMailLink()}if(Y()){c.addHomepageLink()}if(D===true&&V()){if(G.preferred===true){c.addRemoveFromWatchlistLink()}else{c.addAddToWatchlistLink()}c.addDealerManagementConfirmation()}if(Q()){c.addPlanRouteLink()}if(I){c.addSelectDealerLink()}return c.build()}function Q(){return rlDloBaseFS.getDloDiv(N).hasClass("hasRoutePlanningComponent")}function V(){return rlDloBaseFS.getDloDiv(N).hasClass("dealerManagementEnabled")}function Y(){return rlDloBaseFS.getDloDiv(N).hasClass("homePageLinkEnabled")}function b(){return rlDloBaseFS.getDloDiv(N).hasClass("emailLinkEnabled")}function O(){return rlDloBaseFS.getDloDiv(N).hasClass("telephoneAndFaxEnabled")}function U(){var c=function(e,f,d){N.find(".dloInfoWindow "+e).unbind().bind("click",function(){if(isDefined(d)&&isDefined(a)){a.trackEvent(d,G.key)}if(isDefined(f)){f(jq(this))}})};c(".dealerMailLink",undefined,"DealerEmailLinkClicked");c(".DealerHomepageLink",R,"DealerUrlLinkClicked");c(".dloAddToWatchlistLink",M,"AddToWatchListLinkClicked");c(".dloRemoveFromWatchlistLink",K);c(".planRouteLink",Z,"PlanRouteLinkClicked");c(".selectLink",B,"ChooseDealerLinkClicked");c(".deleteLink",L,"RemoveFromWatchListLinkClicked");c(".cancelLink",W)}function M(){rlBmwStateOverlay.showLoadingState("dloInfoWindow");jq(window).trigger(rlTrackingListener.EVENTS.EVENT_TRACKING_LISTENER_NOTIFICATION,{id:"dealerDloAddToWatchlist",info:X(),type:rlTrackingListener.TRACKING_TYPES.LINK});rlPreferredDealersModel.addPreferredDealer(G,function(){G.preferred=true;rlBmwStateOverlay.hideState("dloInfoWindow");N.find(".dloInfoWindow .dloAddToWatchlistLink").hide();N.find(".dloInfoWindow .addDealerConfirmation").show();setTimeout(function(){N.find(".dloInfoWindow .addDealerConfirmation").hide();N.find(".dloInfoWindow .dloRemoveFromWatchlistLink").show()},2500)},function(d){rlBmwStateOverlay.hideState("dloInfoWindow");N.find(".dloInfoWindow .dloAddToWatchlistLink").show();var c="dealer ["+G.key+"] could not be stored to user!";if(d===rlPreferredDealersModel.errorTypes.ERROR_PDM_MAXIMUM_REACHED){c+=" Maximum number of Preferred Dealers reached."}else{if(d===rlPreferredDealersModel.errorTypes.ERROR_PDM_CORE){c+=" Core error."}}console.error(c)})}function X(){return{key:G.key,formType:a.getFormType()}}function L(){rlBmwStateOverlay.showLoadingState("dloInfoWindow");N.find(".dloInfoWindow .deleteDialogContent").hide();N.find(".dloInfoWindow .dealerAddress,.dealerTelephoneAndFax,.dealerLinks").show();N.find(".dloInfoWindow .dloRemoveFromWatchlistLink").show();jq(window).trigger(rlTrackingListener.EVENTS.EVENT_TRACKING_LISTENER_NOTIFICATION,{id:"dealerDloRemovedFromWatchlist",info:X(),type:rlTrackingListener.TRACKING_TYPES.LINK});rlPreferredDealersModel.removePreferredDealer(G,function(){G.preferred=false;rlBmwStateOverlay.hideState("dloInfoWindow");N.find(".dloInfoWindow .dloRemoveFromWatchlistLink").hide();N.find(".dloInfoWindow .deleteDealerConfirmation").show();setTimeout(function(){N.find(".dloInfoWindow .deleteDealerConfirmation").hide();N.find(".dloInfoWindow .dloAddToWatchlistLink").show()},2500)},function(){rlBmwStateOverlay.hideState("dloInfoWindow");N.find(".dloInfoWindow .dloRemoveFromWatchlistLink").show();console.error("dealer ["+G.key+"] could not be removed from user!")})}function Z(c){rlDloEventsController.getController(jq(c)).fireSelectionEvent("route",G)}function R(c){jq(window).trigger(rlTrackingListener.EVENTS.EVENT_TRACKING_LISTENER_NOTIFICATION,{id:"dealerHomepageLink",info:X(),type:rlTrackingListener.TRACKING_TYPES.LINK})}function B(c){jq(window).trigger(rlFormFieldSet.EVENT_FIELDSET_SIZE_CHANGED,rlDloSharedConfig.domSelectors.rfxScrollToElem);rlDloEventsController.getController(jq(c)).fireSelectionEvent("select",G)}function K(){N.find(".dloInfoWindow .dealerAddress, .dloInfoWindow .dealerTelephoneAndFax, .dloInfoWindow .dealerLinks").hide();N.find(".dloInfoWindow .deleteDialogContent").show()}function W(){N.find(".dloInfoWindow .deleteDialogContent").hide();N.find(".dloInfoWindow .dealerAddress, .dloInfoWindow .dealerTelephoneAndFax, .dloInfoWindow .dealerLinks").show()}return P}return{__init__:function(){},__start__:function(){},create:function(D,C,B,E){return new A(D,C,B,E)}}}();var rlDloMapRfxFS=function(){function A(B,F){var C=CoreFormsBase.inheritanceFrom(rlDloMapBaseFS.createFS(B,F));var E=C.parent;C.typeName="rlDloMapRfxFS";var D=false;C.init=function(){E.init()};C.onFormReady=function(){E.onFormReady();rlDloWorkflowController.getController(B).addWorkflowListener(C)};C.onFormClosing=function(){E.onFormClosing();rlDloWorkflowController.getController(B).removeWorkflowListener(C)};C.onDloReady=function(){E.onDloReady();C.initAccordion()};C.isDloRfxContext=function(){return true};C.onWorkflowStepChanged=function(I,J,H,G){switch(I){case 1:if(H.length===0&&G===null&&!C.hasSearchComponent()){C.searchAllDealers()}break;case 2:if(!C.hasSearchComponent()){C.searchAllDealers()}if(H.length>0||G!==null||J===3){rlDloEventsController.getController(B).fireShowMapEvent(true)}break;case 3:rlDloEventsController.getController(B).fireShowMapEvent(false);break;default:console.error("Invalid WorkflowStep in dloMapRfxFS "+I)}};return C}return{__init__:function(){},__start__:function(){},createFS:function(B,C){return A(B,C)}}}();var rlDloMapStandaloneFS=function(){function A(B,E){var C=CoreFormsBase.inheritanceFrom(rlDloMapBaseFS.createFS(B,E));var D=C.parent;C.typeName="rlDloMapStandaloneFS";C.init=function(){D.init();C.initAccordion()};C.onFormReady=function(){D.onFormReady();rlDloEventsController.getController(B).fireShowMapEvent(true)};C.onFormClosing=function(){D.onFormClosing()};C.onDloReady=function(){D.onDloReady();if(isDefined(rlContextObject.getDlrPartnerKey())){E.dloParams.initialDealerKey=rlContextObject.getDlrPartnerKey();if(E.dloParams.initialDealerKey=="00000_0"){E.dloParams.initialDealerKey="05316_1"}}if(rlMandator.isDealer()&&rlContextObject.getRoutePlanningFlag()){C.trackEvent("dloStarted_WithRoutePlanningAccordionOpened","dloAction");rlContextObject.setRoutePlanningFlag(false);rlDealerInfoServices.requestDealersFromAllSources([E.dloParams.initialDealerKey],function(F){if(F.length>0){D.searchDealers(E.dloParams.initialDealerKey);C.startRoutePlanning(F[0])}})}else{if(isDefined(E.dloParams.initialDealerKey)){C.trackEvent("dloStarted_WithDealerSearchAccordionOpened","dloAction");D.searchDealers(E.dloParams.initialDealerKey)}else{if(!C.hasSearchComponent()){C.searchAllDealers()}}}};C.adjustMapHeight=function(){D.adjustMapHeight();if(typeof rlGlassPaneLayerNext==="object"&&rlGlassPaneLayerNext.isOpen()&&B.find(".dealerLocatorComponent").length>0){var F=jq(window).height()-(B.find(".dealerLocatorComponent").offset().top-jq(window).scrollTop())-(2*jq("#gplnContentFooter").height());F=Math.max(B.find(".dealerLocatorComponent").height(),F);var I=F-B.find(".dealerLocatorComponent").height();var H=parseInt(B.find(".dloMapBaseFS .dloSearchResult").css("max-height"))+I;var G=parseInt(B.find(".routePlanning .dloRouteplanningControl").css("max-height"))+I;B.find(".dloMapBaseFS .dloSearchResult").css("max-height",H+"px");B.find(".routePlanning .dloRouteplanningControl").css("max-height",G+"px");B.find(".dealerLocatorComponent").height(F+"px");B.find("#dloMap").height(F+"px")}};return C}return{__init__:function(){},__start__:function(){},createFS:function(B,C){return A(B,C)}}}();var rlEspErrorPage=function(){function A(){var F="";var E="";var G=typeof rlPage!=="undefined"&&(rlPage.isEditMode()||rlPage.isDesignMode()||rlPage.isPreviewMode());if(typeof rlEspForm!=="undefined"){var D=rlEspForm.getCurrentInstance().getConfiguration();if(D){if(D.accessUrl&&D.accessUrl.value){F=D.accessUrl.value;if(typeof rlEspBasket!=="undefined"){F=rlEspBasket.getCurrentInstance().addBasketIdToURL(F,false)}}if(D.configUrl&&D.configUrl.value){E=D.configUrl.value;if(typeof rlEspBasket!=="undefined"){E=rlEspBasket.getCurrentInstance().addBasketIdToURL(E,false)}}}}if(G){E="[CONFIG_URL]";F="javascript:void(0);"}var B=jq(".errorEsp .configUrl");if(E){B.find("span").text(E).end().show()}else{B.hide()}var C=jq(".errorEsp .accessUrl");if(F){C.find("a").attr("href",F).end().show()}else{C.hide()}var H="ACTOR_SYSTEM:"+E;jq(window).trigger(rlTrackingListener.EVENTS.EVENT_TRACKING_LISTENER_NOTIFICATION,{id:rlTrackingListener.FORM_IDS.FORM_ESP_ERROR,info:H,type:rlTrackingListener.TRACKING_TYPES.FORM})}return{__init__:function(){},__start__:function(){A()}}}();var rlEspFormSummaryFS=function(){function A(B,E){var C=CoreFormsBase.inheritanceFrom(rlFormSummaryFS.createFS(B,E));var D=C.parent;C.typeName="rlEspFormSummaryFS";return C}return{__init__:function(){},__start__:function(){},createFS:function(B,C){return A(B,C)}}}();var rlEspMultiStepLineFS=function(){function A(M,C){var B="activeStep";var D="visitedStep";var F="newStep";var L=CoreFormsBase.inheritanceFrom(rlMultiStepLineFS.createFS(M,C));var J=L.parent;L.typeName="rlEspMultiStepLineFS";L.formEvents=C.formEvents;var K;var H=false;var I;function G(O,N){if(O==N){E(O,B);H=true}else{if(H){E(O,D)}else{E(O,F)}}}function E(O,P){var N=jq(".wizardtabs .step"+O);N.removeClass(B);N.removeClass(D);N.removeClass(F);N.addClass(P)}L.init=function(){K=M.find(".multiStepLineContainer").attr("data-step");G(K,0);L.formEvents.subscribe(L.formEvents.names.WIZARD_STEP_WILL_CHANGE,function(O,P,N){G(K,N)});J.init()};return L}return{__init__:function(){},__start__:function(){},createFS:function(B,C){return A(B,C)}}}();var rlEspVehicleProfileFS=function(){function A(K,E){var J=CoreFormsBase.inheritanceFrom(rlVehicleProfileFS.createFS(K,E));var H=J.parent;J.typeName="rlEspVehicleProfileFS";var G="formSummary_"+J.getFieldSetId();var L=J.getFieldsetProperties();J.init=function(){H.init();D();if(F()){B()}};J.getFormSummary=function(M,N){if(F()){M.push({type:N.HTML,html:'<div class="'+G+'"></div>'})}return M};function F(){if(L.showinformsummary){return L.showinformsummary.toLowerCase()==="true"}return false}function C(N){if(typeof rlEspBasket==="undefined"){return }var M=rlEspBasket.getCurrentInstance();if(!M){return }var O=M.mayShowFinanceProductCosts();if(O){N.find(".nccSummaryRateColumn, #summaryFinancing, .nccSummaryFeatureMonthlyPriceTitle, .nccSummaryFeatureMonthlyPriceOuter").show();N.find(".nccSummaryFeatureTotalPrice, .nccSummaryPriceColumn, .nccSummaryPackageTotalPrice").css("margin-left","0");N.find(".nccSummaryPriceColumn").css("margin-left","0")}else{N.find(".nccSummaryRateColumn, #summaryFinancing, .nccSummaryFeatureMonthlyPriceTitle, .nccSummaryFeatureMonthlyPriceOuter").hide();N.find(".nccSummaryFeatureTotalPrice, .nccSummaryPriceColumn, .nccSummaryPackageTotalPrice").css("margin-left","165px");N.find(".nccSummaryPriceColumn").css("margin-left","150px");N.find("#indentdiv .nccSummaryPriceColumn").css("margin-left","120px")}}function D(){J.formEvents.subscribe(J.formEvents.names.ESP_WIZARD_STEP_DID_CHANGE,function(N,O,M){C(K)})}function B(){E.formEvents.subscribe(E.allEvents.names.FORM_SUMMARY_RENDERED,function(){var N=undefined;var O=true;var M=rlEspBasket.getCurrentInstance();if(M){N=M.getPublicConfigId();O=M.mayShowFinanceProductCosts()}if(N){I(N,O).done(function(Q){Q=Q.replace(/CONSUMPTION_DISCLAIMER/g,"SUMMARY_CONSUMPTION_DISCLAIMER");Q=Q.replace(/PRICE_DISCLAIMER/g,"SUMMARY_PRICE_DISCLAIMER");var P=jq(".summaryContainer ."+G);P.html(Q)})}else{console.warn("rlEspVehicleProfileFS: getNccSummary espBasket.getPublicConfigId() is empty!")}})}function I(N,O){var M=jq.Deferred();rlNccServices.getNccSummaryForConfigUrl(N,O,function(P){M.resolve(P)},function(P){rlErrorService.handleError({actor:rlErrorService.ACTOR_SYSTEM,requestStatus:""});console.error("Failed loading NCC HTMLSummary "+(P?P:""));M.reject()});return M.promise()}return J}return{__init__:function(){},__start__:function(){},createFS:function(B,C){return A(B,C)}}}();var rlFaceted=function(){return{__init__:function(){jq(".offerContent").bind("click",function(A){if(A.target.nodeName!="A"){jq(this).find(".teaserLinkContainer a").trigger("click")}})},__start__:function(){}}}();var rlFinanceTypeFS=function(){function A(B,E){var C=CoreFormsBase.inheritanceFrom(rlFormFieldSet.createFS(B,E));var D=C.parent;C.typeName="rlFinanceTypeFS";C.getValueRenderers=function(F){F.singleCheckbox=function(J,I,G,H){if(I===true){H.text(" ").addClass("spriteLabel spriteLabelCheckedGreen12")}else{H.removeClass("spriteLabel spriteLabelCheckedGreen12");H.text("--")}};F.financeType=function(J,I,G,H){H.find("input").prop("checked",false);H.find("input[value='"+I+"']").prop("checked",true)};return F};C.getFieldMappers=function(F){F.financeTypeRadioButtons={get:function(I,H){var G=jq(H).find(":checked");if(G.length>0){return G.attr("data-ft")}else{return"NOTHING"}},set:function(I,H,G){}};F.insuranceCheckbox={get:function(I,H){var G=H.parents(".fieldSetEditAreaRow").find("label");if(H.prop("checked")===true){return"YES"}else{return"NO"}},set:function(I,H,G){}};return F};C.getMailSummary=function(F,G){var I=B.find("[name=financeType]:checked").not("[value=None]");if(I.length>0){F.push({type:G.LABEL,value:I.next("label").text()})}var H=B.find("[name=insuranceCheckBox]:checked");if(H.length>0){F.push({type:G.LABEL,value:H.next("label").text()})}return F};return C}return{__init__:function(){},__start__:function(){},createFS:function(B,C){return A(B,C)}}}();var rlFormFieldSetDefaults=function(){var L=0;var N={basic:function(T,R,S){},dropdown:function(T,R,S){A(T,R,S)},radio:function(U,R,T){var S="";L++;jq(R.valueList).each(function(W,X){var V=rlFormFieldSet.getUniqueId(T,U,X.key);S+="<div class='fieldSetRadioButtonGroup clearfix'>";S+="<input id='"+V+"' class='fieldSetFieldRadio' type='radio' name='"+U+L+"' value='"+X.key+"'>";S+="<label for='"+V+"' class='fieldSetInputLabel'>"+X.value+"</label>";S+="</div>"});T.append(S)},checkbox:function(U,R,T){var S="";jq(R.valueList).each(function(V,X){var W=rlFormFieldSet.getUniqueId(T,U,X.key);S+="<div class='fieldSetCheckboxGroup clearfix'>";S+="<input id='"+W+"' class='fieldSetFieldCheckbox' type='checkbox' name='"+U+"' value='"+X.key+"'>";S+="<label for='"+W+"' class='fieldSetInputLabel'>"+X.value+"</label>";S+="</div>"});T.append(S)},listbox:function(T,R,S){A(T,R,S)}};function E(S,T,R){if(S){if(S.is("input")){if(R===true){S.val(T)}}else{S.text(T)}}}var B={basic:function(U,T,R,S){E(S,T||"--")},numeric:function(U,T,R,S){T=M(T);if(typeof (T)==="undefined"){E(S,"--")}else{E(S,T)}},datestring:function(V,U,R,T){if(typeof U==="undefined"||U==null||U===""){E(T,"--")}else{var S=rlTime.convertUTCDateToLocal(U).toDate();E(T,rlFormatter.formatDate(S))}},valueList:function(V,U,R,T){if(U==null||U==""){E(T,"--")}else{var S=false;if(R&&R.valueList){jq.each(R.valueList,function(W,X){if(X.key===U){E(T,X.value);S=true}})}if(!S){E(T,"--")}}},multipleKeys:function(W,V,R,U){var S=[];var T=[];if(V!=null){T=jq.isArray(V)?V:[V];jq.each(R.valueList,function(X,Y){if(jq.inArray(Y.key,T)>-1){S.push(Y.value)}})}if(S.length>0){E(U,S.join(", "))}else{if(T.length==0){E(U,"--")}else{E(U,"--")}}}};var Q={basic:{get:function(S,R){return R.val()},set:function(T,S,R){R.val(S).change()}},valueUndefinedIfEmpty:{get:function(S,R){return R.val()||undefined},set:function(T,S,R){R.val(S||"").change()}},datestringInThreeDropdowns:{get:function(V,T){var R=T.find(".date_day").val();var U=T.find(".date_month").val();var S=T.find(".date_year").val();if(R==""||U==""||S==""){return""}else{return S+"-"+U+"-"+R+"T00:00:00"}},set:function(V,U,S){if(U){var R=U.split("T");var T=R[0].split("-");S.find(".date_day").val(T[2]);S.find(".date_month").val(T[1]);S.find(".date_year").val(T[0])}else{S.find(".date_day").val("");S.find(".date_month").val("");S.find(".date_year").val("")}}},radio:{get:function(S,R){return jq(R).find(":checked").val()},set:function(T,S,R){if(S){jq(R).find("input[value='"+S+"']").each(function(V,W){W=jq(W);var U=W.attr("name");W.attr("name",U+"_autofill");W.attr("checked","checked").click();W.attr("name",U)})}else{jq(R).find("input[value='"+S+"']").removeAttr("checked")}}},checkbox:{get:function(T,S){var R=[];if(S.length>0&&S.is("input")){return S.is(":checked")}jq.each(S.find("input:checkbox:checked"),function(V,U){R.push(jq(U).val())});return R},set:function(U,T,R){R.find("input:checkbox").removeAttr("checked");if(T){var S=jq.isArray(T)?T:[T];jq.each(S,function(V,W){jq(R).find("input[value='"+W+"']:checkbox").attr("checked","checked")})}}},singleCheckbox:{get:function(S,R){return R.attr("checked")==="checked"},set:function(T,S,R){if(S===true){R.attr("checked","checked")}else{R.removeAttr("checked")}}},integer:{get:function(T,R){var S=R.val();S=S&&G(S.replace(/\./g,""));return !S&&S!==0?undefined:S},set:function(T,S,R){S=G(S);R.val(!S&&S!==0?"":S).change()}},dropdown:{get:function(S,R){return R.val()},set:function(T,S,R){S=S||R.find("option:first").val();R.val(S).change()}},listbox:{get:function(S,R){return R.val()},set:function(T,S,R){R.val(S).change()}}};var K=function(T,S,R){if(!jq(S).is(":checked")&&jq(S).find(":checked").length===0){return{fieldName:T,level:"ERROR",errorKey:R}}};function H(U,R,S){var W=undefined;var V="input:text,input:password,textarea,select,input:file";V=R===true?V+",input:radio":V;V=S===true?V+",input:checkbox":V;if(U){if(U.is(V)){W=U.val()}else{var T=U.find(V);if(T.length==1){W=T.first().val()}else{throw T.length+" fields of supported type found in field with id '"+U.attr("id")+"'!"}}}return W}var C={requireAddressRefToggle:function(R){return{validate:function(S){var T=false;jq.each(S,function(V,U){if(U.typeName=="rlAddressRefToggle"){T=true;return false}});if(!T){R.find(".noReferenceAddressFieldSetAvailableNagMessage").css("display","block")}return T}}}};var J={requiredValue:{event:"focusout",when:"ELEM_INVALIDATED_BY_FORM",rule:function(T,R,S){if(jq.trim(H(R))==""){return{fieldName:T,level:"ERROR",errorKey:(S&&S.length>0&&S[0])?S[0]:"requiredValue"}}}},requiredRadio:{event:"click",when:"ELEM_INVALIDATED_BY_FORM",rule:function(S,R){return K(S,R,"requiredRadio")}},requiredCheckbox:{event:"click",when:"ELEM_INVALIDATED_BY_FORM",rule:function(T,R,S){return K(T,R,S[0]||"requiredCheckbox")}},integer:function(U,R,S){var T=H(R);if(T!=""&&isNaN(parseInt(T,10))||!isFinite(T)){return{fieldName:U,level:"ERROR",errorKey:"integer"}}},floating:function(U,R,S){var T=H(R);if(T!=""&&isNaN(parseFloat(T))||!isFinite(T)){return{fieldName:U,level:"ERROR",errorKey:"float"}}},metaDataRegexp:{event:"focusout",rule:function(W,S,V){var U=H(S);if(jq.trim(U)!=""){var T=S.data("metaDataRegexp");var R=U.match(T);if(R==null||R.length==0||R[0]!==U){return{fieldName:W,level:"ERROR",errorKey:"syntax"}}}}},minimum:function(U,R,S){var T=parseFloat(H(R));if(T!=""&&T<S[0]){return{fieldName:U,level:"ERROR",errorKey:"minimum",errorParams:{min:S[0]}}}},maximum:function(U,R,S){var T=parseFloat(H(R));if(T!=""&&T>S[0]){return{fieldName:U,level:"ERROR",errorKey:"maximum",errorParams:{min:S[0]}}}},lengthBetween:{event:"focusout",rule:function(V,S,U){var T=H(S);var R=jq.trim(T).length;if(R<U[0]||R>U[1]){return{fieldName:V,level:"ERROR",errorKey:"lengthBetween",errorParams:{length:R,min:U[0],max:U[1]}}}}},equalInput:{event:"focusout",rule:function(T,R,S){if(S[0]==null){throw'[validators:equalInput] You need to specify the confirm field selector. Usage <...data-validators="equalInput:myConfirmPasswordFieldClass...>'}if(H(R,true,true)!==H(jq(S[0]),true,true)){return{fieldName:T,level:"ERROR",errorKey:"equalInput"}}}},notEqualInput:{event:"focusout",rule:function(T,R,S){if(S[0]==null){throw'[validators:notEqualInput] You need to specify the confirm field selector. Usage <...data-validators="notEqualInput:myConfirmPasswordFieldClass...>'}if(H(R,true,true)===H(jq(S[0]),true,true)){return{fieldName:T,level:"ERROR",errorKey:"notEqualInput"}}}},noSpecialChars:{event:"blur",rule:function(V,R,U){var T=jq(R);var S=/[<>]/;if(S.test(H(T))){return{fieldName:V,level:"ERROR",errorKey:"textareaSpecialChars"}}}},requiredDateInThreeDropdowns:{event:"focusout",when:"ELEM_INVALIDATED_BY_FORM",rule:function(W,U){if(U.find(".date_day:enabled,.date_month:enabled,.date_year:enabled").length===0){return }var S=jq.trim(U.find(".date_day").val());var V=jq.trim(U.find(".date_month").val());var T=jq.trim(U.find(".date_year").val());var R=(S!==""&&V!==""&&T!=="");if(!R){return{fieldName:W,level:"ERROR",errorKey:"requiredValue"}}}},noPartialDateInThreeDropdowns:function(X,V){var T=jq.trim(V.find(".date_day:enabled").val());var W=jq.trim(V.find(".date_month:enabled").val());var U=jq.trim(V.find(".date_year:enabled").val());var S=(T!==""||W!==""||U!=="");var R=(T!==""&&W!==""&&U!=="");if(S&&!R){return{fieldName:X,level:"ERROR",errorKey:"noPartialDate"}}},noPartialDateInThreeDropdownsLive:{event:"focusout",async:true,liveOnly:true,rule:function(V,S,U,R,T){setTimeout(function(){var W=S.parents(".fieldSetEditAreaRow.fieldSetIsShowingValidationMessage").length>0;if(!W&&S.find(":focus").length>0){R()}else{R(J.noPartialDateInThreeDropdowns(V,S))}},10)}},vin:{event:"focusout",async:true,liveOnly:true,rule:function(W,T,V,R,U){var S=jq.trim(H(T));if(S){O(S,W,R,V,U)}else{R(null)}}},brandSeriesModel:{event:"focusout",async:true,liveOnly:true,rule:function(Y,U,W,R,V){var X=jq.trim(U.parents("fieldset").find("[data-field$='brand']").val());var T=jq.trim(U.parents("fieldset").find("[data-field$='series']").val());var S=jq.trim(U.parents("fieldset").find("[data-field$='model']").val());if(X&&T&&S){D(X,T,S,Y,R,W)}else{R(null)}}},vinBrandSeriesModel:{event:"focusout",async:true,liveOnly:true,rule:function(Y,S,T,X,Z){var U=jq.trim(S.val());var R=jq.trim(S.parents("fieldset").find("[data-field$='brand']").val());var V=jq.trim(S.parents("fieldset").find("[data-field$='series']").val());var W=jq.trim(S.parents("fieldset").find("[data-field$='model']").val());if((U&&R&&V&&W)||(R&&V&&W)||U){P(U,R,V,W,Y,X,T,Z)}else{X(null)}}}};function I(R,U,V,T){var S=(jq.browser&&jq.browser.msie&&jq.browser.msie===true);if(S){R.each(function(W,Y){var X=document.createElement("option");X.value=U;X.text=V;Y.add(X,T)})}else{if(typeof T==="undefined"){R.append("<option value='"+U+"'>"+V+"</option>")}else{jq(R.find("option").get(T)).before("<option value='"+U+"'>"+V+"</option>")}}}function A(T,R,S){jq(R.valueList).each(function(U,V){I(S,V.key,V.value)})}function G(S){if(!S&&S!==0){return undefined}var R=parseInt(S,10);if(!isNaN(R)&&isFinite(S)){return R}return undefined}function M(V){if(!V&&V!==0){return undefined}V=G(V);if(!V&&V!==0){return undefined}V+="";var R=V.split(".");var U=R[0];var S=R.length>1?"."+R[1]:"";var T=/(\d+)(\d{3})/;while(T.test(U)){U=U.replace(T,"$1.$2")}return U+S}function O(T,V,S,R,U){if(!T){S(null);return }return P(T,undefined,undefined,undefined,V,S,R,U)}function D(X,U,T,W,S,R,V){if(!X&&!U&&!T){S(null);return }return P(undefined,X,U,T,W,S,R,V)}function P(T,S,U,W,Z,X,R,a){if(!T&&!S&&!U&&!W){X(null);return }var V=function(e){var c=undefined;if(R&&jq.isArray(R)&&R.length>0){c=R[0]+"."}var b=rlNccConverter.translateValidationMessagesFromResponse(e,undefined,c);var f=false;if(b&&b.length>0){for(var d=0;d<b.length;d++){if(b[d]){X(b[d]);f=true}}}f||X(null)};var Y={twoTier:false,success:function(b){if(rlGlobalConfig.isManualVinMapping){console.log("Calling NCC Service for VG Models");rlNccServices.listVGModelsByVIN({vin:T,success:function(c){console.log("listVGModelsByVIN: ",c);if(a){a.formEvents.trigger(rlCoreFormEvents.ENUM.NAMES.MANUAL_VIN_MAPPING_MODELS,c)}X(null)},error:function(c){console.error("listVGModelsByVIN Error: ",c);X(null)}})}else{X(null)}},fail:function(c){if(c&&c[0]){var b=rlEventTracker.create("mybmwAddVin");b.trackCustomEvent("VinValidationError="+c[0].errorCodeId+"&vin="+T,"mybmwError/"+F())}V(c)},error:function(b){X(null)}};if(T){Y.vin=T}if(S&&U&&W){Y.brand=S;Y.series=U;Y.model=W}setTimeout(function(){if(T&&!rlNccServices.checkVIN(T)){var b=rlEventTracker.create("mybmwAddVin");b.trackCustomEvent("VinValidationError=Global_VIN_invalid&vin="+T,"mybmwError/"+F());X({fieldName:Z,level:"ERROR",errorKey:"Global_VIN_invalid"});return }rlNccServices.validateVIN(Y)},100)}function F(){var S=jq("meta[name=jcrPath]").attr("content");if(S&&S.length>0){var R=S.lastIndexOf("/");return S.substring(R+1,S.length)}else{return S}}return{__init__:function(){},__start__:function(){},getMetaDataRenderers:function(){return clone(N)},getValueRenderers:function(){return clone(B)},getFieldMappers:function(){return clone(Q)},getValueOfField:function(T,R,S){H(T,R,S)},getValidationRules:function(R){return clone(J)},getAuthorValidationRules:function(R){return clone(C)},addOptionToSelect:function(R,T,U,S){I(R,T,U,S)},setTextInElement:function(S,T,R){E(S,T,R)}}}();var rlFormFieldSetInputCache=function(){function A(C,B,I){function H(){B.find("input,select,textarea").filter("[name]").each(function(J,K){K=jq(K);K.attr("name",K.attr("name")+"_autofill")})}function E(){B.find("input,select,textarea").filter("[name]").each(function(K,L){L=jq(L);var J=L.attr("name");L.attr("name",J.replace("_autofill",""))})}C.activateInputCache=function(J){if(C.supportsInputCache(J)){C.activateInputCache=function(){};B.find("input,select,textarea").bind("blur",function(){C.saveStateToInputCache()});B.find("input:radio,input:checkbox").bind("click",function(){C.saveStateToInputCache()})}};C.supportsInputCache=function(J){return(!I.isLoggedIn||J===true)&&I.useInputCache};C.saveStateToInputCache=function(){G()};function G(){if(C.supportsInputCache()&&!C.isRestoringFromInputCache){var M=C.getInputCacheCookieName();var J=rlCookieController.getCookie({cookieKey:M});var L={};if(J!==null){L=jq.lzDecompressFromBase64(J.cookieValue);L=jq.secureEvalJSON(L)}L=C.getStateForInputCache(L);var K={cookieKey:M,cookieValue:jq.lzCompressToBase64(jq.toJSON(L)),ops:{secure:!rlPage.isRunningOnAuthorInstance()},callback:function(N){if(N){console.log("Cookie for "+M+" can not be stored: "+N)}else{console.log("Wrote state to input cache for fieldset: "+C.getInputCacheCookieName())}}};rlCookieController.setCookie(K)}}C.getStateForInputCache=function(L){var K=L||{};var J=F();jq.each(J,function(P,O){var N=B.find("#"+P);var M={enabled:N.is(":enabled")};if(N.is(":radio")||N.is(":checkbox")){M.checked=N.is(":checked")}else{M.value=N.val()}K[O]=M});return K};C.restoreStateFromCookie=function(L){if(C.supportsInputCache()){try{H();C.isRestoringFromInputCache=true;var K=rlCookieController.getCookie({cookieKey:C.getInputCacheCookieName()});if(K){var J=jq.lzDecompressFromBase64(K.cookieValue);J=jq.secureEvalJSON(J);C.setStateFromInputCache(J);console.log("Restored state from input cache for fieldSet: "+C.getInputCacheCookieName())}else{if(L===true){C.setStateFromInputCache({})}}}finally{delete C.isRestoringFromInputCache;E()}}};C.setStateFromInputCache=function(K){var J=F();jq.each(J,function(N,M){var L=B.find("#"+N);if(L.length>0&&typeof K[M]!=="undefined"){L.prop("disabled",K[M].enabled!==true);typeof (K[M].value)!=="undefined"&&L.val(K[M].value);L.prop("checked",K[M].checked===true)}})};C.getInputCacheKeyForId=function(J){if(typeof J!=="undefined"&&J!=null&&J.indexOf("_")>=0){return J.substring(J.indexOf("_")+1)}else{return null}};C.getInputCacheItemForInputId=function(J,K){return D(J,K)};function D(J,K){var L=C.getInputCacheKeyForId(K);if(L!=null&&typeof J[L]!=="undefined"){return J[L]}else{return null}}function F(){var J={};B.find("input,select,textarea").filter("[id]").each(function(K,L){if(L.id.indexOf("{")==-1){var M=C.getInputCacheKeyForId(L.id);if(M!=null){J[L.id]=M}}});return J}C.getInputCacheCookieName=function(){return B.attr("data-inputcachekey")}}return{__init__:function(){},__start__:function(){},addInputCacheToFieldset:function(B,C,D){A(B,C,D)}}}();var rlFormFieldSetMetaConstraints=function(){function A(I,K,C,H){var J={};J.typeName="rlFormFieldSetMetaConstraints";I.getRequiredValidators=function(){return undefined};I.addValidatorToElement=function(N,M,O){if(N&&M){var L=N.attr("data-validators")||"";L=L?(L+","):"";L+=M+(!O?"":(":"+O));L&&N.attr("data-validators",L)}};function B(M,L){if(M&&L){L=jq.isArray(L)?L:[L];jq.each(L,function(N,O){var P=undefined;if(O&&O.hasOwnProperty("validator")){if(O.hasOwnProperty("params")&&O.params){P=O.params}O=O.validator}I.addValidatorToElement(M,O,P)})}}I.resolveConstraints=function(M){var L=G(I.getMetaData(),"user."+M);if(!L){L=G(I.getMetaData(),M)}var N=undefined;if(L&&L.constraints&&L.constraints["constraint"]){N=L.constraints.constraint;N=jq.isArray(N)?N:[N]}return N};function F(N,O){var L=N.attr("data-validators");var M=L&&L.toLowerCase().indexOf("required")>=0;if(O&&!M){O=jq.isArray(O)?O:[O];jq.each(O,function(P,R){if(R&&R.usage&&R.usage==="Mandatory"){var Q=I.getRequiredValidators();Q=(Q&&!jq.isArray(Q))?[Q]:Q;if(!Q){Q=["requiredValue"];if(N.is(":has(input[type=radio])")){Q[0]="requiredRadio"}else{if(N.is(":has(input[type=checkbox])")){Q[0]="requiredCheckbox"}}}B(N,Q);return false}})}}function E(L,M){if(M.sizeMax!=null){I.addValidatorToElement(L,"lengthBetween","0:"+M.sizeMax);if(L.context.tagName=="INPUT"&&L.attr("type")=="text"){L.attr("maxlength",M.sizeMax)}}}function D(L,M){if(M.regex!=null){I.addValidatorToElement(L,"metaDataRegexp");L.data("metaDataRegexp",M.regex)}}function G(M,L){return H(M,L)}J.addMetaConstraintsToFieldSet=function(){K.find(".fieldSetEditMode [data-field]").each(function(M,P){P=jq(P);var L=I.resolveConstraints(I.getFieldName(P));var O=I.resolveConstraints(I.getMetaFieldName(P));F(P,L);for(var N=0;O&&N<O.length;N++){E(P,O[N]);D(P,O[N])}})};return J}return{__init__:function(){},__start__:function(){},create:function(D,C,E,B){return A(D,C,E,B)}}}();var rlFormFieldSetValidation=function(){function A(O,K,S,I,B){var P="NOT_VALIDATED",C="ELEM_INVALIDATED_BY_FORM",E="ELEM_INVALIDATED_BY_LIVE",G="VALID";var T="VALIDATION_STATE";var J="",D="";function U(){var V=[];K.find(".fieldSetEditMode [data-validators]").each(function(Y,c){c=jq(c);var d=c.attr("data-field");var X=c.attr("data-validators").split(",");for(var a=0;a<X.length;a++){var W=X[a].split(":");var b=jq.trim(W.shift());if(b!=""){if(typeof B[b]==="undefined"){throw ("Undefined validator: "+b)}else{var Z=M(c,b,W,d);V.push(Z)}}}});return V}function Q(V){return V+"_"+T}function L(W,X){var V=(X!=null&&X.onValidate!=null)?"LIVE_VALIDATION":"FORM_VALIDATION";return W!=null?V==="FORM_VALIDATION"?C:E:G}function M(Y,X,V,a){var W={validatorName:X,validatorParams:V,fieldName:a,element:Y};W.getCurrentValidationState=function(){var b=jq(Y)[0];return jq.data(b,Q(X))};W.setValidationState=function(b){var c=jq(Y)[0];jq.data(c,Q(X),b)};if(W.getCurrentValidationState()==null){W.setValidationState(P)}if(typeof B[X]==="function"){W.validate=function(c){if(Y.is(":disabled")||(!Y.attr("ignore-visible")&&!Y.is(":visible"))){return undefined}var e=B[X];var b=e(a,Y,V,O);var d=L(b,"FORM_VALIDATION");W.setValidationState(d);if(c!=null&&c.onValidate!=null){c.onValidate(b)}return b}}if(typeof B[X]==="object"){var Z=B[X];W.event=Z.event;W.liveOnly=Z.liveOnly||false;W.async=Z.async||false;W.when=Z.when;W.canExecute=function(){var c=W.getCurrentValidationState();if(c==E){return true}if(W.when==null){return true}var b=W.when;return b==c};W.validate=function(d){if(Y.is(":disabled")||(!Y.attr("ignore-visible")&&!Y.is(":visible"))){return undefined}if(W.async){Z.rule(a,Y,V,d.onValidate,O);return false}else{var c=Z.rule(a,Y,V,O);var b=L(c,d);W.setValidationState(b);if(d!=null&&d.onValidate!=null){d.onValidate(c)}return c}}}return W}function N(){var V={};jq.each(U(),function(W,X){var Y=X.fieldName;if(V[Y]==null){V[Y]=[]}V[Y].push(X)});return V}O.getFormValidationResults=function(){var V=[];var W=N();jq.each(W,function(Y,X){jq.each(X,function(a,b){if(b.liveOnly){return true}if(b.async){throw"[formFieldSet] Not supporting async callbacks that aren't also liveOnly callbacks!"}var Z=b.validate();if(Z==null||(jQuery.isArray(Z)&&Z.length==0)){return true}jQuery.isArray(Z)?jq.merge(V,Z):V.push(Z);return false})});return V};var H={};O.isLiveValidationDone=function(){for(var V in H){if(H.hasOwnProperty(V)){return false}}return true};O.initLiveValidators=function(){var V=U();var W=F(V);jq.each(W,function(Y,X){jq.each(X,function(b,Z){var a=Z[0].element;var c=R(a);jq.each(c,function(d,e){jq(e).bind(b,function(){jq.each(Z,function(h,j){if(j.canExecute()){var m=false;var g=j.validatorName+"_"+j.fieldName;var f=g+"_didFork";H[f]=undefined;var n=j.validate({onValidate:function(o,p){if(!o||(jq.isArray(o)&&o.length<1)){o=null}H.hasOwnProperty(g)===true&&delete H[g];H.hasOwnProperty(f)===true&&delete H[f];if(p!==true){I.showLiveFeedback({validator:j,validationResult:o});if(o!=null){m=true}}}});if(n===false&&H.hasOwnProperty(f)===true){H[g]=undefined}delete H[f];if(m===true){for(var k in H){H.hasOwnProperty(k)===true&&delete H[k]}return false}}})})})})})};function R(V){V=jq(V);if(V.is(":input")){return V}else{var W=V.find(":input");if(W.length===0){return V}else{return W}}}function F(X){var W=jq.grep(X,function(Z,Y){return(typeof Z.event!=="undefined")});var V={};jq.each(W,function(Z,a){var d=a.fieldName;var c=a.event;var b=V[d];if(b==null){b=V[d]={}}var Y=b[c];if(Y==null){Y=b[c]=[]}Y.push(a)});return V}O.resetValidationMessages=function(){I.clearFormFeedback()};O.showPossibleErrorMessagesOnAuthor=function(){if(typeof (rlPage)==="undefined"||(!rlPage.isEditMode()&&!rlPage.isDesignMode())){return }var V=N();var W=K.find(".fieldSetEditAreaRow");jq.each(W,function(Z,e){e=jq(e);var f=e.find("[data-field]");if(!f||f.length<1){f=e}var c=f.attr("data-field");if(!c){return true}var a=e.find(".fieldSetRowLabel");var X={};var Y=V[c];var d=function(m){var h={fieldName:c,errorKey:"",level:"ERROR"};var k=I.getPlacementForFeedback(h);if(!k&&Y){jq.each(Y,function(n,o){h.errorKey=o.validatorName;k=I.getPlacementForFeedback(h);return !k})}if(k&&k.is(":has(.possibleMessageKeys)")&&Y&&Y.length>0){I.showLiveFeedback({validationResult:null,validator:Y[0]});k.parents('[class^="fieldSetLayoutCol"]').css("overflow","");return }var g="border: 1px solid black; border-collapse: collapse; padding: 5px;";if(k){var j="";jq.each(X,function(s,q){if(X.hasOwnProperty(s)){j+='<tr><td style="vertical-align: text-top; '+g+'">'+s+'</td><td style="'+g+'">';var p=function(x,w,y,v){var u=(v!==false)?"<br />":"";if(typeof (y)!=="undefined"){u+='<div style="background-color: #ADFF2F; font-weight: bold;" title="'+y+'">'+w+"</div>"}else{if(/^MB_/i.test(w)){return x}u+=w}return x+u};var o=false;var t=false;jq.each(q.messageKeys,function(u,v){if(typeof (v.message)!=="undefined"){o=true}j=p(j,v.key,v.message,t);t=true});if(!o){var n=[];var r=[];jq.each(q.messageKeys,function(u,v){if(typeof (v.plainKeyMessage)!=="undefined"){if(jq.inArray(v.plainKey,n)<0){n.push(v.plainKey);r.push(v.plainKeyMessage)}}});jq.each(n,function(u,v){o=true;j=p(j,v,r[u],t);t=true})}j+="</td></tr>"}});k.html('<div class="possibleMessageKeys fieldSetHasError"><table style="'+g+'"><thead><tr><th style="'+g+'">Validator</th><th style="'+g+'">Possible Message-Keys</th></tr></thead><tbody>'+j+"</tbody></table></div>");I.showFeedback(h,k);k.parents('[class^="fieldSetLayoutCol"]').css("overflow","visible")}};var b=function(h,g){var j=false;jq.each(g,function(k,m){if(m.key===h){j=true;return false}});return j};if(Y){jq.each(Y,function(g,h){var k=h.validatorName;var j=I.getMessageKeys(c,k);if(j&&j.length>0){if(!X[k]){X[k]={validator:h,messageKeys:[]}}jq.each(j,function(n,o){var m=rlTranslator.generateMessageSearchKeys(o);jq.each(m,function(q,t){if(!b(t,X[k].messageKeys)){var s=rlTranslator.getMessageBySearchKey(t);var p=rlTranslator.getMessageBySearchKey(o);var r={key:t,plainKey:o,plainKeyMessage:p,message:s};X[k].messageKeys.push(r)}})});a.css("color","blue");a.unbind("click").click(d)}})}})}}return{__init__:function(){},__start__:function(){},addValidationToFieldset:function(C,D,F,B,E){A(C,D,F,B,E)}}}();var rlFormSummaryFS=function(){function I(W,N){var V=CoreFormsBase.inheritanceFrom(rlFormFieldSet.createFS(W,N));var U=V.parent;V.typeName="rlFormSummaryFS";function T(){N.formEvents.subscribe(N.allEvents.names.WIZARD_STEP_WILL_CHANGE,P);N.formEvents.subscribe(N.allEvents.names.PONG_FIELDSET_SUMMARY,L)}function P(Y,Z,X,a){if(X===a-1){Q();N.allEvents.trigger(N.allEvents.names.PING_FIELDSET_SUMMARY)}}function L(Z,b){var c="";for(var Y=0;Y<b.length;Y++){var a=S(b[Y]);for(var X in b[Y]){a=a.replace("$"+X+"$",b[Y][X])}c+=a}W.find(".summaryContainer").html(c);N.allEvents.trigger(N.allEvents.names.FORM_SUMMARY_RENDERED);R();O();jq(window).trigger(rlFormFieldSet.EVENT_FIELDSET_SIZE_CHANGED)}function Q(){W.find(".summaryContainer").html("")}function M(){W.find("div.formHeadline").hide()}function R(){W.find("div.formHeadline").show()}function O(){W.find(".summarysteplink").each(function(X,Y){Y=jq(Y);if(Y.next().hasClass("summaryheadline")){if(Y.prev().length){Y.addClass("beforeheadline")}else{Y.addClass("jumpToStepOneLink")}}var Z=Y.find("a");Z.click(function(){var a=parseInt(Z.attr("data-stepindex"));N.formEvents.trigger(N.formEvents.names.WIZARD_STEP_REQUEST_JUMP,a)})})}function S(X){switch(X.type){case rlFormBase.mailSummaryElementTypes.HEADLINE:return W.find(".template-headline").html();case rlFormBase.mailSummaryElementTypes.SPACER:return W.find(".template-spacer").html();case rlFormBase.mailSummaryElementTypes.LABEL:return W.find(".template-label").html();case rlFormBase.mailSummaryElementTypes.KEY_VALUE:return W.find(".template-keyvalue").html();case rlFormBase.formSummaryElementTypes.JUMP_TO_STEP:return W.find(".template-jumptostep").html();case rlFormBase.formSummaryElementTypes.HTML:return W.find(".template-html").html();default:console.error("Unknown snippet type: "+X.type);return""}}V.getMailSummary=function(X){return X};V.getFormSummary=function(X){return X};if(!rlPage.isEditMode()){T();Q();M()}return V}function K(N,O){var L=jq("#"+N);var M=L.parents("form").find("fieldset");if(C(L,M)){try{A(M);F(M);G(M);J(M,O);H(M)}catch(P){L.find(".summaryErrorContainer").text(P).show();L.parent("div.formSummaryFS").addClass("formSummaryFSError")}}if(!rlPage.isEditMode()&&!rlPage.isPreviewMode()&&!rlPage.isDesignMode()&&B(L)){console.warn("Illegal formSummaryFS configuration published, removing fieldset from form: "+N);L.parents(".formSummaryFS").remove()}}function B(L){return L.parent("div.formSummaryFS").hasClass("formSummaryFSError")}function C(L){var M=L.parents("form").find(".formSummaryFS");if(M.length>1){L.find("div.tooManyFormSummaryFSError").show();M.parents("form").find("div.formSummaryFS").addClass("formSummaryFSError");return false}else{return true}}function D(M,N){var L=-1;M.each(function(O,P){if(jq(P).parent("."+N).length>0){L=O}});return L}function E(M,N){var L=-1;M.each(function(O,P){if(jq(P).parent("."+N).length>0){L=O;return false}});return L}function A(M){var L=D(M,"multiStepLineFS"),N=D(M,"formSummaryFS");if(L>-1&&N<L){throw"Please move the Form Summary below the last Multi Step Line."}}function F(L){var N=E(L,"formSummaryFS"),M=E(L,"policyBaseFS");if(N>=M){throw"The Form Summary must be above the policy."}}function G(L){var N=E(L,"formSummaryFS"),M=E(L,"captchaFS");if(N>M){throw"The Form Summary must be above the captcha."}}function H(N){var L=D(N,"multiStepLineFS"),O=D(N,"formSummaryFS");if(L!=-1&&O>L){for(var M=L;M<O;M++){if(jq(N.get(M)).find("[data-field]").length>0){throw"You cannot place fieldsets between the last Multi Step Line and the Form Summary."}}}}function J(L,N){var M=false;L.each(function(O,P){P=jq(P);if(P.parent(".formSummaryFS").length>0){M=true}else{var Q=false;if(jq.isArray(N)){jq.each(N,function(S,T){if(P.parent("."+T).length>0){Q=true;return false}})}if(Q){return true}if(P.find("[data-field]").length>0&&!P.hasClass("behaviouralFieldset")&&M){var R="";jq.each(N,function(S,T){R+=T+", "});throw"The Form Summary must be the last fieldset in the form (apart from "+R+")."}}})}return{__init__:function(){},__start__:function(){},createFS:function(L,M){return I(L,M)},validateContentSituation:function(L,M){K(L,M)}}}();var rlFormsContainer=function(){var G={};function F(){jq(".formsContainer[id]").filter(function(H){return jq(this).find(".formsContainer[id]").length<1}).each(function(J,I){var K=jq(I);var H=K.attr("id");if(!G[H]){G[H]=new E(K,H)}})}function B(){rlComponentLoader.deferredExec(["glassPaneLayerNext"],function(){rlGlassPaneLayerNext.addAjaxContentLoaded(function(){A();F()},true);rlGlassPaneLayerNext.addCloseListener(function(){jq(".glassPaneLayerContent").find(".formsContainer[id]").each(function(J,I){var H=jq(I).attr("id");if(isDefined(G[H])){G[H].triggerFormsClosing();delete G[H]}})},true)})}function D(){jq(window).bind(rlFormFieldSet.EVENT_FIELDSET_SIZE_CHANGED,function(I,J){if(rlGlassPaneLayerNext&&rlGlassPaneLayerNext.isOpen()){if(isUndefined(J)){var H=jq("#gplnContentValue");if(H.length>0){J=H.scrollTop()}}isDefined(J)&&rlGlassPaneLayerNext.layerSizeToWindowSize(J)}else{if(jq(".coreForm").attr("data-ensurewizardvisible")!="yes"){isDefined(J)&&jq("body").scrollTo(J,0)}}})}function C(){jq(".formsContainer[id]").each(function(I,H){var K=jq(H);K.find(".formsContainerBody").css("visibility","visible").show();var J=K.find("form .coreForm").first();if(isDefined(J)&&J.attr("data-focusonfirstinputfield")==="true"){J.find("input[type=text],textarea,select,input[type=checkbox],input[type=radio]").filter(":visible:first").focus()}});if(jq(".glassPaneLayer .formsContainer").length>0){rlGlassPaneLayerNext.contentReady()}}function A(){jq(".coreForm").each(function(H,J){J=jq(J);if(J.parents(".formsContainer").length===0){var I=jq("<div class='formsContainer' data-autowrapped='true'><div class='formsContainerBody' style='visibility: hidden'></div></div>");I.attr("id","formsContainer_"+(new Date()).getTime());J.before(I);I.find(".formsContainerBody").append(J)}})}function E(Y,T){var S=CoreFormsBase.inheritanceFrom(CoreFormsBase.createBaseType());S.typeName="rlFormsContainer";var J=false;var j={};var I=rlCoreFormEvents.create(null,null);function k(m){var n=m.attr("data-jsModuleVar");if(!n){throw ("Couldn't find required form property 'data-jsModuleVar'")}return n}function d(m){if(!window[m]){throw ("Couldn't find instance for data-jsModuleVar="+m)}return window[m]}function O(n){var m=[];Y.find("[data-jsModuleVar]").each(function(p,q){var o=jq(q).attr("data-jsModuleVar");o=o.substring(2,3).toLowerCase()+o.substring(3);m.push(o)});n&&rlComponentLoader.deferredExec(makeArrayUnique(m),n)}function R(){Y.find("form.coreForm").each(function(m,n){n=jq(n);var q=k(n);var p={formId:n.attr("id"),containerEvents:I,fromVarName:q,isLoggedIn:J,reinitialise:function(){Z()}};if(j[p.formId]){throw ("Attempted to register duplicate form ID: "+p.formId)}var o=d(q).create(n,p);Q(q,n,p);typeof (o.setUseMock)==="function"&&o.setUseMock(rlPage.isUseMock());j[p.formId]=o})}function g(){for(var m in j){if(m&&j.hasOwnProperty(m)&&j[m]){j[m].init()}}}function N(p){var r=[];var n={};for(var o=0,m=p.length;o<m;o++){var q=p[o];if(q.id||q.id===0){if(n[q.id]){n[q.id].arrayOfFS.push(q.fieldSetId)}else{r.push(q);n[q.id]=q;q.arrayOfFS=[];q.arrayOfFS.push(q.fieldSetId)}}}n=null;return r}function P(){var m=[];jq.each(j,function(o,n){jq(n.getSources()).each(function(p,q){m.push(q)})});return N(m)}function h(){var o=[];var n=P();for(var m=0;m<n.length;m++){var q=n[m];q.meta=true;q.data=J;var p=rlDataSourceFactory.createDS(q);p&&o.push(p)}return o}function b(n){var m={};jq.each(j,function(p,o){if(typeof (o.getContext)==="function"&&o.getContext()){if(m.context&&m.context!==o.getContext()){throw ("Multiple forms with different datasource contexts not supported.")}m.context=o.getContext()}if(typeof (o.getUseCaseMetaDataRoot)==="function"&&o.getUseCaseMetaDataRoot()){if(m.useCaseMetaDataRoot&&m.useCaseMetaDataRoot!==o.getUseCaseMetaDataRoot()){throw ("Multiple forms with different datasource useCaseMetaDataRoots not supported.")}m.useCaseMetaDataRoot=o.getUseCaseMetaDataRoot()}});jq.each(n,function(o,p){if(typeof (p.setOptions)==="function"){p.setOptions(m)}})}function Z(){var n=h();b(n);if(n.length>0){var m=rlAggregatedFormDS.createDS({dataSources:n});m.setUseMock(rlPage.isUseMock());m.get({success:function(o){V(o);U();X()},error:function(o){X();rlErrorService.handleError({actor:rlErrorService.ACTOR_SYSTEM,requestStatus:o})},canCopeWithDataSourceError:function(p){var o=true;jq.each(j,function(r,q){if(!q.canCopeWithDataSourceError(p)){o=false;return false}});return o}})}else{V({});U();X()}}function a(){return rlJQuery_queryParams.getQueryParam("mockLogin")!="false"}function V(m){jq.each(j,function(p,o){var n=K(o,m);o.setMetaData(n.metaData);o.setData(n.data)})}function U(){jq.each(j,function(n,m){m.ready();L(m)});C()}function K(n,o){var m={data:{},metaData:{}};jq.each(N(n.getSources()),function(p,q){if(typeof (o[q.id])!=="undefined"){m.data[q.id]=o[q.id].data;jq.each(o[q.id].metaData,function(s,r){m.metaData[s]=r})}});return m}function c(){M()&&Y.addClass("cqEditMode")}function H(){R();g();W(function(){Z()})}function W(n){var m=0;jq.each(j,function(p,o){if(typeof (o.preInitAsync)==="function"){++m}});if(m>0){jq.each(j,function(p,o){if(typeof (o.preInitAsync)==="function"){o.preInitAsync(function(){--m;if(m<1){n&&n()}})}})}else{n&&n()}}function M(){return rlPage.isEditMode()||rlPage.isDesignMode()}function X(){if(!M()){rlDither.off(Y)}}function e(){if(!M()){var n=Y.css("min-width");var m=Y.css("min-height");Y.css("min-width","700px");Y.css("min-height","240px");rlDither.on(Y);Y.css("min-width",n);Y.css("min-height",m)}}function f(m){jq(window).unbind("coreServices_error",f);rlErrorService.handleError({actor:rlErrorService.ACTOR_SYSTEM,requestStatus:"coreServices error "+m})}function L(m){jq(window).trigger(rlTrackingListener.EVENTS.EVENT_TRACKING_LISTENER_NOTIFICATION,{id:rlTrackingListener.FORM_IDS.FORM_READY,info:k(m.getJqForm()),type:rlTrackingListener.TRACKING_TYPES.FORM})}function Q(p,m,o){var n={formAttributes:m.data(),formName:p,formId:o.formId};jq(window).trigger(rlTrackingListener.EVENTS.EVENT_TRACKING_LISTENER_NOTIFICATION,{id:rlTrackingListener.FORM_IDS.FORM_CREATE,info:n,type:rlTrackingListener.TRACKING_TYPES.FORM})}S.triggerFormsClosing=function(){jq.each(j,function(n,m){m.closing()})};S.getFormsById=function(){return j};S.getFormById=function(m){return j&&j.hasOwnProperty(m)&&j[m]};e();c();O(function(){if(M()||rlPage.isUseMock()){J=a();H()}else{jq(window).bind("coreServices_error",f);rlCoreServices.isLoggedIn({loggedIn:function(){jq(window).unbind("coreServices_error",f);J=true;H()},loggedOut:function(){jq(window).unbind("coreServices_error",f);J=false;H()},error:function(n,m,m){f(n)}})}});return S}return{__init__:function(){G={};A();F();B();D()},__start__:function(){},listenForFormsInGlassPaneLayer:B,getFormsContainersById:function(){return G},getFormsContainerById:function(H){return this.getFormsContainersById()[H]},getFormById:function(H,J){var I=this.getFormsContainerById(H);return I?I.getFormById(J):undefined}}}();var rlGlassPaneLayerOkCancel=function(){function D(E){if(A(E)){C(E);B(E)}}function A(F){var E=GLOBAL_GPL_OKCANCELTEMPLATE_URL;var G=false;try{jq.ajax({type:"GET",url:E,success:function(I){jq("#gplOkCancelHiddenSource").remove();jq("body").append("<div id='gplOkCancelHiddenSource' style='display: none; position: absolute; left: 0px; top: 0px; border: 1px solid RED'>"+I+"</div>");if(F.reverseButtonOrder===true){jq(".gplContentFooter").html('<div class="gplContentFooterButtonBar flexbox"><a class="buttonComp buttonBlue okButton" href="javascript:void(0)">OK</a><a class="buttonComp cancelBtn" href="javascript:void(0)">Cancel</a>')}else{jq(".gplContentFooter").html('<div class="gplContentFooterButtonBar flexbox"><a class="buttonComp cancelBtn" href="javascript:void(0)">Cancel</a><a class="buttonComp buttonBlue okButton" href="javascript:void(0)">OK</a>')}console.log("We got success on ajax call for gplokcancel");G=true},error:function(I){console.log("Loading GPL dialog content template failed: "+JSON.stringify(I));G=false},async:false})}catch(H){console.log("Failed jQuery.ajax call "+E+": "+H);G=false}return G}function C(F){if(typeof F.dialogId==="string"){jq(".gplContent").attr("id",F.dialogId)}else{jq(".gplContent").removeAttr("id")}jq(".gplContentBody").addClass("gplContentBodyOkCancel");var G="";if(typeof F.dialogHeadline=="string"){G=F.dialogHeadline}else{if(typeof F.dialogHeadline=="function"){G=F.dialogHeadline()}}if(G!=""){jq(".gplContentHeadline > div > h1").html(G)}else{jq(".gplContentHeadline").hide()}var E="";if(typeof F.dialogSubHeadline=="string"){E=F.dialogSubHeadline}else{if(typeof F.dialogSubHeadline=="function"){E=F.dialogSubHeadline()}}if(E!=""){jq(".gplContentSubHeadline > div > h3").html(E)}else{jq(".gplContentSubHeadline").hide()}if(typeof F.dialogContent=="function"){jq(".gplContentBody").html(F.dialogContent())}else{if(typeof F.dialogContent=="string"){jq(".gplContentBody").html(F.dialogContent)}}if(F.okButtonLabel){jq(".gplContentFooterButtonBar > .okButton").html(F.okButtonLabel)}if(typeof F.okButtonCallback=="function"){jq(".gplContentFooterButtonBar > .okButton").click(function(){return F.okButtonCallback()})}if(F.cancelButtonLabel){jq(".gplContentFooterButtonBar > .cancelBtn").html(F.cancelButtonLabel)}if(typeof F.cancelButtonCallback=="function"){jq(".gplContentFooterButtonBar > .cancelBtn").click(function(){return F.cancelButtonCallback()})}if(F.defaultButton=="OK"){jq(".gplContentFooterButtonBar > .okButton").addClass("defaultButton")}else{if(F.defaultButton=="CANCEL"){jq(".gplContentFooterButtonBar > .cancelBtn").addClass("defaultButton")}}}function B(E){rlGlassPaneLayerNext.openDialog({content:".gplContent",forceSwitch:E.forceSwitch,forceClone:true,keepUrlHash:E&&E.keepUrlHash===true})}return{__init__:function(){},openDialog:function(E){D(E)},closeDialog:function(){rlGlassPaneLayerNext.closeDialog()}}}();var rlIdentifyDealer=function(){function A(){try{var B={};window.rlCoreServices.setCurrentDealerForRfx(B,function(){console.log("Call to service rlCoreServices.setCurrentDealerForRfx() was successful!")},function(){console.warn("Call to service rlCoreServices.setCurrentDealerForRfx() ended in error.")})}catch(C){console.warn("Error while trying to set the last visited dealer in the shared session context: "+C)}}return{__init__:function(){},navigateToDealerOrDLO:function(){this.getLastVisitedDealerHomeUrl(function(B){if(B){window.location.href=B}else{if(window.rlCoreServices&&window.rlCoreServices.trackEventAsClick){window.rlCoreServices.trackEventAsClick("topnavBMWPartnerLinkClicked_OpenDLO","topnavAction")}rlUserDialog.showRequestDLO()}})},setLastVisitedDealerData:function(){if(window.rlPage&&!window.rlPage.isEditMode()){jq(document).ready(function(B){A()})}},getLastVisitedDealerData:function(C){try{window.rlCoreServices.getCurrentDealerForRfx(function(D){if(typeof C=="function"){C(D)}},function(){console.warn("Call to service rlCoreServices.getCurrentDealerForRfx() ended in error.");if(typeof C=="function"){C()}})}catch(B){console.warn("Error while trying to get the last visited dealer from the shared session context: "+B)}},getDealerHomeUrl:function(G,C,F){var E=window.mandatorLanguageBasePath;var D=E.lastIndexOf(".");var B=(D==-1?E:E.substr(0,D))+"/index.dealer.dealerId="+G+".js";jq.ajax({dataType:"json",type:"GET",url:B,async:C,success:function(H){if(typeof F=="function"&&H&&H[G]&&H[G].attributes&&H[G].attributes.homepage){F(H[G].attributes.homepage)}},error:function(){if(typeof F=="function"){F()}}})},getLastVisitedDealerHomeUrl:function(C){var B=this;this.getLastVisitedDealerData(function(E){if(E&&E.distributionPartnerId&&E.outletId){var D=E.distributionPartnerId+"_"+E.outletId;B.getDealerHomeUrl(D,true,C)}else{if(typeof C=="function"){C()}}})}}}();var rlInfoMaterialDS=function(){function A(J,G){var L=CoreFormsBase.inheritanceFrom(rlBaseDataSource.createDS(J));var K=L.parent;L.typeName="rlInfoMaterialDS";L.get=function(M){rlComponentLoader.deferredExec(["coreServices"],function(){L.parent.get.call(L,M)})};L.getUserData=function(N,M){N({})};L.getMetaData=function(N,M){if(L.getUseMock()){H(N)}else{rlCoreServices.getRequestForInformationMaterial(G,function(O){if(O){O=[].concat(O);N(I(O))}else{console.error("Metadata Service for RFI Downloads returned an empty list.");M(null)}},function(O){M(O)})}};function I(M){var Q={};Q.primarySelection={};Q.singleSelection={};for(var N=0;N<M.length;N++){var P=M[N];if(typeof P.materialCode==="undefined"){continue}else{var R=escape(P.materialCode);if(typeof P.seriesId==="undefined"){Q.singleSelection[R]=P}else{if(typeof Q.primarySelection[P.seriesId]==="undefined"){Q.primarySelection[P.seriesId]=new Object();Q.primarySelection[P.seriesId].brochures={};Q.primarySelection[P.seriesId].seriesTitle=P.seriesTitle;Q.primarySelection[P.seriesId].seriesId=P.seriesId}if(typeof Q.primarySelection[P.seriesId].brochures[R]==="undefined"){Q.primarySelection[P.seriesId].brochures[R]=new Array()}Q.primarySelection[P.seriesId].brochures[R].push(P)}}P.imageUrl=C(P.imageUrl);P.pdfUrl=E(P.pdfUrl)}var O={};O.infoMaterial=Q;return O}function E(N){var M="";if(N){M=F(N);M=D(M,"download")}return M}function C(N){var M="";if(N){M=F(N);M=B(M);M=D(M,"resource")}return M}function F(N){var M=N;var O=N.indexOf("/content");if(O==0){M=N.substring("/content".length,N.length)}else{O=N.indexOf("content");if(O==0){M=N.substring("content".length,N.length)}}return M}function B(N){var M=N;var O="/jcr:content/renditions/cq5dam.thumbnail.319.319.png";var P=N.indexOf(O);if(P==-1){M=N+O}M=M.replace("/jcr:content","/_jcr_content");return M}function D(Q,M){var P=Q;var N=Q.lastIndexOf(".");var O=Q.lastIndexOf("."+M+".");if(N!=-1&&O==-1){var R=Q.substring(N+1,Q.length);if(R){P=Q+"."+M+"."+R}}return P}function H(M){rlComponentLoader.requireComponentWithDeferredExec("infoMaterialDSMock",function(){var N=rlInfoMaterialDSMock.getMockedMetaData();M(I(N.infoMaterial))})}return L}return{__init__:function(){},__start__:function(){},createDS:function(C,B){return A(C,B)}}}();var rlInfoMaterialDSMock=function(){return{__init__:function(){},__start__:function(){},getMockedUserData:function(){return{}},getMockedMetaData:function(){return{infoMaterial:[{"@type":"infomaterialVO",bodytypeId:"HC",infomaterialGroup:"Automobile",materialCode:"1-1SU2HGC",seriesId:"1",seriesTitle:"(1er Serie)",title:"BMW 1er 3-Trer",modelRangeId:"MR-HC"},{"@type":"infomaterialVO",bodytypeId:"SH",infomaterialGroup:"Automobile",materialCode:"1-372WTHC",seriesId:"1",seriesTitle:"(1er Serie)",title:"BMW 1er 5-Trer",modelRangeId:"MR-SH"},{"@type":"infomaterialVO",bodytypeId:"CA",infomaterialGroup:"Automobile",materialCode:"1-1SUDYDK",seriesId:"1",seriesTitle:"(1er Serie)",title:"BMW 1er Cabrio",modelRangeId:"MR-CA"},{"@type":"infomaterialVO",bodytypeId:"CP",infomaterialGroup:"Automobile",materialCode:"1-1SU2HGG",seriesId:"1",seriesTitle:"(1er Serie)",title:"BMW 1er Coup",modelRangeId:"MR-CP"},{"@type":"infomaterialVO",infomaterialGroup:"Zubehr",materialCode:"1-1STYE1F",seriesId:"1",seriesTitle:"(1er Serie)",title:"BMW Performance (1er & 3er Reihe)"},{"@type":"infomaterialVO",infomaterialGroup:"Zubehr",materialCode:"1-1STYE0Z",seriesId:"1",seriesTitle:"(1er Serie)",title:"BMW Zubehr 1er"},{"@type":"infomaterialVO",bodytypeId:"CA",infomaterialGroup:"Automobile",materialCode:"1-1SUDYDW",seriesId:"3",seriesTitle:"(3er Serie)",title:"BMW 3er Cabrio",modelRangeId:"MR-CA"},{"@type":"infomaterialVO",bodytypeId:"CP",infomaterialGroup:"Automobile",materialCode:"1-1SUDYDS",seriesId:"3",seriesTitle:"(3er Serie)",title:"BMW 3er Coup",modelRangeId:"MR-CP"},{"@type":"infomaterialVO",bodytypeId:"LI",infomaterialGroup:"Automobile",materialCode:"1-1SUDYDO",seriesId:"3",seriesTitle:"(3er Serie)",title:"BMW 3er Limousine",modelRangeId:"MR-LI"},{"@type":"infomaterialVO",bodytypeId:"TO",infomaterialGroup:"Automobile",materialCode:"1-1SUDYE0",seriesId:"3",seriesTitle:"(3er Serie)",title:"BMW 3er Touring",modelRangeId:"MR-TO"},{"@type":"infomaterialVO",infomaterialGroup:"Zubehr",materialCode:"1-1STYE1F",seriesId:"3",seriesTitle:"(3er Serie)",title:"BMW Performance (1er & 3er Reihe)"},{"@type":"infomaterialVO",infomaterialGroup:"Zubehr",materialCode:"1-1STYE11",seriesId:"3",seriesTitle:"(3er Serie)",title:"BMW Zubehr 3er"},{"@type":"infomaterialVO",bodytypeId:"ST",infomaterialGroup:"Automobile",materialCode:"1-26M4YOU",seriesId:"5",seriesTitle:"(5er Serie)",title:"BMW 5er Gran Turismo",modelRangeId:"MR-ST"},{"@type":"infomaterialVO",bodytypeId:"LI",infomaterialGroup:"Automobile",materialCode:"1-1SUDYF6",seriesId:"5",seriesTitle:"(5er Serie)",title:"BMW 5er Limousine",modelRangeId:"MR-LI"},{"@type":"infomaterialVO",bodytypeId:"TO",infomaterialGroup:"Automobile",materialCode:"1-1SUDYFA",seriesId:"5",seriesTitle:"(5er Serie)",title:"BMW 5er Touring",modelRangeId:"MR-TO"},{"@type":"infomaterialVO",infomaterialGroup:"Zubehr",materialCode:"1-1STYE0R",seriesId:"5",seriesTitle:"(5er Serie)",title:"BMW Zubehr 5er"},{"@type":"infomaterialVO",infomaterialGroup:"Zubehr",materialCode:"1-2H020M4",seriesId:"5",seriesTitle:"(5er Serie)",title:"BMW Zubehr 5er Gran Turismo"},{"@type":"infomaterialVO",bodytypeId:"CA",infomaterialGroup:"Automobile",materialCode:"1-1SUDYFE",seriesId:"6",seriesTitle:"(6er Serie)",title:"BMW 6er Coup / Cabrio",modelRangeId:"MR-CA"},{"@type":"infomaterialVO",bodytypeId:"CP",infomaterialGroup:"Automobile",materialCode:"1-1SUDYFE",seriesId:"6",seriesTitle:"(6er Serie)",title:"BMW 6er Coup / Cabrio",modelRangeId:"MR-CP"},{"@type":"infomaterialVO",bodytypeId:"NK",infomaterialGroup:"Automobile",materialCode:"1-3H34VAE",seriesId:"6",seriesTitle:"(6er Serie)",title:"BMW 6er Gran Coup",modelRangeId:"MR-NK"},{"@type":"infomaterialVO",infomaterialGroup:"Zubehr",materialCode:"1-1STYE0X",seriesId:"6",seriesTitle:"(6er Serie)",title:"BMW Zubehr 6er"},{"@type":"infomaterialVO",bodytypeId:"LI",infomaterialGroup:"Automobile",materialCode:"1-1SUDYFN",seriesId:"7",seriesTitle:"(7er Serie)",title:"BMW 7er Limousine",modelRangeId:"MR-LI"},{"@type":"infomaterialVO",infomaterialGroup:"Zubehr",materialCode:"1-1STYE13",seriesId:"7",seriesTitle:"(7er Serie)",title:"BMW Zubehr 7er"},{"@type":"infomaterialVO",bodytypeId:"SC",infomaterialGroup:"Automobile",materialCode:"1-2DE3322",seriesId:"Hybrid",seriesTitle:"(ActiveHybrid Serie)",title:"BMW ActiveHybrid X6 / 7",modelRangeId:"MR-SC"},{"@type":"infomaterialVO",bodytypeId:"LI",infomaterialGroup:"Automobile",materialCode:"1-2DE3322",seriesId:"(Hybrid)",seriesTitle:"(ActiveHybrid Serie)",title:"BMW ActiveHybrid X6 / 7",modelRangeId:"MR-LI"},{"@type":"infomaterialVO",infomaterialGroup:"Automobile",materialCode:"1-1SUDYE4",seriesId:"M",seriesTitle:"(M Serie)",title:"BMW M3"},{"@type":"infomaterialVO",infomaterialGroup:"Automobile",materialCode:"1-1SUDYGK",seriesId:"M",seriesTitle:"(M Serie)",title:"BMW M5"},{"@type":"infomaterialVO",infomaterialGroup:"Automobile",materialCode:"1-1SUDYGF",seriesId:"M",seriesTitle:"(M Serie)",title:"BMW M6"},{"@type":"infomaterialVO",bodytypeId:"GF",infomaterialGroup:"Automobile",materialCode:"1-26M4YP2",seriesId:"M",seriesTitle:"(M Serie)",title:"BMW X5 M / X6 M",modelRangeId:"MR-GF"},{"@type":"infomaterialVO",bodytypeId:"SC",infomaterialGroup:"Automobile",materialCode:"1-26M4YP2",seriesId:"M",seriesTitle:"(M Serie)",title:"BMW X5 M / X6 M",modelRangeId:"MR-SC"},{"@type":"infomaterialVO",infomaterialGroup:"Automobile",materialCode:"1-287KJJ1",seriesId:"X",seriesTitle:"(X Serie)",title:"BMW X1"},{"@type":"infomaterialVO",infomaterialGroup:"Automobile",materialCode:"1-1SUDXWK",seriesId:"X",seriesTitle:"(X Serie)",title:"BMW X3"},{"@type":"infomaterialVO",infomaterialGroup:"Automobile",materialCode:"1-1SU2HG8",seriesId:"X",seriesTitle:"(X Serie)",title:"BMW X5"},{"@type":"infomaterialVO",bodytypeId:"SC",infomaterialGroup:"Automobile",materialCode:"1-1SUDYFJ",seriesId:"X",seriesTitle:"(X Serie)",title:"BMW X6",modelRangeId:"MR-SC"},{"@type":"infomaterialVO",infomaterialGroup:"Zubehr",materialCode:"1-2H020M8",seriesId:"X",seriesTitle:"(X Serie)",title:"BMW Zubehr X1"},{"@type":"infomaterialVO",infomaterialGroup:"Zubehr",materialCode:"1-1STYE0T",seriesId:"X",seriesTitle:"(X Serie)",title:"BMW Zubehr X3"},{"@type":"infomaterialVO",infomaterialGroup:"Zubehr",materialCode:"1-1STYE15",seriesId:"X",seriesTitle:"(X Serie)",title:"BMW Zubehr X5"},{"@type":"infomaterialVO",infomaterialGroup:"Zubehr",materialCode:"1-1STYE17",seriesId:"X",seriesTitle:"(X Serie)",title:"BMW Zubehr X6"},{"@type":"infomaterialVO",bodytypeId:"RO",infomaterialGroup:"Automobile",materialCode:"1-1SUDYEA",seriesId:"Z",seriesTitle:"(Z Serie)",title:"BMW Z4"},{"@type":"infomaterialVO",infomaterialGroup:"Zubehr",materialCode:"1-1STYE0V",seriesId:"Z",seriesTitle:"(Z Serie)",title:"BMW Zubehr Z4"},{"@type":"infomaterialVO",infomaterialGroup:"Lifestyle",materialCode:"1-26S9QU8",title:"(BMW Bikes & Equipment)"},{"@type":"infomaterialVO",infomaterialGroup:"Innovationen",materialCode:"1-1YU7TOB",title:"(BMW ConnectedDrive)"},{"@type":"infomaterialVO",infomaterialGroup:"Innovationen",materialCode:"1-1STYDW1",title:"(BMW EfficientDynamics)"},{"@type":"infomaterialVO",infomaterialGroup:"Services",materialCode:"1-1STYDWJ",title:"(BMW Financial Services Gesamtkatalog)"},{"@type":"infomaterialVO",infomaterialGroup:"Automobile",materialCode:"1-1SUDY5R",title:"(BMW Gesamtkatalog)"},{"@type":"infomaterialVO",infomaterialGroup:"Innovationen",materialCode:"1-2FT2DON",title:"(BMW Innovationen)"},{"@type":"infomaterialVO",infomaterialGroup:"Lifestyle",materialCode:"1-1STYE19",title:"(BMW Lifestyle Gesamtkatalog)"}]}}}}();rlJQueryTextAreaCounter=function(){return{__init__:function(){(function(A){A.fn.textareaCount=function(H,K){var O={maxCharacterSize:-1,originalStyle:"originalTextareaInfo",warningStyle:"warningTextareaInfo",warningNumber:20,displayFormat:"#input characters | #words words"};var H=A.extend(O,H);var Q=A(this);A("<div class='charleft'>&nbsp;</div>").insertAfter(Q);var S={width:Q.width()};var F=I(Q);F.addClass(H.originalStyle);F.css(S);var P=0;var M=H.maxCharacterSize;var T=0;var R=0;Q.bind("keyup",function(U){C()}).bind("click",function(U){setTimeout(function(){C()},10)}).bind("paste",function(U){setTimeout(function(){C()},10)});function C(){var U=G();if(typeof K==="undefined"){F.html(U)}else{var V=L();V.formattedText=U;K.call(this,V)}return true}function G(){var W=Q.val();var U=W.length;if(H.maxCharacterSize>0){if(U>=H.maxCharacterSize){W=W.substring(0,H.maxCharacterSize)}var X=E(W);var V=H.maxCharacterSize-X;if(!N()){V=H.maxCharacterSize}if(U>V){var Y=this.scrollTop;Q.val(W.substring(0,V));this.scrollTop=Y}F.removeClass(H.warningStyle);if(V-U<=H.warningNumber){F.addClass(H.warningStyle)}P=Q.val().length+X;if(!N()){P=Q.val().length}R=D(J(Q.val()));T=M-P}else{var X=E(W);P=Q.val().length+X;if(!N()){P=Q.val().length}R=D(J(Q.val()))}return B()}function B(){var U=H.displayFormat;U=U.replace("#input",P);U=U.replace("#words",R);if(M>0){U=U.replace("#max",M);U=U.replace("#left",T)}return U}function L(){var U={input:P,max:M,left:T,words:R};return U}function I(U){return U.next(".charleft")}function N(){var U=navigator.appVersion;if(U.toLowerCase().indexOf("win")!=-1){return true}return false}function E(V){var W=0;for(var U=0;U<V.length;U++){if(V.charAt(U)=="\n"){W++}}return W}function J(X){var Z=X+" ";var a=/^[^A-Za-z0-9]+/gi;var V=Z.replace(a,"");var U=rExp=/[^A-Za-z0-9]+/gi;var W=V.replace(U," ");var Y=W.split(" ");return Y}function D(U){var V=U.length-1;return V}}})(jQuery)}}}();var rlJQuery_form=function(){return{__start__:function(){},__init__:function(){
/*
		   * jQuery Form Plugin
		   * version: 2.84 (12-AUG-2011)
		   * @requires jQuery v1.3.2 or later
		   *
		   * Examples and documentation at: http://malsup.com/jquery/form/
		   * Dual licensed under the MIT and GPL licenses:
		   *   http://www.opensource.org/licenses/mit-license.php
		   *   http://www.gnu.org/licenses/gpl.html
		   */
(function($){$.fn.ajaxSubmit=function(options){if(!this.length){log("ajaxSubmit: skipping submit process - no element selected");return this}var method,action,url,$form=this;if(typeof options=="function"){options={success:options}}method=this.attr("method");action=this.attr("action");url=(typeof action==="string")?$.trim(action):"";url=url||window.location.href||"";if(url){url=(url.match(/^([^#]+)/)||[])[1]}options=$.extend(true,{url:url,success:$.ajaxSettings.success,type:method||"GET",iframeSrc:/^https/i.test(window.location.href||"")?"javascript:false":"about:blank"},options);var veto={};this.trigger("form-pre-serialize",[this,options,veto]);if(veto.veto){log("ajaxSubmit: submit vetoed via form-pre-serialize trigger");return this}if(options.beforeSerialize&&options.beforeSerialize(this,options)===false){log("ajaxSubmit: submit aborted via beforeSerialize callback");return this}var n,v,a=this.formToArray(options.semantic);if(options.data){options.extraData=options.data;for(n in options.data){if($.isArray(options.data[n])){for(var k in options.data[n]){a.push({name:n,value:options.data[n][k]})}}else{v=options.data[n];v=$.isFunction(v)?v():v;a.push({name:n,value:v})}}}if(options.beforeSubmit&&options.beforeSubmit(a,this,options)===false){log("ajaxSubmit: submit aborted via beforeSubmit callback");return this}this.trigger("form-submit-validate",[a,this,options,veto]);if(veto.veto){log("ajaxSubmit: submit vetoed via form-submit-validate trigger");return this}var q=$.param(a);if(options.type.toUpperCase()=="GET"){options.url+=(options.url.indexOf("?")>=0?"&":"?")+q;options.data=null}else{options.data=q}var callbacks=[];if(options.resetForm){callbacks.push(function(){$form.resetForm()})}if(options.clearForm){callbacks.push(function(){$form.clearForm()})}if(!options.dataType&&options.target){var oldSuccess=options.success||function(){};callbacks.push(function(data){var fn=options.replaceTarget?"replaceWith":"html";$(options.target)[fn](data).each(oldSuccess,arguments)})}else{if(options.success){callbacks.push(options.success)}}options.success=function(data,status,xhr){var context=options.context||options;for(var i=0,max=callbacks.length;i<max;i++){callbacks[i].apply(context,[data,status,xhr||$form,$form])}};var fileInputs=$("input:file",this).length>0;var mp="multipart/form-data";var multipart=($form.attr("enctype")==mp||$form.attr("encoding")==mp);if(options.iframe!==false&&(fileInputs||options.iframe||multipart)){if(options.closeKeepAlive){$.get(options.closeKeepAlive,function(){fileUpload(a)})}else{fileUpload(a)}}else{if($.browser.msie&&method=="get"){var ieMeth=$form[0].getAttribute("method");if(typeof ieMeth==="string"){options.type=ieMeth}}$.ajax(options)}this.trigger("form-submit-notify",[this,options]);return this;function fileUpload(a){var form=$form[0],el,i,s,g,id,$io,io,xhr,sub,n,timedOut,timeoutHandle;var useProp=!!$.fn.prop;if(a){for(i=0;i<a.length;i++){el=$(form[a[i].name]);el[useProp?"prop":"attr"]("disabled",false)}}if($(":input[name=submit],:input[id=submit]",form).length){alert('Error: Form elements must not have name or id of "submit".');return }s=$.extend(true,{},$.ajaxSettings,options);s.context=s.context||s;id="jqFormIO"+(new Date().getTime());if(s.iframeTarget){$io=$(s.iframeTarget);n=$io.attr("name");if(n==null){$io.attr("name",id)}else{id=n}}else{$io=$('<iframe name="'+id+'" src="'+s.iframeSrc+'" />');$io.css({position:"absolute",top:"-1000px",left:"-1000px"})}io=$io[0];xhr={aborted:0,responseText:null,responseXML:null,status:0,statusText:"n/a",getAllResponseHeaders:function(){},getResponseHeader:function(){},setRequestHeader:function(){},abort:function(status){var e=(status==="timeout"?"timeout":"aborted");log("aborting upload... "+e);this.aborted=1;$io.attr("src",s.iframeSrc);xhr.error=e;s.error&&s.error.call(s.context,xhr,e,status);g&&$.event.trigger("ajaxError",[xhr,s,e]);s.complete&&s.complete.call(s.context,xhr,e)}};g=s.global;if(g&&!$.active++){$.event.trigger("ajaxStart")}if(g){$.event.trigger("ajaxSend",[xhr,s])}if(s.beforeSend&&s.beforeSend.call(s.context,xhr,s)===false){if(s.global){$.active--}return }if(xhr.aborted){return }sub=form.clk;if(sub){n=sub.name;if(n&&!sub.disabled){s.extraData=s.extraData||{};s.extraData[n]=sub.value;if(sub.type=="image"){s.extraData[n+".x"]=form.clk_x;s.extraData[n+".y"]=form.clk_y}}}var CLIENT_TIMEOUT_ABORT=1;var SERVER_ABORT=2;function getDoc(frame){var doc=frame.contentWindow?frame.contentWindow.document:frame.contentDocument?frame.contentDocument:frame.document;return doc}function doSubmit(){var t=$form.attr("target"),a=$form.attr("action");form.setAttribute("target",id);if(!method){form.setAttribute("method","POST")}if(a!=s.url){form.setAttribute("action",s.url)}if(!s.skipEncodingOverride&&(!method||/post/i.test(method))){$form.attr({encoding:"multipart/form-data",enctype:"multipart/form-data"})}if(s.timeout){timeoutHandle=setTimeout(function(){timedOut=true;cb(CLIENT_TIMEOUT_ABORT)},s.timeout)}function checkState(){try{var state=getDoc(io).readyState;log("state = "+state);if(state.toLowerCase()=="uninitialized"){setTimeout(checkState,50)}}catch(e){log("Server abort: ",e," (",e.name,")");cb(SERVER_ABORT);timeoutHandle&&clearTimeout(timeoutHandle);timeoutHandle=undefined}}var extraInputs=[];try{if(s.extraData){for(var n in s.extraData){extraInputs.push($('<input type="hidden" name="'+n+'" />').attr("value",s.extraData[n]).appendTo(form)[0])}}if(!s.iframeTarget){$io.appendTo("body");io.attachEvent?io.attachEvent("onload",cb):io.addEventListener("load",cb,false)}setTimeout(checkState,15);form.submit()}finally{form.setAttribute("action",a);if(t){form.setAttribute("target",t)}else{$form.removeAttr("target")}$(extraInputs).remove()}}if(s.forceSync){doSubmit()}else{setTimeout(doSubmit,10)}var data,doc,domCheckCount=50,callbackProcessed;function cb(e){if(xhr.aborted||callbackProcessed){return }try{doc=getDoc(io)}catch(ex){log("cannot access response document: ",ex);e=SERVER_ABORT}if(e===CLIENT_TIMEOUT_ABORT&&xhr){xhr.abort("timeout");return }else{if(e==SERVER_ABORT&&xhr){xhr.abort("server abort");return }}if(!doc||doc.location.href==s.iframeSrc){if(!timedOut){return }}io.detachEvent?io.detachEvent("onload",cb):io.removeEventListener("load",cb,false);var status="success",errMsg;try{if(timedOut){throw"timeout"}var isXml=s.dataType=="xml"||doc.XMLDocument||$.isXMLDoc(doc);log("isXml="+isXml);if(!isXml&&window.opera&&(doc.body==null||doc.body.innerHTML=="")){if(--domCheckCount){log("requeing onLoad callback, DOM not available");setTimeout(cb,250);return }}var docRoot=doc.body?doc.body:doc.documentElement;xhr.responseText=docRoot?docRoot.innerHTML:null;xhr.responseXML=doc.XMLDocument?doc.XMLDocument:doc;if(isXml){s.dataType="xml"}xhr.getResponseHeader=function(header){var headers={"content-type":s.dataType};return headers[header]};if(docRoot){xhr.status=Number(docRoot.getAttribute("status"))||xhr.status;xhr.statusText=docRoot.getAttribute("statusText")||xhr.statusText}var dt=s.dataType||"";var scr=/(json|script|text)/.test(dt.toLowerCase());if(scr||s.textarea){var ta=doc.getElementsByTagName("textarea")[0];if(ta){xhr.responseText=ta.value;xhr.status=Number(ta.getAttribute("status"))||xhr.status;xhr.statusText=ta.getAttribute("statusText")||xhr.statusText}else{if(scr){var pre=doc.getElementsByTagName("pre")[0];var b=doc.getElementsByTagName("body")[0];if(pre){xhr.responseText=pre.textContent?pre.textContent:pre.innerHTML}else{if(b){xhr.responseText=b.innerHTML}}}}}else{if(s.dataType=="xml"&&!xhr.responseXML&&xhr.responseText!=null){xhr.responseXML=toXml(xhr.responseText)}}try{data=httpData(xhr,s.dataType,s)}catch(e){status="parsererror";xhr.error=errMsg=(e||status)}}catch(e){log("error caught: ",e);status="error";xhr.error=errMsg=(e||status)}if(xhr.aborted){log("upload aborted");status=null}if(xhr.status){status=(xhr.status>=200&&xhr.status<300||xhr.status===304)?"success":"error"}if(status==="success"){s.success&&s.success.call(s.context,data,"success",xhr);g&&$.event.trigger("ajaxSuccess",[xhr,s])}else{if(status){if(errMsg==undefined){errMsg=xhr.statusText}s.error&&s.error.call(s.context,xhr,status,errMsg);g&&$.event.trigger("ajaxError",[xhr,s,errMsg])}}g&&$.event.trigger("ajaxComplete",[xhr,s]);if(g&&!--$.active){$.event.trigger("ajaxStop")}s.complete&&s.complete.call(s.context,xhr,status);callbackProcessed=true;if(s.timeout){clearTimeout(timeoutHandle)}setTimeout(function(){if(!s.iframeTarget){$io.remove()}xhr.responseXML=null},100)}var toXml=$.parseXML||function(s,doc){if(window.ActiveXObject){doc=new ActiveXObject("Microsoft.XMLDOM");doc.async="false";doc.loadXML(s)}else{doc=(new DOMParser()).parseFromString(s,"text/xml")}return(doc&&doc.documentElement&&doc.documentElement.nodeName!="parsererror")?doc:null};var parseJSON=$.parseJSON||function(s){return window["eval"]("("+s+")")};var httpData=function(xhr,type,s){var ct=xhr.getResponseHeader("content-type")||"",xml=type==="xml"||!type&&ct.indexOf("xml")>=0,data=xml?xhr.responseXML:xhr.responseText;if(xml&&data.documentElement.nodeName==="parsererror"){$.error&&$.error("parsererror")}if(s&&s.dataFilter){data=s.dataFilter(data,type)}if(typeof data==="string"){if(type==="json"||!type&&ct.indexOf("json")>=0){data=parseJSON(data)}else{if(type==="script"||!type&&ct.indexOf("javascript")>=0){$.globalEval(data)}}}return data}}};$.fn.ajaxForm=function(options){if(this.length===0){var o={s:this.selector,c:this.context};if(!$.isReady&&o.s){log("DOM not ready, queuing ajaxForm");$(function(){$(o.s,o.c).ajaxForm(options)});return this}log("terminating; zero elements found by selector"+($.isReady?"":" (DOM not ready)"));return this}return this.ajaxFormUnbind().bind("submit.form-plugin",function(e){if(!e.isDefaultPrevented()){e.preventDefault();$(this).ajaxSubmit(options)}}).bind("click.form-plugin",function(e){var target=e.target;var $el=$(target);if(!($el.is(":submit,input:image"))){var t=$el.closest(":submit");if(t.length==0){return }target=t[0]}var form=this;form.clk=target;if(target.type=="image"){if(e.offsetX!=undefined){form.clk_x=e.offsetX;form.clk_y=e.offsetY}else{if(typeof $.fn.offset=="function"){var offset=$el.offset();form.clk_x=e.pageX-offset.left;form.clk_y=e.pageY-offset.top}else{form.clk_x=e.pageX-target.offsetLeft;form.clk_y=e.pageY-target.offsetTop}}}setTimeout(function(){form.clk=form.clk_x=form.clk_y=null},100)})};$.fn.ajaxFormUnbind=function(){return this.unbind("submit.form-plugin click.form-plugin")};$.fn.formToArray=function(semantic){var a=[];if(this.length===0){return a}var form=this[0];var els=semantic?form.getElementsByTagName("*"):form.elements;if(!els){return a}var i,j,n,v,el,max,jmax;for(i=0,max=els.length;i<max;i++){el=els[i];n=el.name;if(!n){continue}if(semantic&&form.clk&&el.type=="image"){if(!el.disabled&&form.clk==el){a.push({name:n,value:$(el).val()});a.push({name:n+".x",value:form.clk_x},{name:n+".y",value:form.clk_y})}continue}v=$.fieldValue(el,true);if(v&&v.constructor==Array){for(j=0,jmax=v.length;j<jmax;j++){a.push({name:n,value:v[j]})}}else{if(v!==null&&typeof v!="undefined"){a.push({name:n,value:v})}}}if(!semantic&&form.clk){var $input=$(form.clk),input=$input[0];n=input.name;if(n&&!input.disabled&&input.type=="image"){a.push({name:n,value:$input.val()});a.push({name:n+".x",value:form.clk_x},{name:n+".y",value:form.clk_y})}}return a};$.fn.formSerialize=function(semantic){return $.param(this.formToArray(semantic))};$.fn.fieldSerialize=function(successful){var a=[];this.each(function(){var n=this.name;if(!n){return }var v=$.fieldValue(this,successful);if(v&&v.constructor==Array){for(var i=0,max=v.length;i<max;i++){a.push({name:n,value:v[i]})}}else{if(v!==null&&typeof v!="undefined"){a.push({name:this.name,value:v})}}});return $.param(a)};$.fn.fieldValue=function(successful){for(var val=[],i=0,max=this.length;i<max;i++){var el=this[i];var v=$.fieldValue(el,successful);if(v===null||typeof v=="undefined"||(v.constructor==Array&&!v.length)){continue}v.constructor==Array?$.merge(val,v):val.push(v)}return val};$.fieldValue=function(el,successful){var n=el.name,t=el.type,tag=el.tagName.toLowerCase();if(successful===undefined){successful=true}if(successful&&(!n||el.disabled||t=="reset"||t=="button"||(t=="checkbox"||t=="radio")&&!el.checked||(t=="submit"||t=="image")&&el.form&&el.form.clk!=el||tag=="select"&&el.selectedIndex==-1)){return null}if(tag=="select"){var index=el.selectedIndex;if(index<0){return null}var a=[],ops=el.options;var one=(t=="select-one");var max=(one?index+1:ops.length);for(var i=(one?index:0);i<max;i++){var op=ops[i];if(op.selected){var v=op.value;if(!v){v=(op.attributes&&op.attributes.value&&!(op.attributes.value.specified))?op.text:op.value}if(one){return v}a.push(v)}}return a}return $(el).val()};$.fn.clearForm=function(){return this.each(function(){$("input,select,textarea",this).clearFields()})};$.fn.clearFields=$.fn.clearInputs=function(){var re=/^(?:color|date|datetime|email|month|number|password|range|search|tel|text|time|url|week)$/i;return this.each(function(){var t=this.type,tag=this.tagName.toLowerCase();if(re.test(t)||tag=="textarea"){this.value=""}else{if(t=="checkbox"||t=="radio"){this.checked=false}else{if(tag=="select"){this.selectedIndex=-1}}}})};$.fn.resetForm=function(){return this.each(function(){if(typeof this.reset=="function"||(typeof this.reset=="object"&&!this.reset.nodeType)){this.reset()}})};$.fn.enable=function(b){if(b===undefined){b=true}return this.each(function(){this.disabled=!b})};$.fn.selected=function(select){if(select===undefined){select=true}return this.each(function(){var t=this.type;if(t=="checkbox"||t=="radio"){this.checked=select}else{if(this.tagName.toLowerCase()=="option"){var $sel=$(this).parent("select");if(select&&$sel[0]&&$sel[0].type=="select-one"){$sel.find("option").selected(false)}this.selected=select}}})};function log(){var msg="[jquery.form] "+Array.prototype.join.call(arguments,"");if(window.console&&window.console.log){window.console.log(msg)}else{if(window.opera&&window.opera.postError){window.opera.postError(msg)}}}})(jq)}}}();var rlJQuery_format=function(){return{__start__:function(){},__init__:function(){(function(A){A.dateNumberFormat=(function(){var D="undefined",C=true,E=false,B={date:{format:"MMM dd, yyyy h:mm:ss a",monthsFull:["January","February","March","April","May","June","July","August","September","October","November","December"],monthsShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],daysFull:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],daysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],shortDateFormat:"M/d/yyyy h:mm a",longDateFormat:"EEEE, MMMM dd, yyyy h:mm:ss a"},number:{format:"#,##0.0#",groupingSeparator:",",decimalSeparator:"."}};return{locale:function(G){if(G){for(var H in G){for(var F in G[H]){B[H][F]=G[H][F]}}}return B},date:function(e,p){var k=0,h=0,g=0,r="",K="",T,R;if(typeof e=="string"){var v=function(j,d,c,S){for(var H=S;H>=c;H--){var M=j.substring(d,d+H);if(M.length>=c&&(new RegExp(/^\d+$/)).test(M)){return M}}return null};if(typeof p==D){p=B.date.format}var O=false,J=0,F=new Date(),W=F.getYear(),u=F.getMonth()+1,t=1,G=F.getHours(),o=F.getMinutes(),f=F.getSeconds(),Q=F.getMilliseconds(),Z="",P,n;while(k<p.length){K="";r=p.charAt(k);while((p.charAt(k)==r)&&(k<p.length)){K+=p.charAt(k++)}if(K.indexOf("MMMM")>-1&&K.length>4){K="MMMM"}if(K.indexOf("EEEE")>-1&&K.length>4){K="EEEE"}if(K=="yyyy"||K=="yy"||K=="y"){if(K=="yyyy"){T=4;R=4}if(K=="yy"){T=2;R=2}if(K=="y"){T=2;R=4}W=v(e,J,T,R);if(W===null){return 0}J+=W.length;if(W.length==2){W=parseInt(W,10);if(W>70){W=1900+W}else{W=2000+W}}}else{if(K=="MMMM"){u=0;for(h=0,g=B.date.monthsFull.length;h<g;h++){P=B.date.monthsFull[h];if(e.substring(J,J+P.length).toLowerCase()==P.toLowerCase()){u=h+1;J+=P.length;break}}if((u<1)||(u>12)){return 0}}else{if(K=="MMM"){u=0;for(h=0,g=B.date.monthsShort.length;h<g;h++){P=B.date.monthsShort[h];if(e.substring(J,J+P.length).toLowerCase()==P.toLowerCase()){u=h+1;J+=P.length;break}}if((u<1)||(u>12)){return 0}}else{if(K=="EEEE"){for(h=0,g=B.date.daysFull.length;h<g;h++){n=B.date.daysFull[h];if(e.substring(J,J+n.length).toLowerCase()==n.toLowerCase()){J+=n.length;break}}}else{if(K=="EEE"){for(h=0,g=B.date.daysShort.length;h<g;h++){n=B.date.daysShort[h];if(e.substring(J,J+n.length).toLowerCase()==n.toLowerCase()){J+=n.length;break}}}else{if(K=="MM"||K=="M"){u=v(e,J,O?K.length:1,2);if(u===null||(u<1)||(u>12)){return 0}J+=u.length}else{if(K=="dd"||K=="d"){t=v(e,J,O?K.length:1,2);if(t===null||(t<1)||(t>31)){return 0}J+=t.length}else{if(K=="hh"||K=="h"){G=v(e,J,O?K.length:1,2);if(G===null||(G<1)||(G>12)){return 0}J+=G.length}else{if(K=="HH"||K=="H"){G=v(e,J,O?K.length:1,2);if(G===null||(G<0)||(G>23)){return 0}J+=G.length}else{if(K=="KK"||K=="K"){G=v(e,J,O?K.length:1,2);if(G===null||(G<0)||(G>11)){return 0}J+=G.length}else{if(K=="kk"||K=="k"){G=v(e,J,O?K.length:1,2);if(G===null||(G<1)||(G>24)){return 0}J+=G.length;G--}else{if(K=="mm"||K=="m"){o=v(e,J,O?K.length:1,2);if(o===null||(o<0)||(o>59)){return 0}J+=o.length}else{if(K=="ss"||K=="s"){f=v(e,J,O?K.length:1,2);if(f===null||(f<0)||(f>59)){return 0}J+=f.length}else{if(K=="SSS"||K=="SS"||K=="S"){Q=v(e,J,O?K.length:1,3);if(Q===null||(Q<0)||(Q>999)){return 0}J+=Q.length}else{if(K=="a"){var a=e.substring(J,J+2).toLowerCase();if(a=="am"){Z="AM"}else{if(a=="pm"){Z="PM"}else{return 0}}J+=2}else{if(K!=e.substring(J,J+K.length)){return 0}else{J+=K.length}}}}}}}}}}}}}}}}}if(J!=e.length){return 0}if(u==2){if(((W%4===0)&&(W%100!==0))||(W%400===0)){if(t>29){return 0}}else{if(t>28){return 0}}}if((u==4)||(u==6)||(u==9)||(u==11)){if(t>30){return 0}}if(G<12&&Z=="PM"){G=G-0+12}else{if(G>11&&Z=="AM"){G-=12}}return(new Date(W,u-1,t,G,o,f,Q))}else{var N=function(M,H){if(typeof H==D||H==2){return(M>=0&&M<10?"0":"")+M}else{if(M>=0&&M<10){return"00"+M}if(M>=10&&M<100){return"0"+M}return M}};if(typeof p==D){p=B.date.format}R=e.getYear();if(R<1000){R=String(R+1900)}var L=e.getMonth()+1,q=e.getDate(),X=e.getDay(),V=e.getHours(),b=e.getMinutes(),Y=e.getSeconds(),I=e.getMilliseconds();e={y:R,yyyy:R,yy:String(R).substring(2,4),M:L,MM:N(L),MMM:B.date.monthsShort[L-1],MMMM:B.date.monthsFull[L-1],d:q,dd:N(q),EEE:B.date.daysShort[X],EEEE:B.date.daysFull[X],H:V,HH:N(V)};if(V===0){e.h=12}else{if(V>12){e.h=V-12}else{e.h=V}}e.hh=N(e.h);e.k=V!==0?V:24;e.kk=N(e.k);if(V>11){e.K=V-12}else{e.K=V}e.KK=N(e.K);if(V>11){e.a="PM"}else{e.a="AM"}e.m=b;e.mm=N(b);e.s=Y;e.ss=N(Y);e.S=I;e.SS=N(I);e.SSS=N(I,3);var U="";k=0;r="";K="";Y=false;while(k<p.length){K="";r=p.charAt(k);if(r=="'"){k++;if(p.charAt(k)==r){U=U+r;k++}else{Y=!Y}}else{while(p.charAt(k)==r){K+=p.charAt(k++)}if(K.indexOf("MMMM")!=-1&&K.length>4){K="MMMM"}if(K.indexOf("EEEE")!=-1&&K.length>4){K="EEEE"}if(typeof e[K]!=D&&!Y){U=U+e[K]}else{U=U+K}}}return U}},number:function(U,Z){var Q,b,J,G,F,P,Y;if(typeof U=="string"){Q=B.number.groupingSeparator;J=B.number.decimalSeparator;G=U.indexOf(J);F=1;if(G!=-1){F=Math.pow(10,U.length-G-1)}U=U.replace(new RegExp("["+Q+"]","g"),"");U=U.replace(new RegExp("["+J+"]"),".");return Math.round(U*F)/F}else{if(typeof Z==D||Z.length<1){Z=B.number.format}Q=",";b=Z.lastIndexOf(Q);J=".";G=Z.indexOf(J);var a="",M="",X=U<0,S=Z.substr(G+1).replace(/#/g,"").length,R=Z.substr(G+1).length,d=10;U=Math.abs(U);if(G!=-1){M=B.number.decimalSeparator;if(R>0){F=1000;d=Math.pow(d,R);var H=Math.round(parseInt(U*d*F-Math.round(U)*d*F,10)/F),I=String(H<0?Math.round(parseInt(U*d*F-parseInt(U,10)*d*F,10)/F):H),T=U.toString().split(".");if(typeof T[1]!=D){for(Y=0;Y<R;Y++){if(T[1].substr(Y,1)=="0"&&Y<R-1&&(I.length!=R||I.substr(0,1)=="0")){I="0"+I}else{break}}}for(Y=0;Y<(R-M.length);Y++){I+="0"}var V,W="";for(Y=0;Y<I.length;Y++){V=I.substr(Y,1);if(Y>=S&&V=="0"&&/^0*$/.test(I.substr(Y+1))){break}W+=V}M+=W}if(M==B.number.decimalSeparator){M=""}}if(G!==0){if(M!=""){a=String(parseInt(Math.round(U*d)/d,10))}else{a=String(Math.round(U))}var c=B.number.groupingSeparator,L=0;if(b!=-1){if(G!=-1){L=G-b}else{L=Z.length-b}L--}if(L>0){var N=0,O="";Y=a.length;while(Y--){if(N!==0&&N%L===0){O=c+O}O=a.substr(Y,1)+O;N++}a=O}var e;if(G!=-1){e=Z.substr(0,G).replace(new RegExp("#|"+c,"g"),"").length}else{e=Z.replace(new RegExp("#|"+c,"g"),"").length}var K=a.length;for(Y=K;Y<e;Y++){a="0"+a}}P=a+M;return(X?"-":"")+P}}}})()}(jq))}}}();var rlJQuery_scrollStartStop=function(){return{__init__:function(){(function(){var A=jQuery.event.special,C="D"+(+new Date()),B="D"+(+new Date()+1);A.scrollstart={setup:function(){var E,D=function(H){var F=this,G=arguments;if(E){clearTimeout(E)}else{H.type="scrollstart";jQuery.event.handle.apply(F,G)}E=setTimeout(function(){E=null},A.scrollstop.latency)};jQuery(this).bind("scroll",D).data(C,D)},teardown:function(){jQuery(this).unbind("scroll",jQuery(this).data(C))}};A.scrollstop={latency:300,setup:function(){var E,D=function(H){var F=this,G=arguments;if(E){clearTimeout(E)}E=setTimeout(function(){E=null;H.type="scrollstop";jQuery.event.handle.apply(F,G)},A.scrollstop.latency)};jQuery(this).bind("scroll",D).data(B,D)},teardown:function(){jQuery(this).unbind("scroll",jQuery(this).data(B))}}})()}}}();rlListenerManager=function(){function B(E,G){if(E.length===0){return }var C=new Array(arguments).splice(2,arguments.length-2);for(var D=0;D<E.length;++D){var F=E[D][G];if(!F){continue}try{F.apply(this,C)}catch(H){console.error("Failed to execute listener: "+H);console.trace()}}}function A(){var I=[];var G=[];function E(J){B(I,J);B(G,J);G=[]}function F(J){I.push(J);return true}function D(J){G.push(J);return true}function H(J){for(var K=0;K<I.length;++K){var L=I[K];if(L!==J){continue}I.splice(K,1);return true}return false}function C(){return I.length>0||G.length>0}return{addListener:F,removeListener:H,addOneTimeListener:D,fireListeners:E,hasListeners:C}}return{createListenerManager:A,fireListeners:B}}();var rlLoginDataSet=function(){var F="login";var G="password";var L="confirm";var I=[F,G,L];var P=false;var K=null;var B=true;var Q="";var A={getListAreaId:function(){return Q},errorPlacements:function(){return{login:jq("#errorMsg_login"),password:jq("#errorMsg_password"),confirm:jq("#errorMsg_confirm")}},clickedElem:"undefined",formHeader:"undefined",listEditArea:{initFields:function(R){}},bindEvents:function(){bindEvents()},isValid:function(){return jq("#"+Q+"form").valid()}};function O(){var R={name:"loginDataSet",coreId:["account"],cachingDisabled:true,getFieldsNames:C,callbackLoadedData:D,callbackBeforeSaveData:N,callbackError:H,callbackClearData:E,getDiffs:J};rlAbstractForm.registerComponent(R)}function E(){jq.each(I,function(S,R){rlAbstractForm.setData(R,"",undefined,Q)})}function J(T,S){var R=S||{};var U=N(jq.extend({},R),T);var V=rlAbstractFormFieldSet.getDiffs(I,R,U);return V}function D(R,S){rlAbstractForm.setData(R,S.value,undefined,Q)}function C(){return I}function N(T,S,R){var U={};if(typeof T=="object"){U=T;console.log("Old data:");console.dir(T)}if(typeof I=="object"){jq.each(I,function(V,W){if(W!=="confirm"){U=rlAbstractForm.getData(W,U)}})}if(K){U.c2BRegistration=true}console.log("New data:");console.dir(U);return U}function H(S,R){if(typeof R!="undefined"&&typeof R.errorCodeId=="string"){if(R.errorCodeId.indexOf("UM_C2B_1004-")==0){switch(R.errorCodeId){case"UM_C2B_1004-044":break;default:S=G}}}return rlAbstractFormFieldSet.onError(S,R)}function M(){jq(window).bind(rlCoreServices.getExistedC2BLoginTriggerName(),function(S,R){P=true;jq(".userRegister_dither").show();jq(".userRegister_parsys .loginDataSet").css("z-index",jq(".userRegister_dither").css("z-index")+1);jq("#"+A.getListAreaId()+" .loginDataSet_password_part").hide();jq("#"+A.getListAreaId()+" .loginDataSet_c2b_user").show();rlInstantCheck.hideIconLayer("#"+A.getListAreaId()+" .componentSetFormInputArea :input[name=password]")});jq(window).bind(rlAbstractUserManagementForm.getLoginInputIsChangedTriggerName(),function(S,R){jq(".userRegister_dither").hide();jq("#"+A.getListAreaId()+" .loginDataSet_c2b_user").hide();jq("#"+A.getListAreaId()+" .loginDataSet_password_part").show();jq(".userRegister_parsys .loginDataSet").css("z-index","auto")})}return{__init__:function(){},__start__:function(){rlInstantCheck.prepareField(".loginDataSet .componentSetFormInputArea :input[name=password]");jq(".componentSetFormInputArea :input[name=login]").focusout(function(R){if(this.value&&this.value.length>1){rlCoreServices.checkC2BLogin({login:this.value})}});jq(".loginDataSet .componentSetFormInputArea :input[name=login]").keyup(function(R){if(P){P=false;jq(window).trigger(rlAbstractUserManagementForm.getLoginInputIsChangedTriggerName(),this.value)}});this.setEditMode(true);this.fillFieldValues()},registerComponent:function(){O()},showC2BLoginLayer:function(S,R){rlC2bInformationSet.c2bUserName=jq(".loginDataSet .componentSetFormInputArea :input[name=login]").val();rlGlassPaneLayerNext.openDialog({url:R,onOpen:function(){rlAbstractForm.destroyData()},onClose:function(){rlAbstractForm.destroyData()}})},initForm:function(V,U){console.log("loginDataSetComponent::initForm: "+V);var R=rlPage.isEditMode()||rlPage.isDesignMode();if(!R){Q=V;var T="#"+Q;rlAbstractFormFieldSet.initDefaultActions(A);var S=jq("#"+A.getListAreaId()+"form").closest("form");if(S){S.bmwValidate("addErrorPlacements",A.errorPlacements());S.bmwValidate("modifyValidationMessages",U)}else{console.warn("loginDataSetComponent::initForm: form not found")}jq.extend(jq.validator.messages,{required:function(){return jq(T+"RequiredFieldLabel").html()}});jq('.componentSetEditArea input:password[name="confirm"]').rules("add",{equalTo:'.componentSetEditArea input:password[name="password"]'});rlCoreServices.canUseImplicitLogin({canUse:function(W){jq(".loginDataSet").remove()},cannotUse:function(){M()}})}},setEditMode:function(R){B=R;console.log("Set Edit Mode = "+B);if(B){jq(".loginSetSection .readOnly").hide();jq(".loginSetSection .editMode").show()}else{jq(".loginSetSection .editMode").hide();jq(".loginSetSection .readOnly").show()}},getEditMode:function(){return B},fillFieldValues:function(){jq(".loginSetSection input[type='text']").each(function(R){jq(this).next(".readOnly").text(jq(this).val())});jq(".loginSetSection input[type='password']").each(function(R){jq(this).next(".readOnly").text(jq(this).val())})}}}();var rlLoginWithPolicyConsent=function(){var O='.policyTextblock div[data-usages*="telephone"] input';var K="#telephoneRequiredActive";var E=false;var H=undefined;var T=undefined;function P(){jq("#submitPolicyButton").click(Q);jq("#deleteLink").click(C);E=true;B()}function B(){if(E&&typeof H!=="undefined"){var V=rlMandator.getShortPolicyUrlFromLongUrl(H);jq.ajax({url:V,success:A,error:I})}}function A(V){T.determinePolicyVersion(V);T.renderPolicyEditMode(rlMandator.getShortPolicyUrlFromLongUrl(H),V,true);if(T.policyVersion===rlPolicyBaseFS.POLICY_VERSION_1){jq("#policyContentContainer").empty();rlLoginWithPolicyConsentLegacy.successLoadedPolicy(V)}if(T.policyVersion===rlPolicyBaseFS.POLICY_VERSION_2){jq('div[data-policyfield="consent"] input').change(function(){G()});jq(O).click(function(){if(jq(K).length>0){jq(K).hide()}});jq('.policyTextblock [data-policyfield="consent"]').each(function(Y,X){var W=jq(X);if(W){var Z=!(W.attr("data-noconsentreset")==="true");if(Z){W.find("input").each(function(b,a){jq(a).removeAttr("checked");jq(a).removeAttr("disabled")})}}})}jq('[data-usagegui="radiobuttons"] input').bind("change",function(){jq(this).parent().removeClass("policyError")});rlGlassPaneLayerNext.contentReady()}function I(V){rlErrorService.handleError({actor:rlErrorService.ACTOR_USER})}function G(){if(T.policyVersion===rlPolicyBaseFS.POLICY_VERSION_1){rlLoginWithPolicyConsentLegacy.consentClicked()}else{var V=jq('[data-policyfield="consent"]');var W=T.getUsageState(V)==="consented";L(W);if(W==true){jq("#accountDeleteHintDiv").hide()}else{jq("#accountDeleteHintDiv").show()}}}function Q(){if(T.policyVersion===rlPolicyBaseFS.POLICY_VERSION_1){rlLoginWithPolicyConsentLegacy.submitClicked()}else{if(T.policyVersion===rlPolicyBaseFS.POLICY_VERSION_2){T.clearErrorStates(jq("#policyContentContainer"));var V=T.getPolicyFromEditMode(jq("#policyContentContainer"));if(T.validateConsentAndUsages("telephoneUsage",jq("#policyContentContainer"))){return }var X=function(){rlLoginservice.loginWithPolicyConsent({cmxUrl:H,consentAccepted:true,consentedUsages:V.consentedUsages,revokedUsages:V.revokedUsages,onError:M,onLoggedIn:N})};for(var W=0;W<V.consentedUsages.length;W++){if(V.consentedUsages[W].usageId==="TelephoneUsage"&&jq(K).length>0){T.determinePolicyVersion(jq("#policyContentContainer"));if(T.getValidationRules({}).telephoneUsageRequiresPhoneNumber("dummy",jq("#policyContentContainer"))){jq(K).show();return }else{jq(K).hide()}}}X()}else{throw"Unsupported policy version: "+T.policyVersion}}}function N(V){setTimeout(function(){window.top.location.reload()},20)}function M(V){rlErrorService.handleError({actor:rlErrorService.ACTOR_USER})}function C(){rlRevokepolicy.setPolicyUrl(H);rlUserDialog.showRevokePolicy()}function S(V){top.location.reload()}function F(V){rlErrorService.handleError({actor:rlErrorService.ACTOR_USER})}function J(){if(T.policyVersion===rlPolicyBaseFS.POLICY_VERSION_1){return jq('.policyTextblock input[name$="Usage"]')}else{return jq("[data-policyfield='usage'] input")}}function L(V){var W=J();jq.each(W,function(X,Y){if(V==false){jq(Y).attr("disabled",true);jq(Y).next().attr("style","color:#ccc")}else{jq(Y).removeAttr("disabled");jq(Y).next().attr("style","")}})}function D(){var W=J();var V=[];jq.each(W,function(X,Y){if(!Y.checked){V.push({usageId:Y.name})}});return V}function U(V){H=V;B()}function R(){H=undefined}return{__init__:function(){},__start__:function(){},domLoaded:function(){T=rlPolicyBaseFS.createFS(jq("#policyContentContainer"),{});P()},reset:function(){R()},setPolicyUrl:function(V){U(V);rlLoginWithPolicyConsentLegacy.setPolicyUrl(V)}}}();var rlLoginWithPolicyConsentLegacy=function(){var P='.policyTextblock input[name="TelephoneUsage"]';var K="#telephoneRequiredActive";var D=false;var H=undefined;var V="optOutUsage";function Q(){jq("#submitPolicyButton").click(E);jq("#deleteLink").click(B);D=true;A()}function A(){if(D&&typeof H!=="undefined"){var Y=rlMandator.getShortPolicyUrlFromLongUrl(H);jq.ajax({url:Y,success:R,error:I})}}function R(Z){var Y=jq("<div/>");Y.get()[0].innerHTML=Z;jq("#policyContentContainer").append(jq(Y).find(".policyTextblock"));jq(window).attr("height",document.body.scrollHeight+"px");jq('.policyTextblock input[name="consent"]').change(function(){G()});jq(P).click(function(){jq(K).hide()});jq('.policyTextblock input[name="consent"]').each(function(c,b){var a=jq(b);if(a&&!a.hasClass("noConsentReset")){a.removeAttr("checked");a.removeAttr("disabled")}})}function I(Y){rlErrorService.handleError({actor:rlErrorService.ACTOR_USER})}function G(){var Y=jq('.policyTextblock input[name="consent"]').is(":checked");L(Y);if(Y==true){jq("#accountDeleteHintDiv").hide();jq('.policyTextblock input[name="consent"]').parent().removeClass("redText")}else{jq("#accountDeleteHintDiv").show();jq('.policyTextblock input[name="consent"]').parent().addClass("redText")}}function T(Y){rlCoreServices.loadUserData({success:function(Z){if(!Z.profile.hasPhoneNumber){if(jq(P).is(":checked")){jq(K).show();return }else{jq(K).hide()}}else{if(Y){Y()}}},error:function(Z){throw"Cannot load user data: "+Z}})}function E(){var Z=C();var Y=X();var c=jq('.policyTextblock input[name="consent"]').is(":checked");if(c==false){G();return }var d=function(){rlLoginservice.loginWithPolicyConsent({cmxUrl:H,consentAccepted:c,consentedUsages:Y,revokedUsages:Z,onError:M,onLoggedIn:O})};var b=jq(P).is(":checked");var a=jq(K);if(a.length>0&&b){T(d)}else{d()}}function N(Y){var a=J();var Z=[];jq.each(a,function(b,d){var c=jq(d).hasClass(V);var e=d.checked&&!c||!d.checked&&c;if(Y&&e||!Y&&!e){var f={usageId:d.name};Z.push(f)}});return Z}function O(Y){setTimeout(function(){window.top.location.reload()},20)}function M(Y){rlErrorService.handleError({actor:rlErrorService.ACTOR_USER})}function B(){rlRevokepolicy.setPolicyUrl(H);rlUserDialog.showRevokePolicy()}function U(Y){top.location.reload()}function F(Y){rlErrorService.handleError({actor:rlErrorService.ACTOR_USER})}function J(){return jq('.policyTextblock input[name$="Usage"]')}function L(Y){var Z=J();jq.each(Z,function(a,b){if(Y==false){jq(b).attr("disabled",true);jq(b).next().attr("style","color:#ccc")}else{jq(b).removeAttr("disabled");jq(b).next().attr("style","")}})}function X(){var Z=J();var Y=[];jq.each(Z,function(a,b){if(b.checked){Y.push({usageId:b.name})}});return Y}function C(){var Z=J();var Y=[];jq.each(Z,function(a,b){if(!b.checked){Y.push({usageId:b.name})}});return Y}function W(Y){H=Y;A()}function S(){H=undefined}return{__init__:function(){},__start__:function(){},createInstance:function(){return rlLoginWithPolicyConsentLegacy},domLoaded:function(){Q()},reset:function(){S()},setPolicyUrl:function(Y){W(Y)},successLoadedPolicy:function(Y){R(Y)},submitClicked:function(){E()}}}();var rlLoginaccountstate=function(){var I="[rlLoginaccountstate] ";var E="user";var d="preOwnedVehicle";var K=false;var U={};var N=undefined;var g=[];var Y=null;var S=[];var e=700;var m=rlBrowser.getInternetExplorerVersion();if(navigator.userAgent.match("MSIE")&&m<9){e=0}function f(p,o){console.log(I+"Scoring: Received scoring data for request: "+p);if(p===E){var r="n/a";if(o.lastLogin){var n=o.lastLogin.split("-");var q=new Date(n[0],n[1]-1,n[2].substring(0,2));r=rlFormatter.formatDate(q)}jq("#lastLogin").text(r)}U[p]=o;g=jq.grep(g,function(s){console.log(I+"Scoring: Scoring calculation no longer blocked by: "+p);return s!==p});if(g.length===0){c()}}function H(){g.push(d);g.push(E);W();O();Y.getUserData(function(n){f(E,n)},function(){f(E,{})})}function W(){function n(){jq("#ownedBmws").text("n/a");f(d,{count:0})}rlNccServices.getPreOwnedVehicleCount({success:function(o){jq("#ownedBmws").text(o.bmws);f(d,{count:(parseInt(o.bmws)+parseInt(o.others))})},error:n,fail:n})}function O(){function n(){jq("#configuredBmws").text("n/a");console.log(I+"Error reading config count")}rlNccServices.getConfigCount({success:function(p){var o=parseInt(p);if(!isNaN(o)&&o>0){jq("#configuredBmws").text(o)}else{jq("#configuredBmws").text("0")}},error:n,fail:n})}function D(n){return n!=null&&typeof n!="undefined"&&n!==""}function Z(o){var n=o!==null&&typeof o==="object";return n}function c(){console.groupCollapsed(I+"Calculate scoring");var o=0;var n=0;S=[];jq(N).each(function(r,s){var p=parseInt(s.score);var q=!isNaN(p)&&p>0;if(q){o+=p;if(s.type==="optionalField"){n+=B(s,S)}else{if(s.key==="address"){n+=b(s,S)}else{if(s.key==="lastname"||s.key==="firstname"){n+=P(s,S)}else{if(s.key==="preferredCommunication"){n+=M(s,S)}else{if(s.key==="communications"){n+=k(s,S)}else{if(s.key==="hobbies"||s.key==="technologyInterests"||s.key==="vehicleInterests"){n+=F(s,S)}else{if(s.key==="plannedPurchase"){n+=j(s,S)}else{if(a(s.key)!=null){n+=p}else{if(s.key==="vehicle"){n+=R(s,S)}else{T(s)}}}}}}}}}console.log(I+"Scoring: "+s.key+" : "+p)}});Q(S);console.log(I+"Scoring: Max = "+o);console.log(I+"Scoring: Reached = "+n);G(o,n);console.groupEnd(I+"Calculate scoring")}function a(n){return h("profile."+n)}function h(n){return C("user."+n)}function C(q){var p=null;var o=U;var n=q.split(".");while(n.length>0){var r=n.shift();if(typeof o[r]=="undefined"){break}o=o[r];if(n.length===0&&D(o)){p=o}}return p}function P(o,q){var n="";if(o.key.indexOf("first")==0){n="firstName"}else{if(o.key.indexOf("last")==0){n="lastName"}else{n=o.key}}var p=h(n);if(p!=null&&D(p)){return parseInt(o.score)}else{T(o);return 0}}function R(o,p){var n;if(U&&U[d]&&U[d].count){n=U[d].count}if(n&&o.score){return parseInt(o.score)}else{T(o);return 0}}function F(n,p){var o=h(n.key);if(o!=null&&D(o)){return parseInt(n.score)}else{T(n);return 0}}function B(n,p){var o=C(n.key);if(o!=null&&D(o.value)){return parseInt(n.score)}else{T(n);return 0}}function b(p,q){var n=0;var o=a("addresses");if(Z(o)){n=parseInt(p.score)}else{T(p)}return n}function k(o,q){var n=0;var p=h("profile");if(Z(p)){if(Z(p.phone)||Z(p.businessPhone)||Z(p.mobile)||Z(p.businessMobile)||Z(p.email)||Z(p.pager)||Z(p.fax)){n+=parseInt(o.score)}else{T(o)}}else{T(o)}return n}function M(n,p){var o=a("preferredCommunication");if(o!=null&&D(o)){return parseInt(n.score)}else{T(n);return 0}}function j(n,p){var o=a("plannedPurchase");if(o!=null&&D(o)){return parseInt(n.score)}else{T(n);return 0}}function Q(o){var n=function(){var t=rlContextLayer.getContentLayer("#scoringIcon");if(t){var p;if(o.length>0){var q=jq(".scoringIncompleteText").text();p=jq('<div class="scoringInformation"></div>');p.append('<span class="fontBold">'+q+"</span>");var s=jq('<ul class="incompleteScoringList"></ul>');jq.each(o,function(u,v){s.append("<li>"+v+"</li>")});p.append(s);jq(".scoringInfoIconText").html(p)}else{var r=jq(".scoringCompleteText").text();p=jq('<div class="scoringInformation"></div>').text(r);jq(".scoringInfoIconText").html(p)}t.html(p);jq(t).find("li").css("display","list-item");jq("#scoringIcon").find(".clickableIconInfoSmall").click(function(){window.setTimeout(function(){jq("#scoringIcon").find("ul").hide().show()},10)})}else{setTimeout(n,10)}};n()}function G(q,n){var o=0;if(q>0&&n>0){if(n>=q){o=100}else{o=Math.floor(n*100/q)}}var p=Math.round(jq("#scoringBox").width()*(o/100),0);jq("#potentialUse").text(o+"%");jq("#scoringProgressState").css("width",p+"px");A()}function T(n){S.push(n.label||n.key)}function J(){console.log(I+"User is not logged in");jq("#accStateLoad").hide();rlLoginbox.show();jq("#accStateLogin").show();jq("#accStateState").hide();jq("#accStateSubHeadline").hide();A()}function L(){jq("#accStateLoad").show();rlLoginbox.show();jq("#accStateLogin").show();jq("#accStateState").show();jq("#accStateSubHeadline").show()}function V(){console.log(I+"User is logged in");jq("#accStateLoad").hide();jq("#accStateLogin").hide();jq("#accStateState").show();var n=jq("#accStateSubHeadline").find("h2").text().replace(/\w|\r|\n/g,"");if(jq("#accStateSubHeadline").parents(".homeLayer").length==0){if(n.length>0){jq("#accStateSubHeadline").show()}else{jq("#accStateSubHeadline").hide()}}else{jq("#accStateSubHeadline").hide()}H()}function X(){jq(window).bind(rlUserFormDS.getDataChangedTriggerName(),function(o,n){if(n){if(U[E]){W();f(E,n)}}});rlCoreServices.isLoggedIn({loggedOut:function(){J();K=true},loggedIn:function(){V();K=true}})}function A(){jq(".loginaccountstatewrapper").animate({opacity:1},e,function(){if(navigator.userAgent.match("MSIE")&&m<9){jq(".loginaccountstatewrapper").css("filter","none")}})}return{__init__:function(){Y=rlUserFormDS.createDS({meta:false,data:true});jq(window).bind(rlNccServices.EVENT_CONFIG_WASDELETED,function(){O()});jq(window).bind(rlNccServices.EVENT_POV_WASCREATED,function(){W()});jq(window).bind(rlNccServices.EVENT_POV_WASDELETED,function(){W()});jq(window).bind("wcmmode_changed",function(n,o){if(o==="edit"){L()}else{J()}})},__start__:function(){N=jq.parseJSON(jq("#scoringData").text());X();if(rlPage.isEditMode()){L()}if(rlPage.isPreviewMode()&&!K){J()}},getTriggerName:function(){return"loginaccountstate"}}}();var rlMagnifierIcon=function(){var E=30;function C(){return jq("body > .bigImageLayer")}function G(){return jq("body > .bigImageLayer img")}function B(){var H=C();var I=C();var K=I.data("originalWidth");var J=I.data("originalHeight");if(K===undefined){K=H.width();J=H.height();console.log("Original size of image is "+K+"/"+J);I.data("originalWidth",K);I.data("originalHeight",J)}return{w:K,h:J}}function F(){var L=C();if(L.length===0){return }var H=jq(window).width();var J=jq(window).height();var M=B();var P=(H-E*2)/M.w;var I=(J-E*2)/M.h;var O=null;var K=null;if(P<1||I<1){if(P<I){O=P*M.w;K=P*M.h}else{O=I*M.w;K=I*M.h}O=O+"px";K=K+"px"}var N=G();N.css("width",O);N.css("height",K);L.css("left",(H-(L.width()+E))/2+"px");L.css("top",(J-(L.height()+E))/2+"px")}function D(){greyLayer.greyLayer_hide();C().remove()}function A(){jq(".bigImageLayer .spriteIconCloseBig").click(D);jq("#grey_layer").one("click",D)}return{__init__:function(){jq(window).resize(function(){F()})},__start__:function(){jq(".magnifierIconBlue").click(function(){var H=jq(this).next(".bigImageLayer").find("img");rlGlassPaneLayerNext.openDialog({content:jq(H),flexible:true,flexibleSelector:"img"})})}}}();var rlMainNav=function(){var J=0;var C=40;var H=null;var K=null;var G=null;var I=false;function F(){return(/MSIE (7.\d+);/.test(navigator.userAgent))}function D(){return(/MSIE (8.\d+);/.test(navigator.userAgent))}function L(){I=false;var M=jq(".navigationSecondLine");M.hide();B(I);jq("#navigationTopLogout",M).hide();jq("#navigationTopLogin",M).show();jq(".navigationWelcome",M).show();M.show()}function E(){I=true;var M=jq(".navigationSecondLine");M.hide();jq("#navigationTopLogout",M).show();jq("#navigationTopLogin",M).hide();B(I)}function B(N){var M=jq(".navigationSecondLine");if(N){rlCoreServices.loadUserData({success:function(O){var P=jq.trim(rlFormatter.formatName(O,{useSalutation:true}));jq("#navigationUsernameGuest",M).hide();jq("#navigationUsername",M).text(", "+P).show();jq(".navigationWelcome",M).show();M.show()}})}else{jq("#navigationUsername",M).hide();jq("#navigationUsernameGuest",M).show();M.show()}}function A(){var N=function(P,Q){jq("#"+Q).html(P)};var M={type:"GET",containerId:"",success:function(P){N(P,M.containerId)},error:function(Q,R,P){console.log(Q.status+"\n\n"+R+"\n\n"+P)}};M.url="/vc/version.txt";M.containerId="deployVersionNCC";rlCrossSubDomainAjax.call(M);var O={type:"GET",containerId:"",success:function(P){N(P,O.containerId)},error:function(Q,R,P){console.log(Q.status+"\n\n"+R+"\n\n"+P)}};O.url=rlPage.getNextCoreUrl()+"/core-version-info/version.txt";O.containerId="deployVersionCORE";rlCrossSubDomainAjax.call(O)}return{__start__:function(){try{var M=window.location.pathname.replace(".html","");var O=window.location.href.substr(window.location.href.indexOf("//")).replace(".html","");console.info("Current page path: "+M);jq("#mainNavigation_navTag .fastlaneNavItems>li>a,  #mainNavigation_navTag .mainNav>ul>li>a").each(function(Q,R){try{var P=jq(R);var S=P.attr("href").replace(".html","");if(S.length>0&&(M.indexOf(S)>=0||O.indexOf(S)>=0)){console.info("Menu to highlight: "+P.text());P.addClass("activeColorSeriesTopics")}}catch(T){}})}catch(N){}},__init__:function(){this.__start__();var M=jq("#mainNavigation_navTag");M.find(".mainNavProductItemsSeries").hover(function(){jq(this).children(".mainNavProductItemsLayer").show();if(jq(this).find(".vehicleEntries .vehicleEntry").length>2){jq(this).find(".mainNavProductItemsLayerContainer").css({width:"922px"})}else{jq(this).find(".mainNavProductItemsLayerContainer").css({width:"680px"})}jq(this).find(".shadowIeAlternative").width(jq(this).children(".mainNavProductItemsLayer").width());jq(this).find(".shadowIeAlternative").height(jq(this).children(".mainNavProductItemsLayer").height());jq(this).find(".shadowIeAlternative").show();jq(this).children(".mainNavProductItemsSeriesLinks").addClass("activeColor")},function(){jq(this).children(".mainNavProductItemsLayer").hide();jq(this).find(".shadowIeAlternative").hide();jq(this).children(".mainNavProductItemsSeriesLinks").removeClass("activeColor")});M.find(".mainNavProductItemsSeriesLinks,  .mainNavTopicItemsLinks, .mainNavTopicsMoreLinks").click(function(){return false});if(F()||D()){jq(".mainNavProductItemsLayerContainer").removeClass("shadow");jq(".mainNavProductItemsLayerContainer").addClass("shadowIefix");jq(".mainNavProductItemsLayer").append('<div class="shadow shadowIeAlternative"  style="z-index: -1; position: absolute; left: -2px; top: -3px;"></div>')}if(F()||D()){jq(".mainNavTopicItemsLevel2Container").removeClass("shadow");jq(".mainNavTopicItemsLevel2Container").addClass("shadowIefix");jq(".mainNavTopicItemsLevel3Container").removeClass("shadow");jq(".mainNavTopicItemsLevel3Container").addClass("shadowIefix");jq(".mainNavTopicItemsLevel2").append('<div class="shadow shadowIeAlternative"  style="z-index: -1; width: 253px; position: absolute; left: 0;  top:0;"></div>');jq(".mainNavTopicItemsLevel3").append('<div class="shadow shadowIeAlternative"  style="z-index: -1; width: 253px; position: absolute; left: 0;  top:0;"></div>')}M.find(".mainNavTopicItems").hover(function(){jq(this).parent().children(".mainNavTopicItems:not(:hover)  .mainNavTopicItemsLevel2").hide();if(F()||D()){jq(this).children(".mainNavTopicItemsLevel2").show();jq(this).children(".shadowIeAlternative").show();jq(".mainNavTopicItemsLevel2").removeAttr("filter");jq(this).find(".shadowIeAlternative").height(jq(this).find(".shadowIefix").height())}else{jq(this).children(".mainNavTopicItemsLevel2").stop(true,true).delay(J).fadeTo(0,1);jq(this).children(".shadowIeAlternative").fadeTo(0,1)}jq(this).children(".mainNavTopicItemsLinks").addClass("activeColor");H=jq(this).children(".mainNavTopicItemsLevel2").offset().left;K=jq(".idModule").offset().left;G=K-H-jq(this).children(".mainNavTopicItemsLevel2Container").outerWidth()-C;if(G<=0){jq(this).children(".mainNavTopicItemsLevel2").css({left:"auto",right:"-9px"})}},function(){jq(this).children(".mainNavTopicItemsLevel2").hide();jq(this).children(".shadowIeAlternative").hide();jq(this).children(".mainNavTopicItemsLinks").stop(true,true).removeClass("activeColor");jq(this).children(".mainNavTopicItemsLevel2").css({left:null,right:null})});M.find(".mainNavTopicItemsLevel2  .mainNavTopicsMore").hover(function(){if(F()||D()){jq(this).find(".shadowIeAlternative").width(jq(this).children(".mainNavTopicItemsLevel3").width());jq(this).find(".shadowIeAlternative").height(jq(this).children(".mainNavTopicItemsLevel3").height())}jq(this).children(".mainNavTopicItemsLevel3").delay(J).show();jq(this).children("a").addClass("link13pxActive").removeClass("link13px")},function(){jq(this).children(".mainNavTopicItemsLevel3").hide();jq(this).children("a").stop(true,true).addClass("link13px").removeClass("link13pxActive")});rlCoreServices.isLoggedIn({loggedIn:E,loggedOut:L});M.find(".navigationTopLoginLogoutLink").click(function(N){N.preventDefault();I?rlCoreServices.logout():rlUserDialog.showLoginDialog()})},setHighlightedSeries:function(O){var M="activeColorSeriesTopics";var N=null;jq(".mainNavProductItemsSeriesLinks").each(function(Q,R){var P=jq(R);if(P.attr("data-series")===O){P.addClass(M);N=P.attr("data-idmodulepath");if(N!==null){jq(".idModuleLayerRightAlign:not(.idModulePrint)").attr("src",N)}}else{P.removeClass(M)}})},highlightFastlaneNav:function(N){var M="activeColorSeriesTopics";jq(".fastlaneNavItems a").removeClass(M);jq("."+N).addClass(M)},getCurrentDeployedVersions:function(){A()}}}();var rlModelTreeController=function(){function A(Z){var J=CoreFormsBase.inheritanceFrom(CoreFormsBase.createBaseType());var M=J.parent;J.typeName="rlModelTreeController";var k=null;var T=null;var v=null;var p=null;var S=null;var F=null;var G=null;var r=Z.pleaseChooseOptionLabel||"";var C=Z.pleaseChooseBrandOptionLabel||"";var N=Z.pleaseChooseSeriesOptionLabel||"";var t=Z.pleaseChooseModelOptionLabel||"";var L=Z.pleaseChooseModelYearOptionLabel||"";var s=Z.beforeBrandsLoaded||function(){};var o=Z.beforeSeriesLoaded||function(){};var u=Z.beforeModelsLoaded||function(){};var X=Z.beforeModelYearsLoaded||function(){};var b=Z.afterBrandsLoaded||function(){};var a=Z.afterSeriesLoaded||function(){};var c=Z.afterModelsLoaded||function(){};var O=Z.afterModelYearsLoaded||function(){};var j=Z.afterBrandSelected||function(){};var Y=Z.afterSeriesSelected||function(){};var g=Z.afterModelSelected||function(){};var m=Z.beforeModelYearSelected||function(){};var V=Z.afterModelYearSelected||function(){};var d=function(x){rlErrorService.handleError(x)};var R=function(x){p=x.brandsDropdown;S=x.seriesDropdown;F=x.modelsDropdown;G=x.modelYearsDropdown;p.change(W);S.change(f);F.change(q);G.change(D)};var E=function(){p.unbind("change",W);S.unbind("change",f);F.unbind("change",q);G.unbind("change",D);p=null;S=null;F=null;G=null};function Q(){return p.val()}function w(){return S.val()}function n(){return G.val()}var I=function(){U(S,true);U(F,true);U(G,true)};var B=function(){U(p,true);I()};var e=function(){B();s();if(rlPage.isPreviewMode()||rlPage.isDesignMode()||rlPage.isEditMode()){rlNccServicesMock.modelTreeListBrands({success:function(x){k=x;P(p,x);b({brandList:x})}})}else{rlNccServices.modelTreeListBrands({success:function(x){k=x;P(p,x);b({brandList:x})},error:function(x){d({actor:rlErrorService.ACTOR_SYSTEM,requestStatus:x})},fail:function(x){d({actor:rlErrorService.ACTOR_SYSTEM,requestStatus:x})}})}};var K=function(){var x=Q();I();o({brandKey:x});rlNccServices.modelTreeListSeries({brandKey:x,success:function(y){if(x!==Q()){return }T=y;I();P(S,y);a({brandKey:x,seriesList:y});jq(document).trigger("vinToolAfterSeriesLoaded")},error:function(){d({actor:rlErrorService.ACTOR_USER})},fail:function(){d({actor:rlErrorService.ACTOR_USER})}})};var H=function(x){return !!x};var h=function(){var AA=Q();var x=w();var y=n();U(F,true);u(AA,x);if(!AA){return }if(!x){return }if(H(y)===false){U(G,true);X(AA,x)}var z=function(AD){var AB=[];for(var AC=0;AC<AD.length;AC++){AB.push({code:AD[AC],name:AD[AC]})}return AB};rlNccServices.modelTreeListModels({brandKey:AA,seriesKey:x,filterByModelYear:y,success:function(AC){if(AA!==Q()||x!==w()||y!==n()){return }var AB=AC.models,AD=AC.modelYears;v=AB;if(H(y)===false){AD=z(AD);P(G,AD);O({brandKey:AA,seriesKey:x,modelYears:AD})}P(F,AB);c({brandKey:AA,seriesKey:x,modelList:AB});jq(document).trigger("vinToolAfterModelsLoaded")},error:function(){d({actor:rlErrorService.ACTOR_USER})},fail:function(){d({actor:rlErrorService.ACTOR_USER})}})};var W=function(){var x=p.find("option:selected").index()-1;if(x>=0){K();if(k!=null){j(k[x])}}else{I();j(null)}};var f=function(){var x=S.find("option:selected").index()-1;if(x>=0){U(G,true);h();if(T!=null){Y(T[x])}}else{U(G,true);U(F,true);Y(null)}};var D=function(){var y=G.find("option:selected").index()-1;var x=null;if(y>=0){x=G.val()}m(x);h();V(x)};var q=function(){var x=F.find("option:selected").index()-1;if(x>=0){g(v[x])}else{g(null)}};var U=function(z,x){var y=r;if(z==p){y=C||y}else{if(z==S){y=N||y}else{if(z==F){y=t||y}else{if(z==G){y=L||y}}}}z.empty();if(z.parents(".fieldSetEditAreaRow").find("select").length==1){z.parents(".fieldSetEditAreaRow").removeClass("fieldSetIsShowingValidationMessage");z.parents(".fieldSetEditAreaRow").removeClass("fieldSetHasError");z.parents(".fieldSetEditAreaRow").removeClass("fieldSetHasWarning")}z.prop("disabled",true);if(x){z.append("<option value=''>"+y+"</option>")}};var P=function(x,y){jq.each(y,function(AA,AB){if(jq.browser&&jq.browser.msie&&jq.browser.msie===true){x.each(function(AC,AE){var AD=document.createElement("option");AD.value=AB.code;AD.text=AB.name;AD.title=AB.name;AE.add(AD);if(AB.externalCode){jq(AD).attr("data-external-value",AB.externalCode)}})}else{var z=jq("<option>").val(AB.code).attr("title",AB.name).text(AB.name);if(AB.externalCode){z.attr("data-external-value",AB.externalCode)}x.append(z)}});x.prop("disabled",false)};J.loadBrands=function(){e()};J.afterBrandsLoaded=function(){b()};J.setErrorHandler=function(x){d=x};J.selectFistSeriesOption=function(){S.find("option").first().attr("selected","selected")};R(Z);return J}return{__init__:function(){},buildController:function(B){return A(B)}}}();var rlMultiFileUploadFS=(function(){function B(D){var E=D.find(".numberOfMaxDocuments").attr("data-numberOfMaxDocuments");var C=D.find(".addDoc");C.click(function(){var K=D.find("#rows");var H=K.children();if(E&&H.length>=E){return }var J=H.last();var G=parseInt(J.attr("id").substring(3))+1;var F=D.find("#rowhidden").clone();F.attr("id","row"+G);var I=jq("<span>").append('<a href="javascript:void(0)">remove</a>');F.append(I);K.append(F);F.css("visibility","visible");I.click(function(){F.remove();C.show()});H=K.children();if(E&&H.length>=E){C.hide()}})}function A(C,F){var D=CoreFormsBase.inheritanceFrom(rlFormFieldSet.createFS(C,F));D.typeName="rlMultiFileUploadFS";var E=D.getFieldsetProperties();B(C);D.supportsInputCache=function(){return(E.supportinputcache=="true")};return D}return{__init__:function(){},__start__:function(){},createFS:function(C,D){return A(C,D)}}})();var rlMultiStepLineFS=function(){function A(B,G){var C=CoreFormsBase.inheritanceFrom(rlFormFieldSet.createFS(B,G));var F=C.parent;C.typeName="rlMultiStepLineFS";C.init=function(){F.init()};function D(){if(B.parents("form").find(".multiStepLineFS").length>4){B.find("div.tooManyMultiStepLineFSError").show();B.parent("div.multiStepLineFS").addClass("multiStepLineFSError")}}function E(){var I=B.parents("form").find("fieldset");if(I.first().parent(".multiStepLineFS").length<1){var H=I.parent(".multiStepLineFS").first();H.addClass("multiStepLineFSError");H.find("div.tooManyMultiStepLineFSError").hide();H.find("div.mustBeFirstFSError").show()}}C.getMailSummary=function(H){return H};C.getFormSummary=function(H,I){H.push({type:I.JUMP_TO_STEP,label:B.parents(".wizardStep").attr("data-steptitle"),stepIndex:B.parents(".wizardStep").attr("data-stepindex")});return H};D();E();return C}return{__init__:function(){},__start__:function(){},createFS:function(B,C){return A(B,C)}}}();var rlMyBmwVehicleForm=function(){function A(E,G){var B=CoreFormsBase.inheritanceFrom(rlFormBase.create(E,G));var D=B.parent;B.typeName="rlMyBmwVehicleForm";function C(){if(!rlPage.isEditMode()&&!rlPage.isDesignMode()){E.find(".formSubmitButton").click(H)}E.find("#cancelBtn").click(function(){rlGlassPaneLayerNext&&rlGlassPaneLayerNext.isOpen()&&rlGlassPaneLayerNext.closeDialog()})}function F(K){var J;var I=function(L){return L||undefined};return{brand:I(K.vehicle.brand),series:I(K.vehicle.series),model:I(K.vehicle.model),vin:I(K.vehicle.vin),initialRegistration:I(K.vehicle.initialRegistration),annualUse:I(K.vehicle.annualUse),mileage:I(K.vehicle.mileage),usage:I(K.vehicle.usage),vehicleType:I(K.vehicle.vehicleType),freeTextNote:I(K.vehicle.freeTextNote),modelCodeVg:I(K.vehicle.modelCodeVg)}}function H(){var I=function(){rlNccServices.createPreOwnedVehicle({vehicle:F(B.getEditedData()),success:function(K){var J=rlEventTracker.create();if(K.vin){J.trackCustomEvent("mybmwMyVehicleAddByVIN","mybmwAction/myvehicles")}else{J.trackCustomEvent("mybmwMyVehicleAddByModelSelection","mybmwAction/myvehicles")}B.hideDitherLayer();if(typeof rlMyVehiclesController==="undefined"||window.location.href.indexOf("myvehicles.html")===-1){rlUserDialog&&rlUserDialog.redirectToMyBmwVehiclesPage(K.vehicleId)}rlGlassPaneLayerNext&&rlGlassPaneLayerNext.isOpen()&&rlGlassPaneLayerNext.closeDialog()},fail:function(J){B.hideDitherLayer();B.showBackendMessages(rlNccConverter.translateValidationMessagesFromResponse(J,undefined,"vehicle."))},error:function(){B.hideDitherLayer();rlErrorService.handleError({actor:rlErrorService.ACTOR_SYSTEM})}})};B.showDitherLayer();B.waitForLiveValidation(function(){if(B.validate()){I()}else{B.hideDitherLayer()}})}C();return B}return{__init__:function(){},__start__:function(){},create:function(B,C){return A(B,C)}}}();var rlMyConfigOverview=function(){var L="/etc/designs/bmwnext/apps/bmwnext/mybmw/myconfiguration/static/parComponents/themes/myconfigurations/overview/";var T=false;var H;var P;var E=undefined;var N="EVENT_NEW_CONFIG_LOADED";function F(V){jq("#carpicture").attr("src",V.attr("data-carimg"))}function K(V){jq("#iconback").attr("src",L+"icon_car_back_lo.gif");jq("#iconfront").attr("src",L+"icon_car_front_lo.gif");jq("#iconinterior").attr("src",L+"icon_car_interior_lo.gif");if(V==undefined){return }var W=V.attr("src").replace("_lo.gif",".gif");V.attr("src",W)}function C(V){if(V==undefined||T){return false}if(V.attr("src").indexOf("_lo.gif")<0){return false}T=true;K(V);jq("#car").hide("slide",{direction:"left"},function(){F(V)});return false}function M(){jq("#toggleback").click(function(){return C(jq("#iconback"))});jq("#togglefront").click(function(){return C(jq("#iconfront"))});jq("#toggleinterior").click(function(){return C(jq("#iconinterior"))})}function I(){jq("<img />").attr("src",jq("#iconfront").attr("data-carimg"));jq("<img />").attr("src",jq("#iconback").attr("data-carimg"));jq("<img />").attr("src",jq("#iconinterior").attr("data-carimg"))}function S(){jq("#setAsPrimaryLink").click(function(){B()});H=jq("#lastChangedDateTemplate").val();P="dd.mm.yy";jq(window).bind("config_data_changed",R);M();Q();jq("#carpicture").load(function(){jq("#car").show("slide",{direction:"right"},1000);T=false})}function Q(){}function U(){var V=parseInt(rlNccServices.getNumberOfConfigs());if(V>1){jq("#configSelectorButton").css("display","block")}else{jq("#configSelectorButton").css("display","none")}jq(".configCount").each(function(){jq(this).html(V)})}function R(){var V=jq.datepicker.formatDate(P,new Date());jq(".lastChangeTime").html(V)}function D(V){if(V==true){jq("#setAsPrimaryLink").hide();jq("#infoSetAsPrimary").hide();jq("#myconfigPrimaryFlag").show()}else{jq("#setAsPrimaryLink").show();jq("#infoSetAsPrimary").show();jq("#myconfigPrimaryFlag").hide()}}function B(){rlNccServices.setPrimaryConfig({configId:E,success:function(V){if(V.STATUS=="OK"){D(true);R()}else{alert("Could not set configuration as primary due to:\n\n"+V.MESSAGE)}}})}function A(V){rlNccServices.getConfig(V,function(W){O(W.singleConfig);E=W.singleConfig.configId;J();jq("body").trigger(N,E)})}function J(){var V=jq("meta[name=bmwnext-teaser-parameter-configId]");V=V.length?V:jq('<meta name="bmwnext-teaser-parameter-configId" />').appendTo("head");V.attr("content",E)}function O(a){for(property in a){if(property=="configUrls"){var c=a.configUrls;for(configUrl in c){jq("."+configUrl).each(function(){jq(this).attr("href",c[configUrl])})}}else{if(property=="features"){}else{if(property=="pakets"){var b=a.pakets;var X=jq("#pakets");X.empty();for(var Y=0;Y<b.length;Y++){var V=jq(document.createElement("div"));V.addClass("myconfigSnapshotSubheadline");V.text(b[Y]);X.append(V)}}else{if(property=="accessories"){var d=a.accessories;var Z=jq("#accessories");Z.empty();for(var Y=0;Y<d.length;Y++){var V=jq(document.createElement("div"));V.addClass("myconfigSnapshotTextHighlighted");V.text(d[Y]);Z.append(V)}}else{if(property=="imageUrls"){var W=a.imageUrls;for(imageUrl in W){jq("."+imageUrl).each(function(){jq(this).attr("data-carimg",W[imageUrl])})}}else{jq("."+property).each(function(){jq(this).html(a[property])})}}}}}}D(a.primary);I();K(undefined);C(jq("#iconfront"))}function G(){return E}return{__init__:function(){jq("#configSelectorButton").click(rlUserDialog.showConfigSelector)},__start__:function(){},setConfig:function(V){A(V)},addConfigLoadListener:function(V){jq("body").bind(N,V)},getCurrentConfigId:function(){return G()},domLoaded:function(){S();var V=rlJQuery_queryParams.getQueryParam("configId");if(V==="undefined"||V==""){A(undefined)}else{A(V)}}}}();var rlMyConfigSave=function(){var S,Q,b,G,P,F,L,Z;var R="/vc/api/v1/me/currentConfig/_{mandatorContext}";var I;var D;var M;var d="/mybmw/myconfigurations.html";var Y;var K=true;function c(e,h){if(jq.trim(h)==""){O("102-018",G);return }J();var g=Y.content.best;if(Y.content.first==="true"){g="true"}else{g=jq("#isPrimaryCheckbox").is(":checked").toString()}var f={userNote:h,saveAsNew:e.toString(),best:g};rlNccServices.saveCurrentConfig({data:f,success:function(k){var j=undefined;if(k.status.responseStatus==="OK"){if(Y.content.exists==="true"&&e){j=rlNccServices.getNccEntryUrlForConfig(k.content.configId)}}a(k,Y.content.name,h,Y.content.imageURL,D,j)},error:function(){rlErrorService.handleError({actor:rlErrorService.ACTOR_USER})}})}function a(j,r,h,p,g,k){if(j.status.responseStatus==="OK"){N();C();rlMyconfigsaveconfirm.showDialog(r,h,p,g+"#configId="+j.content.configId,k);var e=jq("#sendConfigEmailCheckbox").is(":checked");if(jq("#configUrlId").html()&&e){rlEventTracker.create().trackCustomEvent("nccEmailAfterConfigSaved","nccAction");rlCoreServices.sendConfigByEmail({data:{configUrl:jq("#configUrlId").html(),nccUrl:document.location.href,mfUrl:jq("#navigationTopModelFinder").attr("href"),configName:h}})}if(typeof M!=="undefined"&&M&&jq("#configUrlId").html()){var f=jq("#requestForOfferCheckbox").is(":checked");if(f){if(window.rlCoreServices&&window.rlCoreServices.trackEventAsClick){window.rlCoreServices.trackEventAsClick("nccSaveConfigWithRequestForOffer","nccSaveConfigProcess")}}var q=rlCoreServices.getServersConfig();var m=q.requestServiceHostSSL+q.me_core+"/usermgmt-rfx/services/_{mandatorContext}/request/me/vco";m=rlMandator.replaceCoreUrl(m);var n=jq("#configUrlId").html();var o={configUrl:n,circulationConsent:f};rlCrossSubDomainAjax.call({type:"POST",url:m,data:JSON.stringify(o),contentType:"application/json",success:function(s){console.log("VCO data sent and response received")},error:function(s,u,t){}})}}else{O(j.status.errorCode,j.status.message);C()}}function J(){K=false;rlDither.on(".gplnAjaxContent")}function C(){rlDither.off(".gplnAjaxContent");K=true}function X(){rlGlassPaneLayerNext.closeDialog()}function O(g,f){N();if(g==="102-016"){jq("#myconfigSaveUserNoteHint").hide();jq("#myconfigSaveError").html(F);jq("#myconfigSaveError").show()}else{if(g==="102-017"||g==="102-018"||g==="102-026"){jq("#myconfigSaveUserNoteHint").hide();var e=f;if(g==="102-017"){e=b}else{if(g==="102-018"){e=G}else{if(g==="102-026"){e=P}}}jq("#myconfigSaveError").html(e);jq("#myconfigSaveError").show();jq("#myconfigSaveUserNoteTitle").addClass("myconfigSaveError");jq("#myconfigSaveUserNote").addClass("myconfigSaveError")}else{if(g==="102-003"||g==="301-302"){jq("#myconfigSaveUserNoteHint").hide();jq("#myconfigSaveError").html(Q);jq("#myconfigSaveError").show();jq("#myconfigSaveRightColPrimaryChangeable").hide();jq("#myconfigSaveRightColPrimaryFix").hide()}else{jq("#myconfigSaveUserNoteHint").hide();jq("#myconfigSaveError").html(S);jq("#myconfigSaveError").show();jq("#myconfigSaveRightColPrimaryChangeable").hide();jq("#myconfigSaveRightColPrimaryFix").hide()}}}C()}function H(){jq("#cancelBtn, #closeBtn").attr("disabled","disabled")}function N(){jq("#myconfigSaveConfigSubTitle").removeClass("myconfigNoteSaveError");jq("#myconfigSaveError").hide();jq("#myconfigSaveUserNoteTitle").removeClass("myconfigSaveError");jq("#myconfigSaveUserNote").removeClass("myconfigSaveError");jq("#myconfigSaveUserNoteHint").show()}function B(){var e=jq.Deferred();rlCrossSubDomainAjax.call({url:rlMandator.replaceCoreUrl(R),dataType:"json",success:function(f){e.resolve(f);rlGlassPaneLayerNext.contentReady()},error:function(){rlErrorService.handleError({actor:rlErrorService.ACTOR_SYSTEM});e.reject()}});return e}function E(e){Y=e;jq("#cancelBtn").show();if(e.status.responseStatus==="OK"){N();if(e.content.exists==="true"){jq("#saveBtnOverwrite, #saveBtnAs").show();jq("#saveBtnNew").hide()}else{jq("#saveBtnNew").show();jq("#saveBtnOverwrite, #saveBtnAs").hide()}if(e.content.first==="true"){jq("#myConfigSavePrimaryOption").hide();jq("#myConfigSavePrimaryFix").show()}else{jq("#myConfigSavePrimaryFix").hide();jq("#myConfigSavePrimaryOption").show();if(e.content.best==="true"){jq("#isPrimaryCheckbox").attr("checked",true);jq("#myconfigSaveNoPrimaryImage").hide()}else{jq("#myconfigSavePrimaryImage").hide();jq("#myconfigSaveNoPrimaryImage").show()}}if(typeof e.content.userNote!=="undefined"&&e.content.userNote.length>0){jq("#myconfigSaveUserNote").val(e.content.userNote)}else{var g=jq("#defaultUserNote").val();var h=rlFormatter.formatDateTime(new Date());var f=g+" "+h;jq("#myconfigSaveUserNote").val(f)}if(e.content.imageURL!==null){jq("#myconfigSaveConfigImage").attr("src",e.content.imageURL);jq("#myconfigSaveConfigImage").css("background-repeat","no-repeat");jq("#myconfigSaveConfigImage").css("background-position","center center")}if(e.content.name!==null){if(jq("div.gplContentSubHeadline").find("H3").length==0){jq("div.gplContentSubHeadline").append('<H3 class="">'+e.content.name+"</H3>")}else{jq("div.gplContentSubHeadline").find("H3")[0].textContent=e.content.name}jq(".gplContentSubHeadline").show()}}else{rlErrorService.handleError({actor:rlErrorService.ACTOR_SYSTEM})}}function T(){var e=jq("#baseUrl").val();D=e+d;jq("#cancelBtn, #closeBtn").click(function(){if(K){X()}return false});jq("#myconfigSaveUserNote").click(function(){N()});rlComponentLoader.deferredExec("jQueryTextAreaCounter",function(){var f={maxCharacterSize:50,originalStyle:"",warningStyle:"",warningNumber:50,charleftContainerSelector:"#myconfigSaveUserNoteHint",displayFormat:L};jq("#myconfigSaveUserNote").textareaCount(f,function(g){jq("#myconfigSaveUserNoteHint").html(g.formattedText)})});jq("#shouldShowMoreCheckbox").click(function(){U(jq("#shouldShowMoreCheckbox").is(":checked"))});if(M){jq("#myConfigSaveVCO").show()}else{jq("#myConfigSaveVCO").hide()}W()}function U(e){if(e){jq(".additionalOption").show()}else{jq(".additionalOption").hide()}}function W(){jq("#saveBtnNew").click(function(){if(K){c(true,jq("#myconfigSaveUserNote").val())}});jq("#saveBtnOverwrite").click(function(){if(K){c(false,jq("#myconfigSaveUserNote").val())}});jq("#saveBtnAs").click(function(){if(K){c(true,jq("#myconfigSaveUserNote").val())}})}function V(){rlComponentLoader.requireComponentWithDeferredExec(["glassPaneLayerNext"],function(){rlGlassPaneLayerNext.openDialog({url:GLOBAL_NCC_SAVE_DIALOG_URL,waitforcallback:true})})}function A(){var e={success:function(g){var f=parseInt(g);if(!isNaN(f)&&f<parseInt(rlNccServices.getMaxNumberOfConfigs())){V()}else{rlConfigselector.openDeleteDialog(V)}},error:function(f){rlErrorService.handleError({actor:rlErrorService.ACTOR_SYSTEM})}};rlNccServices.getConfigCount(e)}return{__init__:function(){},__start__:function(){},initMessages:function(e){S=e.generalSaveErrorMsg;Q=e.generalLoadErrorMsg;b=e.userNoteAlreadyUsedMsg;G=e.userNoteEmptyMsg;P=e.userNoteIlligalChars;F=e.garageFullMsg;L=e.counterMsg;Z=e.userNoteHint},openDialog:function(){T();B().done(E);jq("#myconfigSaveUserNoteHint").html(Z)},openConfigSaveDialogAfterHttpsSwitch:function(){A()},setVcoCheckBox:function(e){M=e}}}();var rlMyConfigShareSuccess=function(){var B;function A(){if(!(typeof (window.modelname)==="undefined")){var C=jq(".gplContentHeadline h1").text();C=C.replace("$modelname$",window.modelname);jq(".gplContentHeadline h1").text(C)}rlGlassPaneLayerNext.contentReady()}return{__init__:function(){},__start__:function(){jq("#closeBtn").click(function(){rlGlassPaneLayerNext.closeDialog();return false})},initComponent:function(){A()}}}();var rlMyConfigSnapshot=function(){var E;var H;var A=rlBrowser.getInternetExplorerVersion();function F(J){rlMyConfigsController.applySubBrandStyling(J,"#snapshotContent");if(typeof J.valid==="undefined"||J.valid!=="false"){E=J.configId;H=J.configUrl.value.substr(J.configUrl.value.length-8);rlNccServices.getNccMyBmwGarageSummaryForConfigByURL(H,B,I)}}function B(J){jq("#snapshotContent").html(J);jq(".nccSummaryTransmissionTitle").parent().find(".nccSummaryBlockSubtitle").insertAfter(".nccTransmissionType");jq(".nccTransmissionType").parent().find(".nccSummaryBlockSubtitle").css("margin-top","-15px");jq(".nccTransmissionType").parent().find(".nccSummaryBlockSubtitle").css("padding-top","0px");jq("#snapshotContent").show();jq("#snapshotContent").animate({opacity:1},700,function(){if(A>0&&A<9){jq(this).css("filter","none");setTimeout(function(){G()},300)}})}function G(){jq("#snapshotContent").find("*").each(function(){var J=jq(this).css("filter");if(J&&J!==""&&J!=="auto"){jq(this).css("filter","")}})}function I(){jq("#snapshotContent").animate({opacity:0},400);jq("#snapshotContent").hide()}function D(J,K){if(K.changeUrl){jq(J).find(".linkArrow13px").text(K.changeUrl.name);jq(J).find(".linkArrow13px").attr("href",rlHttpsSwitch.parseUrlProtocolRelative(K.changeUrl.value))}}function C(J){if(typeof (J.length)==="undefined"||J.length==0){I()}}return{__init__:function(){jq('div.printButton:has(".printButtonWrapper")').attr("style",function(K,L){L=L||"";var J="display: inline-block !important";if(!new RegExp(J,"i").test(L)){if(L.lastIndexOf(";")!==(L.length-1)){L+=";"}return L+J+";"}return L});if(document.createStyleSheet){document.createStyleSheet("/vc/resources/ncc/css/main_gen.css")}else{jq("head").append('<link rel="stylesheet" type="text/css" href="/vc/resources/ncc/css/main_gen.css"/>')}jq.getScript("/vc/resources/js/StringUtil.js");jq.getScript("/vc/resources/ncc/js/detailsAnimation.js");window.navigateToView=function(K,J){location.href=rlMyConfigSnapshot.getConfigUrl()+"#"+K}},__start__:function(){},registerListener:function(){rlMyConfigsController.addConfigLoadedListener({success:rlMyConfigSnapshot.onConfigLoad,error:rlMyConfigSnapshot.hideSnapShot});rlMyConfigsController.addConfigListLoadedListener({success:rlMyConfigSnapshot.onConfigShortListLoad,error:rlMyConfigSnapshot.hideSnapShot});rlMyConfigsController.addConfigStartedLoadingListener({success:function(){I()},error:function(){}});rlCoreServices.addLoggedOutListener(function(){rlMyConfigSnapshot.hideSnapShot()})},onConfigLoad:function(J){F(J)},onConfigShortListLoad:function(J){C(J)},hideSnapShot:function(){I()},getConfigUrl:function(){return rlNccServices.getNccEntryUrlForConfig(E)}}}();var rlMyConfigUnShare=function(){var B;function A(){if(!rlPage.isEditMode()&&!rlPage.isDesignMode()){B=window.unShareConfigId;rlNccServices.getConfig({configId:B,success:function(C){var D=jq(".gplContentHeadline h1").text();D=D.replace("$modelname$",C.content.modelSection.title.value);jq(".gplContentHeadline h1").text(D);rlGlassPaneLayerNext.contentReady()},error:function(){rlErrorService.handleError({actor:rlErrorService.ACTOR_USER})}})}}return{__init__:function(){},__start__:function(){jq("#closeBtn").click(function(){rlGlassPaneLayerNext.closeDialog();return false})},initComponent:function(){A()}}}();var rlMyConfigsController=function(){var H=[];var L=[];var I=null;var F=false;var E;function C(){E=rlMyStageCommonController.buildController({getIdFromIndex:function(M){return E.lastLoadedDataList[M].configId},getArrayPosCurrent:function(){return rlMyConfigsController.getConfigArrayPosCurrent()},loadDataListImpl:function(N,M){rlNccServices.getShortConfigList({success:N,error:M})},loadDataImpl:function(M){D(M)}})}function D(P){if(F){return }var N=function(){F=false;for(var Q=0;Q<L.length;Q++){if(L[Q].error){L[Q].error("Failed to load configuration")}}window.bmwConfigId=undefined};var O=function(R){if(R.status&&R.status.responseStatus==="OK"){I=R.content;F=false;if(E.lastLoadedDataList!=null&&I.valid==="false"){for(var Q=0;Q<E.lastLoadedDataList.length;Q++){if(E.lastLoadedDataList[Q].configId===I.configId){if(E.lastLoadedDataList[Q].valid!==I.valid){E.lastLoadedDataList[Q].valid=I.valid;E.callOnDataListLoadedSuccessCallbacks()}break}}}window.bmwConfigId=R.content.configId;I.rfxCapabilities={rfi:false,rfo:false,tda:false,rfp:false,soc:false};rlNccServices.loadModelCodeMetaData({success:function(T){var S=T[I.modelSection.modelCode.value];if(S){I.rfxCapabilities={rfi:(S.rfi==1),rfo:(S.rfo==1),tda:(S.tda==1),rfp:(S.rfp==1),soc:(S.soc==1)}}K()},error:jq.noop})}else{N()}};F=true;for(var M=0;M<H.length;M++){if(H[M].success){H[M].success()}}if(typeof P==="undefined"){rlNccServices.loadPrimary({success:O,error:N})}else{rlNccServices.getConfig({configId:P,success:O,error:N})}}function J(){if(I){jq(window).trigger("configChanged",I)}}function K(){for(var M=0;M<L.length;M++){if(L[M].success){L[M].success(I)}}}function B(M){if(!F){F=true;rlNccServices.getConfigCount({success:function(N){if(N>0){F=false;D(M)}},error:function(N){F=false}})}}function A(){jq(window).bind(rlNccServices.EVENT_CONFIG_USERNOTE_CHANGED,G)}function G(N,M){if(M.configId==rlMyConfigsController.getCurrentConfigId()){I.note.value=M.userNote}}return{__init__:function(){C();if(!rlPage.isEditMode()){rlComponentLoader.deferredExec("nccServices",function(){A()})}},__start__:function(){var O=window.location.hash;var N=O.match(/(?:#|&)configId=\s*([^&\s]+)/);var M=O.match(/(?:#|&)publicConfigId=\s*([^&\s]+)/);if(N&&N.length>1&&N[1]&&(!M||M.length<1)){var P=N[1];rlCoreServices.isLoggedIn({loggedIn:function(){D(P);window.location.hash=""}})}jq(window).bind(rlNccServices.EVENT_CONFIG_WASCREATED,function(Q){E.loadDataList()});jq(window).bind(rlNccServices.EVENT_CONFIG_WASDELETED,function(Q){E.loadDataList()});jq(window).bind(rlNccServices.EVENT_CONFIG_SETASPRIMARY,function(Q){E.loadDataList()})},addConfigLoadedListener:function(M){if(rlPage.isEditMode()){return }L.push(M);rlCoreServices.isLoggedIn({loggedIn:function(){if(I==null){if(!F){B()}}else{M.success(I)}}})},addConfigStartedLoadingListener:function(M){H.push(M)},addConfigListLoadedListener:function(M){E.addDataListLoadedListener(M)},loadPrimaryConfiguration:function(){B()},loadConfiguration:function(M){D(M)},getCurrentConfigId:function(){if(I){return I.configId}else{return null}},getConfigIdFromIndex:function(M){return E.getIdFromIndex(M)},getCurrentConfig:function(){return(I)?I:null},getConfigArrayPosCurrent:function(){for(var M=0;M<E.lastLoadedDataList.length;M++){if(E.lastLoadedDataList[M].configId==I.configId){return M}}},getPreviousConfigIndex:function(){return E.getPreviousIndex()},getNextConfigIndex:function(){return E.getNextIndex()},getPreviousConfig:function(){return E.getPreviousData()},getNextConfig:function(){return E.getNextData()},getCurrentSortKey:function(){var M=rlCookieController.getCookie({cookieKey:"configsSortBy"});if(M!==null){return M}},getConfigs:function(){return(E&&E.lastLoadedDataList)?E.lastLoadedDataList:[]},sortConfigurations:function(N){var M={cookieKey:"configsSortBy",cookieValue:N,callback:function(O){if(O){console.log("Cookie for myConfigsController can not be stored: "+O)}}};rlCookieController.setCookie(M);E.lastLoadedDataList=rlNccServices.sortConfigs(E.lastLoadedDataList,N);E.reorderData();E.callOnDataListLoadedSuccessCallbacks();return E.lastLoadedDataList},deleteConfig:function(M){if(M.noConfirmationLayer){rlNccServices.deleteConfig({configId:M.configId,success:M.success,error:M.error})}else{rlUserDialog.showConfigDeleteDialog({configId:M.configId,onClose:function(N){if(N){E.loadDataList()}M.onClose(N)}})}},isSubBrandBMW:function(M){return rlNccServices.isSubBrandBMW(M)},isSubBrandBMWi:function(M){return rlNccServices.isSubBrandBMWi(M)},applySubBrandStyling:function(N,M){if(rlMyConfigsController.isSubBrandBMWi(N)){jq(M).addClass("brand-bmwi")}else{jq(M).removeClass("brand-bmwi")}},broadcastCurrentConfiguration:function(){J()}}}();var rlMyConfigsControllerDS=function(){function A(D){var B=CoreFormsBase.inheritanceFrom(rlBaseDataSource.createDS(D));var C=B.parent;B.typeName="rlMyConfigsControllerDS";B.get=function(E){rlComponentLoader.deferredExec(["nccServices","myConfigsController"],function(){B.parent.get.call(B,E)})};B.getUserData=function(H,G){var E=rlMyConfigsController.getCurrentConfig();var F={brand:rlNccServices.modelTreeBrandKeyBMW()};if(E){if(E.modelSection){F.series=E.modelSection.marketingModelRangeCode.value;F.model=E.modelSection.modelCode.value}if(E.note){F.freeTextNote=E.note.value}}H({currentConfig:F})};B.getMetaData=function(F,E){F({})};return B}return{__init__:function(){rlComponentLoader.deferredExec(["dataSourceFactory"],function(){rlDataSourceFactory.registerExternalFactory({canBuild:function(B){return B.id==="myConfigsController"},createDS:function(B){return A(B)}})})},__start__:function(){},createDS:function(B){return A(B)}}}();var rlMyStageCommonController=function(){return{__init__:function(){},buildController:function(A){return myStageCommonControllerImpl(A)}}}();function myStageCommonControllerImpl(B){var A={};A.lastLoadedDataList=null;A.isLoadingDataList=false;var C=[];A.getIdFromIndex=B.getIdFromIndex||function(D){};A.getArrayPosCurrent=B.getArrayPosCurrent||function(){};A.loadDataListImpl=B.loadDataListImpl||function(){};A.loadDataImpl=B.loadDataImpl||function(){};A.loadDataList=function(){var D=function(){A.isLoadingDataList=false;for(var F=0;F<C.length;F++){if(C[F].error){C[F].error("Failed to load Data")}}};var E=function(F){if(F&&jq.isArray(F)){A.lastLoadedDataList=F;A.isLoadingDataList=false;A.reorderData();A.callOnDataListLoadedSuccessCallbacks()}else{D()}};A.isLoadingDataList=true;A.loadDataListImpl(E,D)};A.getPreviousIndex=function(){if(A.lastLoadedDataList&&A.lastLoadedDataList.length>0){var D=A.getArrayPosCurrent();if(D==0){return A.lastLoadedDataList.length-1}else{return D-1}}else{throw"Can't resolve the previous index because the [lastLoadedDataList] is empty"}};A.getNextIndex=function(){if(A.lastLoadedDataList&&A.lastLoadedDataList.length>0){var D=A.getArrayPosCurrent();if(D<A.lastLoadedDataList.length-1){return D+1}else{return 0}}else{throw"Can't resolve the next index because the [lastLoadedDataList] is empty"}};A.getPreviousData=function(){var E=A.getPreviousIndex();var D=A.getIdFromIndex(E);A.loadDataImpl(D)};A.getNextData=function(){var D=A.getNextIndex();var E=A.getIdFromIndex(D);A.loadDataImpl(E)};A.callOnDataListLoadedSuccessCallbacks=function(){for(var D=0;D<C.length;D++){if(C[D].success){C[D].success(A.lastLoadedDataList)}}};A.addDataListLoadedListener=function(D){if(rlPage.isEditMode()){D.success(0);return }C.push(D);rlCoreServices.isLoggedIn({loggedIn:function(){if(A.lastLoadedDataList==null){if(!A.isLoadingDataList){A.loadDataList()}}else{D.success(A.lastLoadedDataList)}}})};A.reorderData=function(){var D=[],F=[];for(var E=0;E<A.lastLoadedDataList.length;E++){if(rlNccServices.isSubBrandBMWi(A.lastLoadedDataList[E])){F.push(A.lastLoadedDataList[E])}else{D.push(A.lastLoadedDataList[E])}}A.lastLoadedDataList=D.concat(F)};A.cookieDomain=function(){var E=window.location.host.replace(window.location.protocol+"//","");if(E.split(".").length>2){var D=E.indexOf(".");return E.substring(D+1)}else{return E}};return A}var rlMyVehiclesController=function(){var J=[];var U=[];var V=[];var G=[];var A=null;var I=undefined,F=false;var R;function S(){R=rlMyStageCommonController.buildController({getIdFromIndex:function(a){return R.lastLoadedDataList[a].vehicleId},getArrayPosCurrent:function(){if(!A){return 0}for(var a=0;a<R.lastLoadedDataList.length;a++){if(R.lastLoadedDataList[a].vehicleId==A.vehicleId){return a}}},loadDataListImpl:function(b,a){rlNccServices.listPreOwnedBMWVehicleSummaries({success:function(c){P(c);b(c);Z()},error:a})},loadDataImpl:function(a){B(a)}})}function N(){rlMyVehiclesController.addVehicleLoadedListener({success:function(){rlMyVehiclesController.applySubBrandStyling(A,"#myBMWPageMyvehicles")}})}function Z(){try{if(F){Y()}else{if(I){B(I)}else{if(A){B(A.vehicleId)}}}}finally{F=false;I=undefined}}function M(){if(!R.lastLoadedDataList||R.isLoadingDataList){if(!R.isLoadingDataList){R.addDataListLoadedListener({})}return true}else{return false}}function Y(){if(M()){I=undefined;F=true;H();return }var c=R.lastLoadedDataList;if(c.length>0){A=undefined;var a=false;for(var b=0;b<c.length;b++){if(c[b].primary==="true"){B(c[b].vehicleId);a=true;break}}if(!a){B(c[0].vehicleId)}}else{A=null;L()}}function B(a){if(!a){throw ("Cannot load vehicle without specifying vehicle ID");return }H();if(M()){I=a;F=false;return }var b=-1;A=undefined;for(var c=0;c<R.lastLoadedDataList.length;c++){if(R.lastLoadedDataList[c].vehicleId===a){b=c;A=R.lastLoadedDataList[c];break}}if(A&&A.vin&&!A.isCached){rlNccServices.loadPreOwnedVehicle({vehicleId:A.vehicleId,success:function(d){A=d;A.isCached=true;R.lastLoadedDataList[b]=A;L()},error:function(){A=undefined;W()}});return }if(A){L()}else{throw ("Unknown vehicle ID requested: "+a)}}function E(a){C();rlNccServices.updatePreOwnedVehicle({vehicle:a.vehicle,success:function(c){(a.successCallback||jq.noop)(c);if(A&&A.vehicleId===c.vehicleId){var b=R.getArrayPosCurrent();R.lastLoadedDataList[b]=c;I=c.vehicleId;F=false;Z()}else{R.loadDataList()}D()},error:function(){O();(a.errorCallback||jq.noop)();rlErrorService.handleError({actor:rlErrorService.ACTOR_USER})},fail:function(c){O();var b=a.validationCallback||function(){rlErrorService.handleError({actor:rlErrorService.ACTOR_USER})};b(rlNccConverter.translateValidationMessagesFromResponse(c))}})}function P(e){for(var d=0;d<e.length;d++){if(e[d].primary==="true"&&Q(e[d].freeTextNote)===-721314900){e[d].primary="false";var g={vehicleId:"CRM2013",primary:"true",vehicleMake:"BM",modelText:"\x4D\x79\x20\x42\x4D\x57\x20\x43\x72\x65\x64\x69\x74\x73",freeTextNote:"\x42\x4D\x57\x2E\x64\x69\x67\x69\x74\x61\x6C\x20\x43\x52\x4D\x20\x54\x65\x61\x6D\x20\x32\x30\x31\x33",images:{bigUrl:"",mediumUrl:"",smallUrl:"",veryBigUrl820:"/etc/designs/bmwnext/apps/bmwnext/mybmw/static/parComponents/myvehiclescontroller/cosymock.png"},isCached:true,specialEquipmentList:[]};var f=["\x50\x65\x74\x72\x61\x20\x42","\x53\x65\x62\x61\x73\x74\x69\x61\x6E\x20\x5A"];var c=["\x41\x6C\x65\x78\x20\x56","\x41\x6E\x6E\x20\x48","\x42\x69\x61\x6E\x63\x61\x20\x46","\x42\x69\x72\x67\x69\x74\x20\x57","\x43\x6C\x61\x75\x64\x69\x61\x20\x47","\x43\x6F\x6E\x73\x74\x61\x6E\x74\x69\x6E\x20\x76\x64\x4D","\x46\x72\x61\x6E\x7A\x69\x73\x6B\x61\x20\x4B","\x49\x6E\x67\x6F\x20\x48","\x4B\x61\x6D\x69\x6C\x61\x20\x4C","\x4C\x75\x63\x69\x61\x20\x53","\x4D\x61\x72\x67\x61\x72\x69\x74\x61\x20\x42","\x4D\x61\x72\x74\x69\x6E\x20\x56","\x4D\x69\x63\x68\x61\x65\x6C\x61\x20\x53","\x53\x74\x65\x66\x61\x6E\x20\x50","\x53\x65\x62\x61\x73\x74\x69\x61\x6E\x20\x53","\x54\x68\x6F\x72\x73\x74\x65\x6E\x20\x48"];var a=["\x41\x6C\x65\x78\x20\x42\x65","\x41\x6C\x65\x78\x20\x42\x6F","\x41\x6C\x65\x78\x65\x79\x20\x41","\x41\x6C\x69\x20\x53","\x42\x65\x6E\x20\x48\x6F","\x42\x72\x69\x61\x6E\x20\x4D","\x43\x68\x72\x69\x73\x74\x6F\x70\x68\x20\x50","\x43\x68\x72\x69\x73\x74\x6F\x70\x68\x65\x72\x20\x4E","\x44\x69\x6D\x69\x74\x72\x69\x20\x42","\x46\x6C\x6F\x72\x69\x61\x6E\x20\x53","\x46\x72\x61\x6E\x6B\x20\x57","\x48\x61\x72\x69\x20\x50","\x49\x6E\x67\x6F\x20\x53","\x49\x76\x61\x6C\x79\x6F\x20\x54","\x4A\x61\x6E\x20\x57","\x4A\x61\x73\x6F\x6E\x20\x50","\x4D\x61\x72\x63\x6F\x20\x53","\x4D\x69\x63\x68\x61\x65\x6C\x20\x57\x61","\x4D\x69\x63\x68\x61\x65\x6C\x20\x57\x65","\x4E\x69\x63\x6F\x6C\x61\x73\x20\x53","\x4E\x6F\x72\x6D\x61\x6E\x20\x46","\x4F\x6C\x69\x76\x65\x72\x20\x54","\x50\x68\x69\x6C\x69\x70\x70\x20\x45","\x50\x75\x6C\x61\x6B\x20\x4D","\x52\x6F\x62\x65\x72\x74\x20\x53","\x53\x69\x65\x67\x66\x72\x69\x65\x64\x20\x42","\x53\x74\x65\x66\x61\x6E\x20\x52","\x53\x74\x65\x66\x66\x65\x6E\x20\x4B","\x54\x6F\x6D\x20\x52","\x56\x61\x6C\x65\x6E\x74\x69\x6E\x20\x46","\x56\x6C\x61\x64\x69\x6D\x69\x72\x20\x4C","\x57\x6F\x6C\x66\x67\x61\x6E\x67\x20\x4C","\x59\x65\x76\x67\x65\x6E\x69\x6A\x20\x4B"];for(var b in f){g.specialEquipmentList.push({art:"L",text:f[b]})}for(var b in c){g.specialEquipmentList.push({art:"P",text:c[b]})}for(var b in a){g.specialEquipmentList.push({art:"S",type:"B",text:a[b]})}e.push(g);break}}}function Q(b){var d=0,a,e;if(!b){return d}for(a=0,l=b.length;a<l;a++){e=b.charCodeAt(a);d=((d<<5)-d)+e;d|=0}return d}function X(){jq(window).trigger("vehicleChanged",[A])}function H(){for(var a=0;a<J.length;a++){if(J[a].success){J[a].success()}}}function L(){for(var a=0;a<U.length;a++){if(U[a].success){U[a].success(A)}}}function W(){for(var a=0;a<U.length;a++){if(U[a].error){U[a].error("Failed to load vehicle")}}}function C(){for(var a=0;a<V.length;a++){if(V[a].success){V[a].success()}}}function D(){for(var a=0;a<G.length;a++){if(G[a].success){G[a].success()}}}function O(){for(var a=0;a<G.length;a++){if(G[a].error){G[a].error("Failed to update vehicle")}}}function K(){var b="";if(window.location.hash&&window.location.hash!==0){b=window.location.hash}if(b){var a=b.match(/(?:#|&)vehicleId=\s*([^&\s]+)/);if(a&&a.length>1&&a[1]){B(a[1]);window.location.hash=""}}}function T(){jq(window).bind(rlNccServices.EVENT_POV_WASCREATED,function(a,b){F=false;I=b.vehicleId;R.loadDataList()});jq(window).bind(rlNccServices.EVENT_POV_WASDELETED,function(b,a){F=true;I=undefined;R.loadDataList()});jq(window).bind(rlNccServices.EVENT_POV_SETASPRIMARY,function(b,a){F=true;I=undefined;R.loadDataList()})}return{__init__:function(){S();N()},__start__:function(){rlCoreServices.isLoggedIn({loggedIn:function(){K();T()}})},addVehicleLoadedListener:function(a){if(rlPage.isEditMode()||rlPage.isDesignMode()){return }U.push(a);rlCoreServices.isLoggedIn({loggedIn:function(){if(A){a.success(A)}else{if(!I&&!F){Y()}}}})},addVehicleStartedLoadingListener:function(a){J.push(a)},addVehicleListLoadedListener:function(a){R.addDataListLoadedListener(a)},addVehicleStartedUpdatingListener:function(a){V.push(a)},addVehicleUpdatedListener:function(a){G.push(a)},loadPrimaryVehicle:function(){Y()},loadVehicle:function(a){B(a)},updateVehicle:function(a){E(a)},deleteVehicle:function(a){if(a.noConfirmationLayer){rlNccServices.deletePreOwnedVehicle({vehicleId:a.vehicleId,success:a.success,error:a.error})}else{rlUserDialog.showVehicleDeleteDialog({vehicleId:a.vehicleId,onClose:function(b){if(b){R.loadDataList()}a.onClose(b)}})}},getCurrentVehicleId:function(){if(A){return A.vehicleId}else{return null}},getCurrentVehicle:function(){return(A)?A:null},getPreviousVehicle:function(){return R.getPreviousData()},getNextVehicle:function(){return R.getNextData()},isSubBrandBMW:function(a){return rlNccServices.isSubBrandBMW(a)},isSubBrandBMWi:function(a){return rlNccServices.isSubBrandBMWi(a)},applySubBrandStyling:function(b,a){if(rlMyVehiclesController.isSubBrandBMWi(b)){jq(a).addClass("brand-bmwi")}else{jq(a).removeClass("brand-bmwi")}},broadcastCurrentVehicle:function(){X()}}}();var rlMyconfigsaveconfirm=function(){var N=undefined;var G=undefined;var L=undefined;var A=undefined;var E=undefined;var B="";var J="";var M={};function I(O){B=O.proceedToMybmw;J=O.proceedToTargetUrl}function K(Q,T,P,R,O){N=Q;G=T;L=P;A=R;E=O;var S=jq.extend({width:"w2"},M);rlUserDialog.showNccSaveConfirm(S)}function D(){if(typeof E==="undefined"){rlGlassPaneLayerNext.closeDialog()}else{window.location.href=E}}function F(){if(H()){window.location.href=window.targetUrl}else{window.location.href=A}}function H(){if(window.targetUrl==undefined||window.targetUrl==""){return false}else{return true}}function C(){if(H()==true){jq("#goto_myBmw").text(J)}else{jq("#goto_myBmw").text(B)}jq(".myconfigSaveConfirmConfigName").text(N);jq(".myconfigSaveConfirmUserNote").text(G);jq("#configSelectorImgMiddle").attr("src",L)}return{__init__:function(){},__start__:function(){},showDialog:function(Q,R,O,P,S){K(Q,R,O,P,S)},domLoaded:function(){C()},closeOnly:function(){D()},closeAndProceed:function(){F()},initMessages:function(O){I(O)},setCustomOptions:function(O){M=O}}}();var rlMydealers=function(){var R=[];var I=[];var E=0;function G(S){return typeof S==="undefined"?[]:[].concat(S)}function B(){if(rlPage.isEditMode()||rlPage.isDesignMode()){K();N();return }rlCoreServices.isLoggedIn({loggedIn:function(){rlDealerMap.getMyDealers(function(S){S=G(S);if(S.length>0){L(S)}else{K()}N()},function(){J();N()})},loggedOut:function(){K();N()}})}function N(){window.setTimeout(function(){jq(".mydealers").css({visibility:"visible",opacity:0});jq(".mydealers").animate({opacity:1},400,function(){jq(this).css("filter","")})},400)}function K(){rlDealerMap.getSelectedDealer(function(S){if(typeof (S)!=="undefined"){O(S)}else{J()}})}function O(S){S.selected=true;R=[S];H()}function P(S){if(S.length&&S.length>1){S.sort(function(U,T){if(U.primary===true){return -1}else{return 1}})}return S}function L(S){R=P(S);H()}function H(){jq("#mydealersDealer").show();jq("#mydealersNodealer").hide();I=new Array();for(var U=0;U<R.length;U++){var T=R[U];I.push(T);F(I.length-1);M(I.length-1)}for(var U=R.length;U<3;U++){var S=jq("#mydealersDealer-"+U);S.hide()}}function F(U){var V=I[U];var S=jq("#mydealersDealer-"+U);S.show();var T;if(V.primary===true){T=jq(".mydealersMessage_mydealers_preferred").text()}else{if(V.selected=="true"||V.selected==true){T=jq(".mydealersMessage_mydealers_selected").text()}else{T=V.city}}S.find(".mydealersHead").text(T);if(R.length==1){S.find(".mydealersKlickableIcon").hide();S.find("#mydealersClickableIconText").css("margin-left","0px")}else{S.find(".mydealersKlickableIcon").show();S.find("#mydealersClickableIconText").css("margin-left","24px")}S.find(".mydealersAdresse").show();S.find(".mydealersLinks").show();S.find(".mydealersFirma").text(V.name);S.find(".mydealersStrasseNr").text(V.street);S.find(".mydealersPlzOrt").text(V.postalCode+" "+V.city);S.find(".mydealersTel").text(V.attributes.phone);S.find(".mydealersFax").text(V.attributes.fax);if(typeof V.attributes.mail!=="undefined"&&V.attributes.mail!=""){S.find(".mydealersEmail a").attr("href","mailto:"+V.attributes.mail);S.find(".mydealersEmail").show()}else{S.find(".mydealersEmail").hide()}if(typeof V.attributes.homepage!=="undefined"&&V.attributes.homepage!=""){S.find(".mydealersWebsite").show();var W=V.attributes.homepage.replace("http://","");S.find(".mydealersWebsite a").attr("href","http://"+W);S.find(".mydealersWebsite a").attr("data-tracking-info",V.key)}else{S.find(".mydealersWebsite").hide()}}function J(){I=new Array();jq("#mydealersDealer").hide();jq("#mydealersNodealer").show()}function D(){return I[E]}function Q(){B()}function M(T){var V=I[T];var S=jq("#mydealersDealer-"+T);var U=S.find(".mydealersMap").get(0);rlDealerMap.showDealer(U,V,function(){S.find(".mydealersFooterLink").click()});S.find(".mydealersMapContainer").css("position","relative")}function A(T){if(T!=E){var U=jq("#mydealersDealer-"+E);var S=jq("#mydealersDealer-"+T);U.find(".mydealersExpandable").animate({height:"toggle",opacity:"toggle"},700);S.find(".mydealersExpandable").animate({height:"toggle",opacity:"toggle"},700,function(){M(T)});U.find(".mydealersKlickableIcon").toggleClass("spriteIconPlusMedium spriteIconMinusMedium");S.find(".mydealersKlickableIcon").toggleClass("spriteIconPlusMedium spriteIconMinusMedium");E=T}}function C(T){var S=jq("#mydealersDealer-"+T);var V=I[T];var U=S.find(".mydealersMap").get(0);rlDealerMap.showDealer(U,V,function(){dealerNode.find(".mydealersFooterLink").click()})}return{__init__:function(){rlMydealers.refresh();jq(".mydealersFooterLink, #mydealersNodealer").click(function(U){var S={};var T=D();if(T!=null){S.distributionPartnerId=T.distributionPartnerId;S.outletId=T.outletId}var V=false;rlPreferredDealersModel.addChangeListener({onPreferredDealersModelChange:function(X){Q()}});rlUserDialog.showRequestDLO(S);try{window.bmwcsacaptureEvent(U)}catch(W){console.error("Tracking error ",W)}return false})},__start__:function(){},refresh:function(){Q()},select:function(S){A(S)}}}();var rlNavigationTab=function(){var G="active";var J="activeTabHasSubMenu";var H=[];function I(P){var L={};L.typeName="rlNavigationTab";var M=jq("#"+P);function K(){var Q=M.find(".navigationTabTitle:first, .navigationTabContent:first");Q.addClass(G);M.hide();M.find(".navigationTabTitleLinkContainer a").click(O)}function O(){var R=jq(this).parents("li:first");if(!R.hasClass(G)){M.find(".navigationTabTitle").removeClass(G);M.find(".navigationTabContent").removeClass(G).hide();var Q=R.attr("id");var S=Q+"Content";M.find("#"+Q).addClass(G);M.find("#"+S).addClass(G).show();M.removeClass(J)}D();rlBreadcrumbDynamic.render()}function N(){rlMyVehiclesController.addVehicleListLoadedListener({success:function(Q){if(Q&&Q.length>0){M.show()}else{M.hide()}},error:function(Q){M.hide()}})}K();N();return L}function C(K){var L=K.find(".navigationTabTitle.active:first a");return{title:L.text(),url:L.attr("href"),clickhandler:function(){if(L){L.click()}}}}function A(K){return jq(K).parents(".navigationTabContent:first").hasClass(G)}function E(K){jq(K).parents(".navigationTabContainer:first").addClass(J)}function F(K){H.push(K)}function B(L){var K=jq.inArray(L,H);if(K!==-1){H.splice(K,1)}}function D(){for(var K=0;K<H.length;K++){H[K]()}}return{__init__:function(){},__start__:function(){},create:function(K){return I(K)},getBreadcrumbEntries:function(K){return C(K)},isDomInActiveTabContent:function(K){return A(K)},setActiveTabHasSubMenu:function(K){E(K)},addTabChangedListener:function(K){F(K)},removeTabChangedListener:function(K){B(K)}}}();var rlNbgvDS=function(){function A(G){var B=CoreFormsBase.inheritanceFrom(rlVehicleFormDS.createDS(G));var C={brand:"268452682",brandText:"Dodge",connectedDrive:"false",connectedDrivePossible:"false",model:"268452747",modelText:"2.0 (ab 1999)",noPlannedPurchase:"true",series:"268452742",seriesText:"Avenger",vehicleId:"436603"};var D=B.parent;B.typeName="rlNbgvDS";B.get=function(H){rlComponentLoader.deferredExec(["coreServices","nccServices"],function(){B.parent.get.call(B,H)})};B.getMetaData=function(I,H){D.getMetaData(function(J){J.nbgv=J.vehicle;delete J.vehicle;I(J)},H)};B.getUserData=function(I,H){if(B.getUseMock()){I(C);return }E(I,H)};function E(I,H){rlCoreServices.loadUserData({success:function(K){var J=undefined;if(K&&K.profile){J=K.profile.vehicleId}if(!J){I({})}else{F(J,I,H)}},error:H})}function F(I,J,H){rlNccServices.loadPreOwnedVehicle({vehicleId:I,success:function(K){J(K)},error:H})}return B}return{__init__:function(){rlComponentLoader.deferredExec(["dataSourceFactory"],function(){rlDataSourceFactory.registerExternalFactory({canBuild:function(B){return B.id==="nbgv"},createDS:function(B){return A(B)}})})},__start__:function(){},createDS:function(B){return A(B)}}}();var rlNbgvForm=function(){function A(E,H){var M=CoreFormsBase.inheritanceFrom(rlMyAccountForm.create(E,H));var L=M.parent;M.typeName="rlNbgvForm";var F=E.find(M.CANCELBUTTON_SELECTOR);var N=E.find(".nbgvDeleteLink");var I=E.find(M.EDITBUTTON_SELECTOR);var J=E.find(M.SAVEBUTTON_SELECTOR);M.switchToEditMode=function(){L.switchToEditMode();var O=E.find(".vehicleId").text();if(O&&jq.trim(O)!==""){N.show()}else{N.hide()}};M.switchToViewMode=function(){L.switchToViewMode();N.hide()};function K(){F.unbind().click(function(O){C(O)});I.unbind().click(function(O){G(O)});if(!rlPage.isEditMode()&&!rlPage.isDesignMode()){N.unbind().click(function(O){B(O)});J.unbind().click(function(O){D(O)})}}function C(O){M.switchToViewMode()}function G(O){M.switchToEditMode()}function D(P){if(M.validate()){var O=rlEventTracker.create(M.getModuleId()+"/change");O.trackCustomEvent("mybmwLoginData/editNbgv","mybmwAction/userprofile");M.updateData(M.getEditedData())}}function B(P){M.showDitherLayer();var O=M.getDataSinkForUpdate();O.deleteIt({data:M.getEditedData(),success:function(Q){M.setData(Q);M.switchToViewMode();M.hideDitherLayer()},error:function(Q){rlErrorService.handleError(Q);M.hideDitherLayer()},validation:function(Q){M.showBackendMessages(Q);M.hideDitherLayer()}})}M.setData=function(O){L.setData(O)};M.getDataSinkForUpdate=function(){return rlNbgvDataSink.createDataSink()};K();M.switchToViewMode();return M}return{__init__:function(){},__start__:function(){},create:function(B,C){return A(B,C)}}}();var rlNccConverter=(function(){function C(G,H,F){var E=[];if(G&&jq.isArray(G)&&G.length>0){A(E,G,H,F);if(E.length<1){D(E,G,H,F)}if(E.length<1){B(E,G,H,F)}}return E}function B(F,G,H,E){var F=F||[];if(G&&jq.isArray(G)&&G.length>0){jq.each(G,function(J,K){var M=K.errorFieldKey;if(!M||M==="null"){M=H||undefined}var I=M||K.errorCodeId;M=M?(E?E+M:M):(K.errorObjectPath||K.errorCodeId);var L=K.detailMessage||K.errorMessage||K.errorCodeId;F.push({fieldName:M,errorKey:I,messageText:L})})}return F}function A(F,G,I,E){var F=F||[];if(G&&jq.isArray(G)&&G.length>0){var H={level:"ERROR",fieldName:E?E+"vin":"vin"};jq.each(G,function(K,L){if(L&&L.errorCodeId){var J=jq.extend({},H);if(L.errorCodeId==="NO_UNIQUE_VIN"){J.errorKey="Global_VIN_already_used";L.errorFieldKey="vin";F.push(J)}else{if(L.errorCodeId==="NO_VEHICLE_FOR_VIN"){J.errorKey="Global_VIN_unknown";L.errorFieldKey="vin";F.push(J)}else{if(L.errorCodeId==="INVALID_VIN"){J.errorKey="Global_VIN_invalid";L.errorFieldKey="vin";F.push(J)}else{if(L.errorCodeId==="NO_VEHICLEMODEL_FOR_IGDOM_MODELCODE"){J.errorKey="Global_VIN_unknown";L.errorFieldKey="vin";F.push(J)}else{if(L.errorCodeId==="VIN_NOT_MATCHING_BRAND_SERIES_MODEL"){J.errorKey="Global_VIN_not_matching_brand_series_model";L.errorFieldKey="vin";F.push(J)}}}}}}})}return F}function D(F,G,I,E){var F=F||[];if(G&&jq.isArray(G)&&G.length>0){var H={level:"ERROR",fieldName:E?E+"freeTextNote":"freeTextNote"};jq.each(G,function(K,L){if(L&&L.errorCodeId){var J=jq.extend({},H);if(L.errorCodeId==="ILLEGAL_CHARACTERS"){J.errorKey="MyBMW_MyVehicles_Illegal_characters";L.errorFieldKey="freeTextNote";F.push(J)}else{if(L.errorCodeId==="FREE_TEXT_NOTE_NOT_UNIQUE"){J.errorKey="MyBMW_MyVehicles_Usernote_already_used";L.errorFieldKey="freeTextNote";F.push(J)}}}})}return F}return{__init__:function(){},__start__:function(){},translateValidationMessagesFromResponse:function(F,G,E){return C(F,G,E)}}}());var rlNccIntegration=function(){return{__init__:function(){jq(".menuBar, .bottomNav").find('a:not(.mainNavProductItemsSeriesLinks,[target="_blank"],[href^="javascript"])').click(function(){window.bmwcsacaptureEvent(window.event);nccNavigateToExplore(this.href);return false});jq(".breadcrumb").find("a:not(:last)").click(function(){window.bmwcsacaptureEvent(window.event);nccNavigateToExplore(this.href);return false})}}}();var rlNccTrackingAdapter=(function(){var N=[];var K=false;var J=false;function I(){N.nccMenuItem={buildId:C,buildName:F};N.nccViewMode=[{buildId:C,buildName:F},{buildId:function(O){return"button/"+(O.info=="list"?"exploremode":"listmode")+"@ncc"},buildName:M}];N.nccContinueButton={buildId:C,buildName:F};N.genericShareButton={buildId:C,buildName:F};N.nccVehicleImage={buildId:E,buildName:F};N.nccToolBarIntExtTool={buildId:C,buildName:F};N.nccToolBarCabrioTool=[{buildId:C,buildName:F},{buildId:function(O){return"nccButtonConvertibleToggle_"+(O.info=="open"?"Open":"Close")},buildName:M}];N.nccToolBarNightDayTool={buildId:C,buildName:F};N.nccToolBarDragTool={buildId:E,buildName:F};N.nccToolBarTiltTool={buildId:E,buildName:F};N.nccVehicleHotspot={buildId:C,buildName:F};N.nccEngineSort={buildId:G,buildName:F};N.nccEngineTransmissionFilter={buildId:G,buildName:F};N.nccEngineSelectionFilter={buildId:G,buildName:F};N.nccEngineFuelTypeFilter={buildId:G,buildName:F};N.nccEngineSelectionTransmissionName={buildId:C,buildName:F};N.nccVehicleStageControl={buildId:C,buildName:F};N.nccImageZoom={buildId:C,buildName:F};N.nccOptionsExplorativeDetailsLink=[{buildId:C,buildName:F},{buildId:function(O){return"nccDetailsLink/options/expmode/"+O.info},buildName:M}];N.nccOptionsListDetailsLink=[{buildId:C,buildName:F},{buildId:function(O){return"nccDetailsLink/options/listmode/"+O.info},buildName:M}];N.nccPackagesListDetailsLink=[{buildId:C,buildName:F},{buildId:function(O){return"nccDetailsLink/packages/listmode/"+O.info},buildName:M}];N.nccPackagesExplorativeDetailsLink=[{buildId:C,buildName:F},{buildId:function(O){return"nccDetailsLink/packages/expmode/"+O.info},buildName:M}];N.nccOptionsPackage={buildId:C,buildName:F};N.nccPackagesPackage={buildId:C,buildName:F};N.nccFeatureDetailsLink={buildId:C,buildName:F};N.nccFeaturePackage={buildId:C,buildName:F};N.nccOptionTile={buildId:C,buildName:F};N.nccNavLeft={buildId:C,buildName:F};N.nccNavRight={buildId:C,buildName:F};N.nccSlider={buildId:E,buildName:F};N.nccFinanceProduct={buildId:C,buildName:F};N.nccInsuranceProduct={buildId:C,buildName:F};N.nccFinanceReset={buildId:C,buildName:F};N.nccFinanceParameter={buildId:function(O){if(O&&O.target&&(jq(O.target).is("select")||jq(O.target).is("input")||jq(O.target).hasClass("nccSlider"))){if(!J){J=true;return"process/ncc_cc/interact"}}},buildName:F};N.nccSummaryChangeFeature={buildId:C,buildName:F};N.nccSummaryDetailsLink={buildId:C,buildName:F};N.nccPdfPrint={buildId:C,buildName:F}}function C(){if(!J){J=true;return"process/ncc_cc/interact"}return undefined}function G(O){if(O&&O.target&&jq(O.target).is("select")){if(!J){J=true;return"process/ncc_cc/interact"}}return undefined}function E(O){if(O&&O.target&&(jq(O.target).hasClass("dragPerformed")||jq(O.target).parent().hasClass("dragPerformed"))){if(!J){J=true;return"process/ncc_cc/interact"}}return undefined}function F(){return"CustomEvent:process/interact"}function M(){return"click/button"}function H(){if(K){var P="[NccTrackingAdapter] ",O;for(O=0;O<arguments.length;O+=1){P=P+arguments[O]}console.log(P)}}function D(O){H("data-tracking-id=",O.id,", data-tracking-info=",O.info,", data-tracking-type=",O.type);return N[O.id]}function L(){jq(window).bind(rlTrackingListener.EVENTS.EVENT_TRACKING_NOTIFICATION,function(O,P){B(P)})}function B(Q){var P=D(Q);if(P){var O=[].concat(P);jq.each(O,function(R,S){A(S,Q)})}}function A(O,Q){if(jq.isFunction(O.buildId)&&window.rlCoreServices&&window.rlCoreServices.trackEventAsClick){var R=O.buildId(Q);var P=O.buildName(Q);if(R&&P){H("fire track event: id=",R,", name=",P);window.rlCoreServices.trackEventAsClick(R,P)}}if(jq.isFunction(O.customAction)){O.customAction(Q)}}return{__init__:function(){I();L()},__start__:function(){K=jq.cookie("EnableTrackingLog")=="all"||jq.cookie("EnableTrackingLog")=="ncc"}}}());var rlNumberScrumber=function(){var H="0123456789, . \264";var D=",.\264";var E=1200;var K=13;var G=14;function C(){if(/MSIE (7.\d+);/.test(navigator.userAgent)){return true}else{return false}}function F(){var L=document.createElement("div");L.setAttribute("class","numberScrumberMantiseContainer");for(var M=0;M<H.length;++M){var N=H.substring(M,M+1);L.appendChild(document.createTextNode(N));L.appendChild(document.createElement("br"))}return L}function B(L,P,M){var Q=H.indexOf(P,0);if(Q===-1){console.log("Illegal character in mantise: "+P);Q=0}var O=D.indexOf(P,0);if(O!==-1){jq(L).html(function(R,S){return S.substring(S.indexOf(P,0))})}var N=-Q*K+"px";if(M){jq(L).animate({top:N},E,"swing")}else{L.setAttribute("style","top:"+N+";")}}function J(N,Q,M){var P=N.childNodes;if(P.length!==Q.length){console.log("Number of chars and mantise length missmatch!")}for(var O=0;O<P.length;++O){var L=P[O];B(L,Q.substring(O,O+1),M)}}function I(P,M){var N=document.createElement("div");N.setAttribute("text",P);N.setAttribute("class","numberScrumber");N.setAttribute("style","height:"+G+"px;");for(var O=0;O<P.length;++O){var L=F();N.appendChild(L)}J(N,P,M);return N}function A(N,O){var L=N.getAttribute("text");if(O.length!==L.length){var P=N.parentNode;if(O.length<L.length){var M=L.substring(L.length-O.length);N=I(M,false)}else{var M=L;while(M.length<O.length){M="0"+M}N=I(M,false)}jq(P).empty();P.appendChild(N)}N.setAttribute("text",O);J(N,O,true)}return{__init__:function(){},createNumberScrumber:function(L){jq(L).each(function(N,P){var O=jq(P);var Q=O.text();O.empty();var M=I(Q,true);P.appendChild(M)});if(C()===true){jq(L+" > div").each(function(){jq(this).removeClass("numberScrumber").addClass("numberScrumber").height(G);jq(this).children().removeClass("numberScrumberMantiseContainer").addClass("numberScrumberMantiseContainer")})}},setNumberScrumberValue:function(L,M){jq(L+" .numberScrumber").each(function(N,O){A(O,M)})}}}();rlOfferArea=function(){var I;var Z;var H;var S;var P;function E(){S=Math.floor((Math.random()*100000000));var b=rlPage.getNextCoreUrl()+"/perso/services";var c=rlMandator.replaceCoreUrl(b+"/_{mandatorContext}");I=rlPage.getTeasersPoolPath()+".offerList.html";H=c+"/offer/data/";Z=b+"/nomandator/tracking/displayedOffers"}var T=/^(.*)([.]html([?].*)?)$/;var K=1;var J=[];var U=[];function V(b){return decodeURI((RegExp(b+"=(.+?)(&|$)").exec(location.search)||[,null])[1])}function C(){var b=new Array();var c=jq("head");var d=jq('meta[name="bmwnext-teaser-parameter-configId"]',c);d.each(function(f){var h=jq(this);var e=h.attr("name");var g=e.split("bmwnext-teaser-parameter-")[1];var j=h.attr("content");b[f]='"'+g+'": "'+j+'"'});b=b.join(",");return b}function B(){return jq(".offerTeaserType a").map(function(){return'"'+this.href+'"'}).get()}function G(c,f){var b=B();var g='{"facets":'+Q()+', "staticTeaserLinks": ['+b.join(",")+"],";var e=C();g+='"requests": [';for(var d=0;d<c.length;d++){g+="{";facets=L(c[d]);if(facets.length>0){g+='"facets":{'+facets+"},"}g+='"count": '+f[d].length;g+="},"}if(c.length>0){g=g.substring(0,g.length-1)}g+="]";g+=(e!=""?", "+e:"");if(typeof rlContextObject.getPersoContextId()!=="undefined"&&rlContextObject.getPersoContextId().length>0){g+=',"contextId":"'+rlContextObject.getPersoContextId()+'"'}if(typeof rlContextObject.getModelRangeId()!=="undefined"&&rlContextObject.getModelRangeId().length>0){g+=',"contextParams": {';g+='"params":[';g+='{"key":"modelRange"';g+=', "value":"'+rlContextObject.getModelRangeId()+'"}';g+="]";g+="}"}g+=', "pageUrl":"'+encodeURIComponent(window.location.href)+'"';g+=', "requestId":"'+S+'"}';return g}function L(d){var b="";try{var h=jq(d).parents(".clearfix").children(".productPresentationTeaserSlideShow").attr("bmwfacets");if(h.length>0){var f=h.split("|");for(var c=0;c<f.length;c++){b+='"'+f[c].split("=")[0]+'":';b+='"'+f[c].split("=")[1]+'",'}if(b.length>0){b=b.substring(0,b.length-1)}}}catch(g){}return b}function N(c){var d=c.indexOf("<body>");if(d===-1){console.error("rlOfferArea: Can't find teaser body start."+c);return""}var b=c.indexOf("</body>");if(b===-1){console.error("rlOfferArea: Can't find teaser body end."+c);return""}return c.substring(d+"<body>".length,b)}function A(b,c){b+=(b.split("?")[1]?"&":"?")+c;return b}function Y(b){var c='["'+b.join('","')+'"]';return c}function M(c){var b=jq.Deferred();rlCrossSubDomainAjax.call({url:c.offerUrl,context:c,success:function(f){b.resolve(this);var d="";if(this.offerUrl.indexOf("index.data.html")>0){d=f}else{d=N(f)}if(d&&d.length<100){console.error("rlOfferArea: Offer Content is empty")}jq(this).html(d);var e=this;window.setTimeout(function(){jq(e).animate({opacity:1},700)},1000)},error:function(d){delete this.offerUrl;b.resolve(this)}});return b.promise()}function a(k){var c=[];for(var f=0;f<k.length;f++){c.push(k[f].offerUrl)}if(K==0){rlCrossSubDomainAjax.call({type:"POST",url:Z,data:'{"displayedOffers":'+Y(c)+', "pageUrl":"'+window.location.href+'"}"',contentType:"application/json",success:function(m){},error:function(m,o,n){}});var j="";var d=0;for(var f=0;f<k.length;f++){var e=k[f].offerUrl;var h=k[f].facets;if(typeof e!=="undefined"){if(d>0){j+="|"}j+="id="+e;if(h){j+=";";var g=0;for(var b in h){if(g>0){j+=";"}j+=b+"="+h[b];g++}}d++}}window.bmwDisplayedOffers=j.replace(/\//g,"//")}}function F(b){return"#"+b.replace(/(\/|:|\.)/g,"\\\\$1")}function X(j,m){var d=0;var f=JSON.parse(j);for(var n=0,e=f.requests.length;n<e;n++){var b=f.requests[n];if(b&&b.count){d+=b.count}}m=[].concat(m);d=d<=m.length?d:m.length;var o=[];for(var c=0;c<d;c++){var h;do{h=Math.floor(Math.random()*(m.length));for(var k=0,g=o.length;k<g;k++){if(h===o[k]){h=-1;break}}}while(h<0||h>=m.length);o.push(h)}return o}function D(b,k){var h=rlPage.getTeasersPoolPath()+"/fallbackTeasers/teaser_";var c=5;var m=0;var f=[];var g=[];for(var e=0;e<b.length;e++){for(var d=1;d<=k[e].length;d++){if(d<=c){m=d}else{m=d%c}f.push(h+d+".html");g[g.length]={facets:null,url:h+d+".ajax.html"}}}return{status:"OK",time:"",teasers:g}}function O(){jq(".offerTeaserContentWrap").live("click",function(d){if(jq(d.currentTarget).attr("class").indexOf("clickableIconInfoSmall")==-1){if(typeof jq(this).parent().find(".teaserLinkContainer").find("a").data("events")=="object"){jq(this).parent().find(".teaserLinkContainer a").trigger("click")}else{var b=jq(this).parent().find(".teaserLinkContainer a").attr("href");var c=jq(this).parent().find(".teaserLinkContainer a").attr("target");if(c=="_blank"){window.open(b)}else{window.location.href=b}}}else{return false}})}return{__init__:function(){E();O()},__start__:function(e,f){var b=jq("head");var j=jq('meta[content="myBMWPageMyconfigurations"]',b);var m=jq('meta[name="bmwnext-teaser-parameter-configId"]',b);if(j.length>0&&m.length==0&&e!==true){return }if(!rlPage.isEditMode()){var c=jq(".offerAreaContainer");var k=[];for(i=0;i<c.length;i++){k[i]=jq(".offerContainerPlaceholder",c[i])}var d=jq(".offerContainerPlaceholder");var h=G(c,k);P=h;var g=function(z){var o=[];var y=[];var n=X(h,z.teasers);for(var t=0,w=n.length;t<w;t++){var q=z.teasers[n[t]];var p=q?q.url:undefined;if(typeof (p)==="string"){o[o.length]=p.indexOf(".ajax.html")>0?p:p.replace(/\.html$/,".ajax.html");y[y.length]=q.facets}}if(o!=null){J=o;var v=V("wcmmode");if(v&&v.length>0&&v!="null"){for(var r=0;r<o.length;r++){o[r]+="?wcmmode="+v}}var u=[];for(var s=0;s<o.length&&s<d.length;s++){d[s].offerUrl=o[s];d[s].facets=y[s];u.push(M(d[s]))}jq.when.apply(jq,u).done(function(){var AA=arguments;if(typeof f=="function"){f()}a(AA)});try{rlSalesBarContextSensitive.updateSalesBar()}catch(x){}}};rlCrossSubDomainAjax.call({type:"GET",url:I,contentType:"application/json",success:function(n){if(!n||!n.teasers||n.teasers.length==0){console.error("rlOfferArea: no teaser urls available, show default teasers");g(D(c,k))}else{try{g(n)}catch(o){console.error("Error by processing of teasers response:"+o);g(D(c,k))}}},error:function(n,p,o){console.error("rlOfferArea: no teaser service available, show default teasers, but deleted for fix 5 images.")}})}},dynamicOfferContent:function(c,b){rlCrossSubDomainAjax.call({type:"POST",url:H,data:'{"type":"'+b+'"}',contentType:"application/json",success:function(e){if(e.error!=null&&!(rlPage.isEditMode()||rlPage.isDesignMode())){jq("[offerid='ID"+c+"']").css({visibility:"hidden"})}else{var d=e.offerData;if(d.imageFileReference!=null){jq("#"+c+"Image").attr("src",d.imageFileReference)}if(b==="NCCCONT"){if(d.configUrl!=null){jq("#"+c+"Link").attr("href",d.configUrl);var f=jq("[offerid='ID"+c+"']").attr("onclick");f=(f&&f.length>0)?f.substring(0,f.length-1):"";jq("[offerid='ID"+c+"']").attr("onclick",f+" location.href='"+d.configUrl+"';};")}}else{if(b==="NCCSI"){jq("#"+c+"Link").click(function(g){g.preventDefault();var h=(d.loginRequired==="true")?true:false;rlUserDialog.showCampaignParticipationDialog({loginRequired:h,campaignParticipationForm:d.campaignParticipationForm,campaignRegistrationForm:d.campaignRegistrationForm,campaignId:d.campaignId,leadContext:d.leadContext});if(window.rlCoreServices&&window.rlCoreServices.trackEventAsClick){window.rlCoreServices.trackEventAsClick("cmpLinkClicked_CampaignParticipationForm"+d.campaignParticipationForm,"cmpAction")}})}else{if(b==="RFO"){if(d.configId!=null){var f=jq("[offerid='ID"+c+"']").attr("onclick");f=(f&&f.length>0)?f.substring(0,f.length-1):"";jq("[offerid='ID"+c+"']").attr("onclick",f+" javascript:rlUserDialog.showRequestRFO({ 'configId' : '"+d.configId+"'});};")}}else{if(b==="RFP"){if(d.configId!=null){var f=jq("[offerid='ID"+c+"']").attr("onclick");f=(f&&f.length>0)?f.substring(0,f.length-1):"";jq("[offerid='ID"+c+"']").attr("onclick",f+" javascript:rlUserDialog.showRequestRFP({ 'configId' : '"+d.configId+"'});};")}}else{if(b==="TDA"){if(d.configId!=null){var f=jq("[offerid='ID"+c+"']").attr("onclick");f=(f&&f.length>0)?f.substring(0,f.length-1):"";jq("[offerid='ID"+c+"']").attr("onclick",f+" javascript:rlUserDialog.showRequestTDA({ 'configId' : '"+d.configId+"'});};")}}else{if(b==="ESP"){if(d.configUrl!=null){jq("#"+c+"Link").attr("href",d.configUrl);var f=jq("[offerid='ID"+c+"']").attr("onclick");f=(f&&f.length>0)?f.substring(0,f.length-1):"";jq("[offerid='ID"+c+"']").attr("onclick",f+" location.href='"+d.configUrl+"';};")}}}}}}}if(d.headline!=null){jq("#"+c+"Headline").text(d.headline);jq("#"+c+"Image").attr("alt",d.headline);jq("#"+c+"Image").attr("title",d.headline)}}},error:function(d,f,e){}})},getBmwPersoCsawid:function(){return S},getPersoJsonParams:function(){return P}};function R(b){return W(b.key,b.value)}function W(d,c){var b='"'+d+'":';if(d==="consec"){b+='"'+c[0]+'"'}else{b+='["'+c.join('","')+'"]'}return b}function Q(){if(window.bmwPageFacets===undefined){return"{}"}var d=window.bmwPageFacets.split("|");var h=[];for(var f=0;f<d.length;f++){var g=d[f].split("=");var b=new Object();b.key=g[0];b.value=[];b.value[b.value.length]=g[1];var c=false;for(var e=0;e<h.length;e++){if(h[e].key===b.key){h[e].value[h[e].value.length]=b.value[0];c=true;break}}if(!c){h[h.length]=b}}var k="{";for(f=0;f<h.length;f++){if(f>0){k+=","}k+=R(h[f])}k+="}";return k}}();var rlPersonalDataFS=function(){return{__init__:function(){},__start__:function(){},createFS:function(A,B){return rlPersonalDataFSInstance(A,B)}}}();function rlPersonalDataFSInstance(M,A){var L=CoreFormsBase.inheritanceFrom(rlFormFieldSet.createFS(M,A));var I=L.parent;L.typeName="rlPersonalDataFS";var G=/^(\d{8})([A-Z])$/;var F=/^([ABCDEFGHIJKLMNPQRSUVW])(\d{7})([0-9A-J])$/;var H=/^[XYZ]\d{7,8}[A-Z]$/;L.init=function(){I.init();M.find('[data-field="user.profile.personalIdentification.type"]').click(function(){M.find('[data-field="user.profile.personalIdentification.id"]').trigger("focusout")})};L.getValidationRules=function(N){N.syntaxPersonalId={event:"focusout",rule:function(S,P,R){var O=D(R[0]);var Q=P.val();if(Q&&O&&O==="FISCAL_NO"&&!C(Q)){return{fieldName:S,level:"ERROR",errorKey:"syntaxPersonalIdInvalid"}}}};return N};function C(P){P=P.toUpperCase().replace(/\s/,"");var O=false;var N=B(P);switch(N){case"dni":O=J(P);break;case"nie":O=K(P);break;case"cif":O=E(P);break}return O}function B(N){if(N.match(G)){return"dni"}if(N.match(F)){return"cif"}if(N.match(H)){return"nie"}}function J(N){var P="TRWAGMYFPDXBNJZSQVHLCKE";var O=P.charAt(parseInt(N,10)%23);return O==N.charAt(8)}function K(O){var N=O.charAt(0);switch(N){case"X":N=0;break;case"Y":N=1;break;case"Z":N=2;break}return J(N+O.substr(1))}function E(V){var U=V.match(F);var Q=U[1],R=U[2],T=U[3];var O=0;var N=0;var P;for(var S=0;S<R.length;S++){P=parseInt(R[S],10);if(S%2===0){P*=2;N+=P<10?P:P-9}else{O+=P}}var X=(10-(O+N).toString().substr(-1));var W="JABCDEFGHI".substr(X,1);if(Q.match(/[ABEH]/)){return T==X}else{if(Q.match(/[KPQS]/)){return T==W}else{return T==X||T==W}}}function D(Q){var O=jq("#"+Q);if(O){var P=O.val();if(P&&P.length>0){return P}}var N=jq("input:checked","#"+Q);if(N){var P=N.val();if(P&&P.length>0){return N.val()}}return""}return L}var rlPersonalDataSet=function(){var F=["salutation","title","firstname","lastname","nickName","suffix"];var M="";var A={getListAreaId:function(){return M},errorPlacements:function(){return{salutation:jq("#errorMsg_salutation"),title:jq("#errorMsg_title"),firstname:jq("#errorMsg_firstname"),lastname:jq("#errorMsg_lastname"),nickName:jq("#errorMsg_nickName"),suffix:jq("#errorMsg_suffix")}},groups:{salutation:"salutation"},clickedElem:"undefined",formHeader:"undefined",listEditArea:{initFields:function(N){}},bindEvents:function(){bindEvents()},isValid:function(){return jq("#"+M+"form").valid()}};function C(){jq.each(F,function(O,N){rlAbstractForm.setData(N,"",undefined,M)})}function L(){var N={name:"personalDataSet",coreId:["profile"],getFieldsNames:B,getCacheFieldsNames:B,callbackLoadedList:J,callbackLoadedData:H,callbackBeforeSaveData:K,callbackAfterSaveData:E,callbackError:D,callbackClearData:C,callbackStartEdit:I,getDiffs:G};rlAbstractForm.registerComponent(N)}function I(N){if(N===M){jq("#"+M+"form").valid()}}function B(){return F}function J(P,O){rlAbstractForm.fillEnumList(P,O);if(P&&P==="salutation"&&O){var N=jq("#"+A.getListAreaId()+"form").closest("form");if(N){N.bmwValidate("modifyGroups",A.groups);N.bmwValidate("addGroupLabels",{salutation:jq("#salutationLabel")})}else{console.warn("personalDataSetComponent::initForm: form not found")}}}function H(O,N){rlAbstractForm.setData(O,N,undefined,M)}function K(P,O,N){return rlAbstractForm.getData(F,P,undefined,M)}function E(O,N){rlAbstractForm.setData(O,N,undefined,M)}function D(O,N){return rlAbstractFormFieldSet.onError(O,N)}function G(P,O){var N=O||{};var Q=K(jq.extend({},N),P);var R=rlAbstractFormFieldSet.getDiffs(F,N,Q);return R}return{__init__:function(){},registerComponent:function(){L()},initForm:function(R,Q){console.log("personalDataSetComponent::initForm: "+R);var N=rlPage.isEditMode()||rlPage.isDesignMode();if(!N){M=R;var P="#"+M;rlAbstractFormFieldSet.initDefaultActions(A);var O=jq("#"+A.getListAreaId()+"form").closest("form");if(O){O.bmwValidate("addErrorPlacements",A.errorPlacements());O.bmwValidate("modifyValidationMessages",Q)}else{console.warn("personalDataSetComponent::initForm: form not found")}jq.extend(jq.validator.messages,{required:function(){return jq(P+"RequiredFieldLabel").html()}});rlCoreServices.canUseImplicitLogin({canUse:function(S){if(S.firstName!=null){jq("#"+A.getListAreaId()+" :input[name='firstname']").val(S.firstName)}if(S.lastName!=null){jq("#"+A.getListAreaId()+" :input[name='lastname']").val(S.lastName)}}})}}}}();var rlPlannedPurchaseFS=function(){return{__init__:function(){},__start__:function(){},createFS:function(A,B){return rlPlannedPurchaseFSInstance(A,B)}}}();function rlPlannedPurchaseFSInstance(K,D){var J=CoreFormsBase.inheritanceFrom(rlFormFieldSet.createFS(K,D));var G=J.parent;J.typeName="rlPlannedPurchaseFS";var B=undefined;var C;function E(M){var L=K.find("option[value='"+M+"']");return(L.length>0)?L:undefined}J.getValueRenderers=function(L){L.plannedPurchase=function(R,Q,M,O){B=undefined;if(typeof Q==="undefined"||Q===null){O.text("--")}else{if(Q.isPlanned==="unknown"){O.text("--")}else{if(Q.isPlanned==="yes"){var P=H(Q.date);if(!C){var N=E(Q.date);if(typeof N!=="undefined"){P=N.text()}}O.text(P);B=Q.date}else{O.text(K.find("option[value='NOPP']").text())}}}};return L};J.getFieldMappers=function(L){L.plannedPurchase={get:I,set:A};return L};function I(N,L){var M=L.val();if(M===""){return null}else{if(M==="NOPP"){return{isPlanned:"no"}}else{if(M==="PREV"){return{isPlanned:"yes",date:B}}else{return{isPlanned:"yes",date:M}}}}}function A(O,N,M){M.find("option[value='PREV']").remove();if(typeof N==="undefined"||N===null){M.val("")}else{if(N.isPlanned==="unknown"){M.val("")}else{if(N.isPlanned==="yes"){var L=C?undefined:E(N.date);if(N.date==null){M.val("")}else{if(typeof L==="undefined"){B=N.date;F(M);M.val("PREV")}else{M.val(L.val())}}}else{M.val("NOPP")}}}}function F(L){J.addOptionToSelect(L,"PREV",H(B),1)}J.getValidationRules=function(L){L.dateMustBeInFuture=function(Q,M,P){var O=M.val();if(O===""||O==="NOPP"){return }else{if(O==="PREV"){O=B}}var N=O.split("-");if((new Date(N[0],N[1]-1,N[2]))<(new Date())){return{fieldName:Q,level:"ERROR",errorKey:"dateMustBeInFuture"}}};return L};function H(M){var L="n/a";if(typeof M!=="undefined"){var N=M.split("-");if(N.length==3){var M=new Date(N[0],N[1]-1,N[2]);return rlFormatter.formatMonthYear(M)}else{return L}}else{return L}}C=(J.getFieldsetProperties().showabsolutedate==="true");return J}var rlPlannedPurchaseIntervalSet=function(){var B="NOPP";var K="PREV";var W="";var R="purchasePlanned",P="plannedPurchase";var N=[R,P];var Q=[];var S=null;var C="";var J={getListAreaId:function(){return C},errorPlacements:function(){return{plannedPurchase:jq("#errorMsg_plannedPurchaseInterval")}},clickedElem:"undefined",formHeader:"undefined",listEditArea:{initFields:function(Y){}},bindEvents:function(){bindEvents()},isValid:function(){return jq("#"+C+"form").valid()}};var H=true;function T(){var Y={name:"plannedPurchaseIntervalSet",coreId:["profile"],getFieldsNames:L,callbackLoadedList:D,callbackLoadedData:I,callbackBeforeSaveData:O,callbackAfterSaveData:F,callbackError:E,callbackClearData:G,getDiffs:M};rlAbstractForm.registerComponent(Y)}function L(){return N}function G(){X();rlAbstractForm.setData("plannedPurchase",null,undefined,C)}function D(a,Z,Y){}function I(Z,Y){A(Z,Y)}function O(a,Z,Y){var b=rlAbstractForm.getData(["plannedPurchase"],undefined,C);if(b){b=b.plannedPurchase}else{b=W}if(b===W){a[R]="unknown";delete a[P]}else{if(b===B){a[R]="no";delete a[P]}else{if(b===K){if(K!==""){a[R]="yes";a[P]=S}}else{if(b!==K){a[R]="yes";a[P]=b}}}}return a}function F(Z,Y){A(Z,Y)}function E(Z,Y){return rlAbstractFormFieldSet.onError(Z,Y)}function M(a,Z){var Y=Z||{};var b=O(jq.extend({},Y),a);var c=rlAbstractFormFieldSet.getDiffs(N,Y,b);return c}function U(d){Q=[];var f=new Date();var j=f.getFullYear();var a=f.getMonth()+1;for(var b=0;b<d.length;b++){var h=d[b].key;var Z=d[b].value;var e;if(h==null){e=W}else{if(h==="0"){e=B}else{var g=parseInt(h);var Y=j+Math.floor((a+g)/12);var c=(a+g)%12;if(c==0){c=12;Y--}e=Y+"-"+(c<10?"0":"")+c+"-01"}}Q.push({key:e,value:Z,monthOffset:g})}X()}function X(){rlAbstractForm.fillEnumList("plannedPurchase",Q);if(Q[0].key===""){Q.shift()}}function A(c,Z){var Y=jq.browser&&jq.browser.msie&&jq.browser.msie===true;var a=jq("select[name='plannedPurchase']");if(c===P&&Z){var b=function(){var d=V(Z);if(d!=null){if(Y){a.each(function(e,g){var f=document.createElement("option");f.value=K;f.text=V(Z);g.add(f,1)})}else{a.find("option").first().after("<option value='"+K+"'>"+V(Z)+"</option>")}rlAbstractForm.setData(c,K,undefined,C);S=Z}else{rlAbstractForm.setData(c,keyPleaseSelectundefined,undefined,C);S=null}};if(H){b()}else{if(a.find("option[value='"+Z+"']").length>0){rlAbstractForm.setData(c,Z,undefined,C)}else{b()}}}if(c===R&&Z){if(Z==="no"){rlAbstractForm.setData("plannedPurchase",B,undefined,C);S=null}}}function V(Y){var Z=Y.split("-");return Z.length==3?Z[1]+" / "+Z[0]:null}return{__init__:function(){},__start__:function(){},initForm:function(b,a){console.log("plannedPurchaseIntervalSet::initForm: "+b);var Y=rlPage.isEditMode()||rlPage.isDesignMode();if(!Y){C=b;idPrefix="#"+C;rlAbstractFormFieldSet.initDefaultActions(J);jQuery.validator.addMethod("dateInFuture",function(f,d){var c=jq("select[name='plannedPurchase']").val();if((c==W)||(c==B)){return true}else{if(c==K){c=S}}var e=c.split("-");return(new Date(e[0],e[1]-1,e[2]))>=(new Date())});var Z=jq("#"+J.getListAreaId()+"form").closest("form");if(Z){Z.bmwValidate("addErrorPlacements",J.errorPlacements());Z.bmwValidate("modifyGroups",J.groups);Z.bmwValidate("modifyValidationMessages",a);jq("select[name='plannedPurchase']").rules("add",{dateInFuture:true,messages:{dateInFuture:a.plannedPurchase.dateInFuture}})}else{console.warn("plannedPurchaseIntervalSet::initForm: form not found")}jq.extend(jq.validator.messages,{required:function(){return jq(idPrefix+"RequiredFieldLabel").html()}})}},setIntervals:function(Y){U(Y)},setShowSelectedValueAsAbsoluteDate:function(Y){H=Y},registerComponent:function(){T()}}}();var rlPlayButton=function(){return{__init__:function(){jq("div.playButtonImage").each(function(){$button=jq(this);$button.click(function(){jq(".exploreStartContainerImage").slideUp("slow").slideDown("slow")})})}}}();var rlPolicyBaseFS=function(){function A(G,R){var L=CoreFormsBase.inheritanceFrom(rlFormFieldSet.createFS(G,R));var I=L.parent;L.typeName="rlPolicyCurrentFS";L.policyVersion=rlPolicyBaseFS.POLICY_VERSION_1;L.determinePolicyVersion=function(V){var V=jq(V);if(V.find("[data-policyversion='2.0']").length>0){L.policyVersion=rlPolicyBaseFS.POLICY_VERSION_2}};L.getValidationRules=function(V){V=I.getValidationRules(V);V.policyConsentAndUsages=function(Y,X,W){if(L.policyVersion==rlPolicyBaseFS.POLICY_VERSION_2){return M(Y,X)}};V.telephoneUsageRequiresPhoneNumber=function(d,Y,e){var f=G.find(".fieldSetEditMode input[name='TelephoneUsage']");var X=G.find(".fieldSetEditMode label[for='"+f.attr("id")+"']");var g=G.find("[data-usages*='telephone']");if(L.policyVersion===rlPolicyBaseFS.POLICY_VERSION_1){X.css("color","#000000")}if(L.policyVersion===rlPolicyBaseFS.POLICY_VERSION_1){if(f.length===0||!f.is(":checked")){return }}else{if(L.policyVersion===rlPolicyBaseFS.POLICY_VERSION_2){if(g.length===0||C(g)!==H){return }}}var c=G.parents(".formsContainer");var b=["phone","businessPhone","mobile","businessMobile"];for(var Z=0;Z<b.length;Z++){var a=c.find("[data-field='user.profile."+b[Z]+"'] input");if(a.length>0&&a.val()!=""){return }}if(R.isLoggedIn){var W=false;rlCoreServices.loadUserData({success:function(h){var j=h.profile;W=(j.phone||j.businessPhone||j.mobile||j.businessMobile)}});if(W){return }}if(L.policyVersion===rlPolicyBaseFS.POLICY_VERSION_1){X.css("color","#D20000")}else{if(L.policyVersion===rlPolicyBaseFS.POLICY_VERSION_2){B(g)}}jq("#telephoneRequiredActive").show();return{fieldName:d,level:"ERROR",errorKey:"telephoneUsageRequiresPhoneNumber",messageText:L.getFieldsetProperties()["telephonerequirederrortext"]}};return V};var U="undefined",H="consented",Q="revoked";var F="policyError";var O=".fieldSetViewMode .policyArea";var N=".fieldSetEditMode .policyText, .fieldSetEditMode .policyTextblock";L.renderPolicyViewMode=function(Y,X){var W=jq(X);W.find("[id]").attr("id","");W.find("[name]").attr("name","");W.find("script").remove();W.find("input").prop("disabled","disabled");var V=G.find(".fieldSetViewMode .policyArea");V.empty();V.append(W)};L.renderPolicyEditMode=function(Y,W,X){if(X){G.empty();G.append(jq(W).find(".policyTextblock"));G.attr("data-policyurl",Y)}else{var V=G.find(".fieldSetEditMode .policyText");V.html(W);V.attr("data-policyurl",Y)}T()};L.applyPolicy=function(V){J(V,G.find(O));J(V,G.find(N));T();P()};L.getPolicyFromEditMode=function(V){var W={consentedUsages:[],revokedUsages:[]};if(!V){V=G.find(N)}W.cmxUrl=V.attr("data-policyurl");V.find("[data-policyfield='usage']").each(function(Y,c){c=jq(c);var b=C(c);var X=c.attr("data-usages").split(",");for(var Z=0;Z<X.length;Z++){var a=K(X[Z]);if(a){if(b===H){W.consentedUsages.push({usageId:a})}else{if(b===Q){W.revokedUsages.push({usageId:a})}}}else{throw"Unsupported usage: "+X[Z]}}});return W};L.clearErrorStates=function(V){V.find("."+F).removeClass(F)};L.validateConsentAndUsages=M;L.getUsageState=C;function J(Y,X){X.find("input:checkbox,input:radio").prop("checked",false);X.find("[data-policyfield='consent']").find("input").prop("checked","checked").change().prop("disabled","disabled");var V=[];if(Y.revokedUsages){for(var W=0;W<Y.revokedUsages.length;W++){V[E(Y.revokedUsages[W].usageId)]=true}}X.find("[data-usages]").each(function(a,d){d=jq(d);var Z=jq(d).attr("data-usages").split(",");var c=true;for(var b=0;b<Z.length;b++){c=c&&!V[Z[b]]}D(d,c)})}function D(Y,W){var X=Y.attr("data-usagegui");if(X==="checkbox"){var Z=W;var V=Y.attr("data-usagecheckedmeans");if(V&&V===Q){Z=!W}Y.find("input:checkbox").prop("checked",Z?"checked":false)}else{if(X="radiobuttons"){if(W){Y.find("input[data-usagevalue="+H+"]").prop("checked","checked")}else{Y.find("input[data-usagevalue="+Q+"]").prop("checked","checked")}}else{throw"Unsupported policy GUI type: "+X}}}function C(Y){var X=Y.attr("data-consentgui")||Y.attr("data-usagegui");if(X==="checkbox"){var a=Y.find("input:checkbox").is(":checked");var W=Y.attr("data-usagecheckedmeans");if(W){if(W==="consented"){return a?H:Q}else{if(W==="revoked"){return a?Q:H}else{throw"Unsupported value for data-usagecheckedmeans: "+W}}}else{return a?H:Q}}else{if(X==="radiobuttons"){var V=Y.find("input:checked");if(V.length===0){return U}else{var Z=V.attr("data-consentvalue")||V.attr("data-usagevalue");if(Z===H){return H}else{if(Z===Q){return Q}else{throw"Unsupported value for data-usagevalue or data-consentvalue: "+Z}}}}else{throw"Unsupported policy GUI type: "+X}}}function M(X,W){P();var V=W.find("[data-policyfield='consent']");if(V.length>0&&C(V)!=H){B(V)}W.find("[data-policyfield='usage'][data-usagepermittedvalues]").each(function(Z,b){b=jq(b);var Y=b.attr("data-usagepermittedvalues").split(",");var a=C(b);if(jq.inArray(a,Y)==-1){B(b)}});if(G.find("."+F).length>0){return{fieldName:X,level:"ERROR",errorKey:"policyConsentAndUsages"}}}function P(){G.find(".fieldSetEditMode").find("."+F).removeClass(F)}function B(V){V.addClass(F)}function T(){G.find(".fieldSetEditMode").find("input").unbind().change(function(){jq(this).parents("."+F).removeClass(F)})}function K(V){var W={telephone:"TelephoneUsage",postal:"PostalUsage",email:"EmailUsage",emarketing:"EMarketingUsage",sms:"SmsUsage",fax:"FaxUsage",mms:"MmsUsage",tracking:"TrackingUsage"};return W[V]}function E(V){var W={TelephoneUsage:"telephone",PostalUsage:"postal",EmailUsage:"email",EMarketingUsage:"emarketing",SmsUsage:"sms",FaxUsage:"fax",MmsUsage:"mms",TrackingUsage:"tracking"};return W[V]}function S(){if(R&&R.allEvents){R.allEvents.subscribe(R.allEvents.names.PING_POLICY_PROVIDER,function(V){V.trigger(R.allEvents.names.PONG_POLICY_PROVIDER)})}}L.supportsInputCache=function(){return false};L.setData=function(V){I.setData(V);if(isDefined(V)&&isDefined(V.user)){R.allEvents.trigger(R.allEvents.names.USER_POLICY_CHANGED,V.user.policy)}};S();return L}return{__init__:function(){},__start__:function(){},POLICY_VERSION_1:"v1",POLICY_VERSION_2:"v2",createFS:function(B,C){return A(B,C)}}}();var rlPolicyCurrentLegacyFS=function(){function B(N,L,U){var X={};var V="true";var Q="false";var H="disabledUsages";var T="enabledUsages";var R="ignoreConsentState";var W;X.consentRequiredValidationRule=function(a,Z){var Y=L.find("input[name='consent']");if(Y.is(":checked")){Z.removeClass("missingConsent")}else{Z.addClass("missingConsent");return{fieldName:a,level:"ERROR",errorKey:"consentRequired"}}};X.policyCurrentRenderer=function(c,Y,b){var Z=Y.policyText;W=Y.policyUrl;if(Z){b.append(Z);P(b);F(b);G(b);var a=O(b);if(a.attr("id")==null){a.attr("id",U.fsId+"_policyConsent")}a.click(function(d){G(b)})}};X.getCurrentPolicyData=function(a,Z){var Y={cmxUrl:M(Z)?I():"",revokedUsages:A(false,Z),consentedUsages:A(true,Z)};return Y};function O(Y){return Y.find('input[name="consent"]')}function E(Y){return O(Y).hasClass(R)}function S(Y){var Z=O(Y);if(Z[0]){return Z[0].checked?V:Q}else{return Q}}function M(Y){return(S(Y)==V)}function I(){return W}function G(Y){if(!E(Y)){var Z=(S(Y)==V);if(!Z){F(Y)}J(Y,Z);K(Y,Z);D(Y,true)}}function F(Y){var Z=C(Y);jq.each(Z,function(a,b){if(!Z.hasClass("noUsageReset")){var c=jq(b);c.val([""])}})}function P(Y){var Z=O(Y);if(Z&&Z.hasClass("noConsentReset")){return }Z.val([""])}function J(Z,Y){var a=C(Z);jq.each(a,function(b,c){var d=jq(c);if(Y){d.parent().removeClass(H);d.parent().addClass(T)}else{d.parent().removeClass(T);d.parent().addClass(H)}})}function K(Z,Y){var a=C(Z);jq.each(a,function(b,c){c.disabled=!Y})}function D(Z,Y){var a=O(Z);if(a[0]){a[0].disabled=!Y}}return X}function C(D){return D.find('input[name*="Usage"]')}function A(D,F){var G="optOutUsage";var H=C(F);var E=[];jq.each(H,function(I,K){var J=jq(K).hasClass(G);var L=K.checked&&!J||!K.checked&&J;if(D&&L||!D&&!L){var M={usageId:K.name};E.push(M)}});return E}return{__init__:function(){},__start__:function(){},createInstance:function(E,D,F){return B(E,D,F)}}}();var rlPolicytext=function(){function B(){if((rlPage.isEditMode()||rlPage.isDesignMode())){var D=jq(".policyTextblock:first").html();jq(".copyAreaText").val(D);var C=jq(".infolayerPolicyLinkblock:first").html();jq(".copyAreaInfolayerPolicyLink").val(C);A()}}function A(){var C=jq(".infolayerPolicyTextblockEditMode:first").length>0;var D;if(C){D=jq(".infolayerPolicyTextblockEditMode:first").html()}else{D=jq(".infolayerPolicyTextblock").html()}jq(".copyAreaInfolayerPolicyText").val(D)}return{__init__:function(){B()}}}();var rlPrintButton=function(){var C="";var B="";var A={EVENTS:{EVENT_PREPARE_FOR_PRINTING:"EVENT_PREPARE_FOR_PRINTING"}};return{__start__:function(){},__init__:function(){},printContent:function(D){if(window.rlCoreServices&&window.rlCoreServices.trackEventAsClick){window.rlCoreServices.trackEventAsClick("showroomButtonPrint","genericAction/button/click")}jq(window).trigger(A.EVENTS.EVENT_PREPARE_FOR_PRINTING);window.print();return false},EVENTS:A.EVENTS}}();var rlProductOffer=function(){function updateFinancingOfferItems(){var location=window.location.pathname;var url=location.substring(0,location.lastIndexOf("."))+".siblings.html";jq.ajax({url:url,context:document.body,success:function(data,textStatus){processFinancingOfferItems(data)}})}function processFinancingOfferItems(data){var $financingOfferArea=jq("#financingOfferResults");$financingOfferArea.empty();jq.each(eval(data),function(key,value){var $containerDiv=jq('<div class="foContainer"></div>');var $spinnerDiv=jq('<div class="financingOfferItemSpinner"></div>');$financingOfferArea.append($containerDiv);var url=value.path;jq.ajax({url:url,success:function(data,textStatus){var $ajaxContent=jq(data);$containerDiv.append($ajaxContent);rlProductTile.injectAnimation($containerDiv);$spinnerDiv.animate({opacity:"hide"},250,function(){$spinnerDiv.remove()});if(key==0&&jq(".foContainer .mldWrapperContainer").length>0){setTimeout(function(){rlProductTile.highlightTile(jq(".foContainer:first-child"));rlMultiLevelDisclaimer.show({content:jq(".foContainer:first-child").find(".mldWrapperContainer").html()})},200)}$financingOfferArea.css("height","auto");if(typeof rlSalesBar!=="undefined"){rlSalesBarContextSensitive.updateSalesBar(false)}},error:function(jqXHR,textStatus,errorThrown){$containerDiv.remove()}});setTimeout(function(){if(jq(".financeOfferItem",$containerDiv).length==0){$containerDiv.append($spinnerDiv)}},100);$financingOfferArea.css("height","auto")})}return{__init__:function(){updateFinancingOfferItems()},__start__:function(){}}}();var rlRegisterButton=function(){var F;var A;var D=false;var E=undefined;function B(H,I){D=I;if(A){var G=jq("#"+A);if(G&&G.length>0){G[0].disabled=I;G.toggleClass("buttonGrey",I);G.toggleClass("buttonBlue",!I)}}}function C(){try{var H=window.top.location.protocol;return(window.location.protocol!==H)}catch(G){return true}}return{__init__:function(){},__start__:function(){},initButton:function(H,G){A=H;E=G},setNextPagePath:function(G){F=G},register:function(){var I=function(){rlBmwStateOverlay.hideState();if(F){rlGlassPaneLayer.switchContent({url:F,width:"w2",onClose:function(){window.location.reload()},onAfterAjaxContentLoaded:function(){if(window.reloadPageAfterRegistration){var J=jq(".glassPaneLayerFooterContent").find(".feedbackLink");J.attr("href","javascript:void(0)");J.click(function(){window.location.reload()})}}})}};var G=function(){rlBmwStateOverlay.hideState()};var H=function(){rlBmwStateOverlay.addDitherToContainer({_containerId:"registrationForm",container:jq(".glassPaneLayerScrollableArea")});rlBmwStateOverlay.showLoadingState()};rlAbstractUserManagementForm.register({formId:"registerForm",leadContext:E,onSuccess:I,onError:G,onBeforeRegister:H})}}}();var rlRevokepolicy=function(){var D=undefined;var B=false;var C=undefined;function F(){if(typeof (D)==="undefined"){D=("true"===rlJQuery_queryParams.getQueryParam("cdpUser"))}if(!B){K()}else{L()}}function K(){if(D===true){jq(".gplContentHeadline").find(".headlineNormal").text(jq(".gplContentBody").find("#DeleteDialogCDPHeadline").text());jq(".gplContentBody").find("#DeleteDialogCDPCopy").show()}else{jq(".gplContentHeadline").find(".headlineNormal").text(jq(".gplContentBody").find("#DeleteDialogHeadline").text());jq(".gplContentBody").find("#DeleteDialogCopy").show()}jq("#revokePolicyButton").click(H);jq("#cancelRevokePolicyButton").click(J)}function L(){jq(".glassPaneLayerScrollableArea").empty();B=false;var M=jq("<iframe/>").attr("src",GLOBAL_CMX_SSL_SERVER+GLOBAL_REVOKE_POLICY_PAGE_PATH+"?wcmmode=disabled").attr("width","100%").attr("height","200px").attr("name","revokePolicyIFrame").attr("frameborder","0").attr("vspace","0").attr("hspace","0").attr("marginwidth","0").attr("marginheight","0").attr("scrolling","no").attr("noresize","noresize");jq(".glassPaneLayerScrollableArea").append(M)}function H(){var M={cmxUrl:C,onLoggedOut:I,onError:A};E().revokePolicy(M)}function I(){E().closeDialog()}function A(){rlErrorService.handleError({actor:rlErrorService.ACTOR_USER})}function J(){console.log("Delete account cancelled");E().closeDialog()}function E(){return(typeof (G())!=="undefined")?G().rlLoginservice:rlLoginservice}function G(){return top.frames.loginIFrame}return{__init__:function(){},__start__:function(){},domLoaded:function(){F()},setPolicyUrl:function(M){C=M},setUseIFrame:function(M){B=M},setCdpUser:function(M){D=M}}}();rlRfxBaseDataSink=function(){function A(){var C=CoreFormsBase.inheritanceFrom(CoreFormsBase.createBaseType());var E=C.parent;C.typeName="rlRfxBaseDataSink";C.prepareData=function(I){var H=jq.extend(true,{},I);if(H.user){rlUserMgmtConverter.objectToArray(H.user,"vehicleInterests");rlUserMgmtConverter.objectToArray(H.user,"technologyInterests");if(H.user.profile){if(H.user.profile.plannedPurchase){rlUserMgmtConverter.translatePlannedPurchaseToRequest(H.user.profile)}}}H=B(H);H=D(H);if(H.user.profile.preferredCommunication){var G=C.typeName.replace("rl","").replace("DataSink","").toUpperCase();var J="preferredsaleschannel_bi/"+H.user.profile.preferredCommunication+"@"+G;var F=rlEventTracker.create();F.trackCustomEvent(J,"rfxAction/formfield")}return H};function D(G){for(var F in G){if(typeof G[F]=="object"){G[F]=D(G[F])}else{if(G.hasOwnProperty(F)&&F.indexOf("GUID")!=-1){console.log(F);delete G[F]}}}return G}function B(F){F.campaignContext={};if(typeof window.bmw_campaign_id!="undefined"&&window.bmw_campaign_id!=-1){F.campaignContext.treatmentId=window.bmw_campaign_id;F.campaignContext.campaignId=window.bmw_campaign_id}if(typeof window.bmw_campaign_offerid!="undefined"&&window.bmw_campaign_offerid!=-1){F.campaignContext.offerId=window.bmw_campaign_offerid}if(typeof window.bmw_campaign_responseType!="undefined"&&window.bmw_campaign_responseType!=-1){F.campaignContext.responseType=window.bmw_campaign_responseType}if(typeof window.bmw_campaign_leadContext!="undefined"&&window.bmw_campaign_leadContext!=-1){F.campaignContext.leadContext=window.bmw_campaign_leadContext}return F}C.save=function(F){};C.handleErrors=function(H,G,F){var I=H.error||H;if(typeof G=="function"){G(I,JSON.stringify(H,null,2))}return I};C.handleValidationErrors=function(F,H){var G=rlUserMgmtConverter.translateValidationMsgsFromResponse(F);if(typeof H=="function"){H(G)}return G};return C}return{__init__:function(){},__start__:function(){},createDataSink:function(){return A()}}}();var rlRfxDloForm=function(){function A(E,G){var L=CoreFormsBase.inheritanceFrom(rlFormBase.create(E,G));var J=L.parent;L.typeName="rlRfxDloForm";L.onReady=function(O){J.onReady(O);G.dloId=E.find(".dloBaseFS[data-dloid]").attr("data-dloid");C();rlDloSubBrandService.setSubBrand(G.subBrand,G.dloId);rlDloSubBrandService.addListener(G.dloId,I);if(B()){F()}M();L.switchToEditMode()};L.onClosing=function(){rlDloSubBrandService.removeListener(G.dloId,I)};L.switchToEditMode=function(){jq.each(L.getFieldSetsById(),function(P,O){O.switchToEditMode(false)})};L.getUseCaseMetaDataRoot=function(){return""};L.getContext=function(){return""};function K(){return rlPage.isEditMode()||rlPage.isDesignMode()}function C(){try{if(rlMandator.getCountry()=="NL"&&!K()){_stq=_stq||[];_stq.push(["resetTags"]);_stq.push(["setPageStructure","nl","popup","dlo","show"]);_stq.push(["loadTags"])}}catch(O){console.log("NL-Tracking error in rfxDloForm:"+O)}}function F(){var T=rlDloSubBrandService.getSubBrand(G.dloId);var Q=T==="BM"?"BI":"BM";var R=jq(".subBrandSwitchArea");if(R.length>0){R.remove()}R=jq("<div />").addClass("subBrandSwitchArea").addClass("clearfix");var U=jq("<div />").addClass("subBrandSwitchAreaPart");var P=jq("<div />").addClass("subBrandLabel").text(dloSubBrandPages[T].subBrandLabel);U.append(P);var O=jq("<div />").addClass("subBrandSwitchAreaPart");var S=jq("<a href='javascript:void(0)'></a>");S.text(dloSubBrandPages[Q].formSwitchLabel);S.addClass("linkArrow13px");S.click(function(){H(Q)});O.append(S);if(T==="BM"){R.append(U,O)}else{if(T==="BI"){R.append(O,U)}}if(N()){E.parents(".requestFormWrapper").prepend(R)}else{jq(".gplnContentHeader .glassPaneLayerHeaderContent").css("padding-top","10px").prepend(R);jq(".gplnAjaxContent h1.headlineh1Mixed").css("margin-top","2px")}}function N(){var O=E.parents('.pageContentPage[id*="DealerSelection"]');return O.length>0}function I(O,P){M();if(B()){F()}}function H(O){jq(window).trigger(rlTrackingListener.EVENTS.EVENT_TRACKING_LISTENER_NOTIFICATION,{id:rlTrackingListener.FORM_IDS.SWITCH_LAYER,info:E.data(),type:rlTrackingListener.TRACKING_TYPES.FORM});rlDloSubBrandService.setSubBrand(O,G.dloId)}function M(){var P=rlDloSubBrandService.getSubBrand(G.dloId);if(N()){var O=E.parents(".requestFormWrapper");O.removeClass("brand-bmwi");if(P==="BI"){O.addClass("brand-bmwi")}}else{if(rlComponentLoader.isRunning("glassPaneLayerNext")){rlGlassPaneLayerNext.subbrandChange(P)}}}function B(){var Q=rlContextObject.getContextObject();var P=isDefined(Q.vehicle.configId)||isDefined(Q.vehicle.vehicleId);var O=rlRfxSubBrandService.computeUniqueSubBrand(rlRfxSubBrandService.outletRfxTypes.DLO);var R=O!==null&&rlContextObject.isDealer();return !jq.isEmptyObject(dloSubBrandPages)&&!P&&!R}function D(){if(N()){E.attr("data-doNotTrack",true)}E.attr("data-subBrand",G.subBrand)}D();return L}return{__init__:function(){},__start__:function(){},create:function(B,C){C.subBrand=rlDloSubBrandService.getSubBrand("solo");return A(B,C)}}}();var rlRfxLandingPageDelegate=function(){return{__init__:function(){},__start__:function(){},initComponent:function(){var A=function(F,D){if(isUndefined(D)){D=-1}var E=RegExp("[?&]"+F+"=([^&]*)").exec(window.location.search);return(E&&decodeURIComponent(E[1].replace(/\+/g," ")))||D};var C=A("entryType");if(C==-1){return }if(window.location.protocol!=="https:"){window.location.protocol="https";return }var B={distributionPartnerId:A("distributionPartnerId"),outletId:A("outletId"),configId:(A("configId")!=-1)?A("configId"):undefined,bodyTypeId:A("bodyTypeId"),seriesId:A("seriesId"),subBrand:A("subBrand","BM"),modelRangeId:A("modelRangeId"),materialCode:A("materialCode"),campaignId:A("campaignId"),campaignOfferId:A("campaignOfferId"),campaignTreatmentId:A("campaignTreatmentId"),campaignResponseType:A("campaignResponseType"),leadContext:A("leadContext"),campaignParticipationForm:A("campaignUrl")};if(B.seriesId!=-1){B.subBrand=B.seriesId.toLowerCase()==="i"?"BI":"BM"}switch(C.toLowerCase()){case"rfo":console.log("request type rfo");rlUserDialog.showRequestRFO(B);break;case"rfp":console.log("request type rfp");rlUserDialog.showRequestRFP(B);break;case"tda":console.log("request type tda");rlUserDialog.showRequestTDA(B);break;case"rfi":console.log("request type rfi");rlUserDialog.showRequestRFI(B);break;case"rfiprint":console.log("request type rfiprint");rlUserDialog.showRequestRfiPrint(B);break;case"rfidownload":console.log("request type rfidownload");rlUserDialog.showRequestRfiDownload(B);break;case"dlo":console.log("request type dlo");rlUserDialog.showRequestDLO(B);break;case"rfa":console.log("request type rfa");rlUserDialog.showRequestRFA({});break;case"contact":console.log("request type contact form");rlUserDialog.showContactForm({});break;case"rfc":console.log("request type campaign form");rlUserDialog.showCampaignParticipationDialog(B);break;default:console.log("wrong request type provided: "+C)}}}}();var rlRfxRfoForm=function(){function A(D,E){var B=CoreFormsBase.inheritanceFrom(rlRfxForm.create(D,E));var C=B.parent;B.typeName="rlRfxRfoForm";B.getUseCaseMetaDataRoot=function(){return"rfoRequest"};B.getContext=function(){return"RFO"};B.getDataSink=function(F){return rlRfoDataSink.createDataSink(F)};B.onReady=function(F){C.onReady(F);var G=rlContextObject.getContextObject().vehicle.configId;if(typeof G==="undefined"&&typeof window.rfxContextParams!="undefined"){G=window.rfxContextParams.configId}if((typeof G=="undefined"||G=="")&&!B.isUseMock()){B.switchToResultMode({},"RFO not allowed without config Id")}};return B}return{__init__:function(){},__start__:function(){},create:function(B,C){if(isDefined(window.rfxContextParams)&&isDefined(window.rfxContextParams.subBrand)){B.attr("data-subbrand",window.rfxContextParams.subBrand)}return A(B,C)}}}();var rlRfxRfoSpecialCustomerForm=function(){function A(D,E){var N=CoreFormsBase.inheritanceFrom(rlRfxRfoForm.create(D,E));var L=N.parent;N.typeName="rlRfxRfoSpecialCustomerForm";var F=undefined;var J=undefined;var C=undefined;N.onReady=function(){L.onReady();if(!N.isInCqEditMode()&&J&&!J.hasFormDataWithUserInput(N)){J.setFormData(F.collectInputCacheData())}};N.getDataSink=function(O){return rlRfoSpecialCustomerDataSink.createDataSink(O)};N.showSuccessView=function(Q,P){var O=rlEspForm.getCurrentInstance().getConfiguration();var R=E&&E.isLoggedIn;rlEspCustomizations.isConfigSaved(O,R).done(function(S){L.showSuccessView(Q,function(){P&&P();K(O,S)})})};function H(){J=rlEspBasket.getCurrentInstance()}function G(){F=rlEspInputCache.create(N,D,{});F.addEspInputCacheToForm()}function K(P,S){var O=jq(".rfxSaveConfigButton");var R=jq(".rfxViewConfigButton");var Q=jq(".rfxBackToConfigButton");O.unbind("click",I).click(P,I);R.unbind("click",B).click(P,B);Q.unbind("click",M).click(P,M);if(N.isInCqEditMode()){O.show();R.show();Q.show();return }if(S){O.hide();R.show()}else{R.hide();O.show()}}function B(O){window.location.href=rlEspBasket.getCurrentInstance().addConfigIdToURL(GLOBAL_MY_CONFIGURATIONS_URL,O.data.configId,true)}function I(P){var O={configId:P.data.configId};rlUserDialog.showNccSave(O)}function M(O){window.location.href=O.data.accessByIdUrl.value}N.getEmptyFormInputCacheData=function(){return C};N.setEmptyFormInputCacheData=function(O){C=O};N.init=function(){L.init();H();G()};return N}return{__init__:function(){},__start__:function(){},create:function(B,C){return A(B,C)}}}();var rlRfxViewHelper=function(){var A="hide";var H="show";var B={hide:{settings:{opacity:A,height:A},duration:400},show:{settings:{opacity:H,height:H},duration:700}};function F(I,J){J=E(J,H);I=D(I,H);I.animate(B.show.settings,{duration:B.show.duration,complete:J})}function G(I,J){J=E(J,A);I=D(I,A);I.animate(B.hide.settings,{duration:B.hide.duration,complete:J})}function E(I,J){var K;if(typeof I!=="function"){I=function(){}}K=function(){I(jq(this))};return K}function D(I,J){if(typeof I==="string"){I=jq(I)}if(I.length==0){console.warn("rfxViewHelper: No Element found.")}if(J===A){I=I.filter(":visible")}else{if(J===H){I=I.filter(":hidden")}}return I}function C(I){setTimeout(function(){var J=I.find(":input").filter(":visible");if(J.length>0){J.get(0).focus()}},500)}return{__init__:function(){},hideElement:function(I,J){G(I,J)},hideElements:function(I,J){G(I,J)},hide:function(I,J){G(I,J)},showElement:function(I,J){F(I,J)},showElements:function(I,J){F(I,J)},show:function(I,J){F(I,J)},focusOnFirstInputField:function(I){C(I)}}}();var rlRoutePlanning=function(){var A="/etc/designs/bmwnext/apps/bmwnext/requests/static/parComponents/formFieldSets/dealerHandling/dloMapFS/dloMapBaseFS/";function B(I,T){var Q=CoreFormsBase.inheritanceFrom(rlFormFieldSet.createFS(I,T));var N=Q.parent;Q.typeName="rlDealerSearchBaseFS";var V;var R;var C;var J;Q.init=function(){N.init();U();L()};var S=function(){console.error("dloRoute Function not initialized in rlRoutePlanning!")};function F(Y,Z){M();I.find("#rfxDloTo").html(Y.name+"<br />"+Y.street+"<br />"+Y.postalCode+" "+Y.city);I.find("#rfxDloFrom").focus();J=Y.key;S=Z}function K(c,e){var f=0;M();X(e);var d=I.find("#dloRouteResult");if(isUndefined(c)||c.routes.length==0){return }var Z="";if(c.routes.length>1){var a=Q.getFieldsetProperties().suggestedroutelabel;d.append(jq("<div/>").addClass("routeProposalText").html(a));Z=P(c,f)}else{if(c.routes.length===1){var Y=c.routes[0];Z=jq("<div />").addClass("routealternativesEntry routealternativesSelected clearfix").html(jq("<span/>").addClass("routealternativeLabel").html(Y.summary));var b=G(Y.legs[0]);Z.append(b)}}d.append(Z);I.find(".routealternativesEntry:last").addClass("last");I.find(".dloRouteplanningControl").addClass("hasResult");O(c.routes[f]);D(c,f)}function P(c,e){var d=jq("<div/>");for(var b=0,Z=c.routes.length;b<Z;b+=1){route=c.routes[b];var Y=jq("<div />").addClass("routealternativesEntry clearfix").attr("data-routeindex",b);Y.html(jq("<span/>").addClass("routealternativeLabel").html(route.summary));if(b==e){Y.addClass("routealternativesSelected")}var a=G(route.legs[0]);Y.append(a);Y.click(function(){jq(".routealternativesSelected").removeClass("routealternativesSelected");jq(this).addClass("routealternativesSelected");e=parseInt(jq(this).attr("data-routeindex"));O(c.routes[e]);D(c,e)});d.append(Y)}return d}function G(Y){var Z=jq("<span/>").addClass("routealternativeDetails");var b=jq("<span/>").addClass("routealternativeDistance").html(Y.distance.text);var a=jq("<span/>").addClass("routealternativeDuration").html(Y.duration.text);Z.append(b);Z.append(", ");Z.append(a);return Z}function O(c){var e=c.legs[0];var a=jq("<div />").addClass("routedirectionsEntry");var g=Q.getFieldsetProperties().printroute;var h=jq("<div id='dloRouteResultPrint' class='clearfix' />").append(jq("<div/>").addClass("baseIconSprite baseIconSizeSmall spriteIconPrintSmall printRouteIcon")).append(jq("<a/>").attr("href","javascript:void(0);").addClass("link13px").html(g)).click(function(){window.print()});a.append(h);a.append(jq("<div />").addClass("routeEntryStart").addClass("clearfix").append(jq("<img/>").attr("src",A+"dlo_route_startpin.png").addClass("routeA")).append(jq("<div />").addClass("routeEntryAddress").append(e.start_address)));for(var Z=0,b=e.steps.length;Z<b;Z+=1){var Y=e.steps[Z];var f=jq("<div />").addClass("routedirectionsStep");var d=jq("<div />").addClass("clearfix");d.append(jq("<div />").addClass("routedirectionsNumber").html((Z+1)));d.append(jq("<div />").addClass("routedirectionsInstructions").html(Y.instructions));f.append(d);f.append(jq("<div />").addClass("routedirectionsDistance").html(Y.distance.text));a.append(f)}a.append(jq("<div />").addClass("routeEntryEnd").addClass("clearfix").append(jq("<img/>").attr("src",A+"dlo_route_targetpin.png").addClass("routeB")).append(jq("<div />").addClass("routeEntryAddress").append(e.end_address)));a.append(jq("<div />").addClass("routedirectionsCopyrights").html(c.copyrights));jq("#dloRouteResult .routedirectionsEntry").remove();jq("#dloRouteResult").append(a)}function D(a,Y){var Z=rlDloIcons.getDirectionIcons();if(isDefined(Z)){R=W(a.routes[0].legs[0].start_location,Z.start,"title");C=W(a.routes[0].legs[0].end_location,Z.end,"title")}if(isDefined(V)){if(V.getDirections()!=a){V.setDirections(a)}V.setRouteIndex(Y)}}function W(Y,Z,a){return new google.maps.Marker({position:Y,map:V.getMap(),icon:Z,title:a})}function M(){I.find(".dloRouteplanningControl").removeClass("hasResult");I.find("#dloRouteResult, #dloRouteError").empty()}function H(){if(V!=null){V.setMap(null);V.setPanel(null);V=null}if(R!=null){R.setMap(null);R=null}if(C!=null){C.setMap(null);C=null}}function X(Y){if(V!=null){V.setMap(null);V.setPanel(null)}V=new google.maps.DirectionsRenderer({map:Y,suppressMarkers:true,polylineOptions:{strokeColor:"#1C69D4",strokeOpacity:0.95,strokeWeight:5}})}function U(){T.formEvents.subscribe(T.allEvents.names.START_ROUTE_PLANNING,function(Y,Z){F(Z.dealer,Z.callback)});T.formEvents.subscribe(T.allEvents.names.SHOW_ROUTE_RESULTS,function(Y,Z){K(Z.results,Z.map)});T.formEvents.subscribe(T.allEvents.names.CLEAR_ROUTE_RESULTS,function(Y,Z){H()})}function L(){jq("#rfxDloFrom").keypress(function(Y){if(Y.keyCode=="13"){Y.preventDefault();jq(this).blur();E()}});jq("#rfxDloRouteCalculateBtn a").click(function(Y){Y.preventDefault();E()});jq(".smallAccordion-content .dloRouteplanningControl").unbind("mousewheel").mousewheel(function(Y,b){var a=30;if(jq(this).scrollTop()>=0){var Z=jq(this).scrollTop()-(b*a);if(b>0&&Z<0){jq(this).scrollTo(0)}else{jq(this).scrollTo(jq(this).scrollTop()-(b*a))}}Y.preventDefault();return false})}function E(){var Y=jq("#rfxDloFrom").val();S(Y,J)}return Q}return{__init__:function(){},__start__:function(){},createFS:function(C,D){return B(C,D)}}}();var rlSalesBarAnimation=function(){var _elemSalesBar;var _elemSalesBarPanel;var _elemSalesBarPanelContent;var _elemSalesBarReference;var _elemFooter;var _elemTopLine;var _elemMLD;var _elemHighLowSwitchMarker;var salesBarPanelStatus="closed";var salesBarReferenceHeight=0;var salesBarPosition=0;var footerPosition=0;var highLowSwitchMarkerPosition=0;var footerPositionFromBottom;var isInitAnimation=true;var iAmInMotion=false;var salesBarPositionStatus;var buttonContext;var displayLog=false;var logDetailLevel=2;var logComp="salesBarAnimation";var configId=null;var saveListeners=[];var deviceAgent=navigator.userAgent.toLowerCase();var isMobileDevice=deviceAgent.match(/(iphone|ipod|ipad|android)/);var animationLongDuration=700;var animationShortDuration=400;var animationInterval=300;var animationEasing="easeInOutQuad";var animationTimer=new Date();var sbTimer;var sequenceType;var sequenceID=0;var _isDisplayed=false;var isAuthorMode=rlPage.isEditMode()||rlPage.isDesignMode();function showLog(logTXT,type,detailLevel){if(!type){type="log"}if(!detailLevel){detailLevel=0}if(displayLog===true){if(detailLevel<=logDetailLevel){if(!jq.browser.msie){window.console[type](logTXT)}else{window.console.log(logTXT)}}}}function getUrlVar(key){var result=new RegExp(key+"=([^&]*)","i").exec(window.location.search);return result&&result[1]||""}function isEquals(a,b){if(!b){return false}if(a.visibleButtonLabels.length!=b.visibleButtonLabels.length){return false}var labelLength=a.visibleButtonLabels.length;for(var labelID=0;labelID<labelLength;labelID++){if(jq.inArray(a.visibleButtonLabels[labelID],b.visibleButtonLabels)==-1){return false}}return true}function isNccPage(){return rlContextObject.getIsNCC()}var seqs={show:["updateSalesBarPanel","showSalesBar","fadeInSalesBarPanel"],updateTest:["fadeOutSalesBarPanel","hideSalesBar","updateSalesBarPanel","showSalesBar","fadeInSalesBarPanel"],update:["fadeOutSalesBarPanel","updateSalesBarPanel","showSalesBar","fadeInSalesBarPanel"]};function runSequence(type){_isDisplayed=false;if(type!=undefined){sequenceType=type;sequenceID=0}if(sequenceID==0){rlCompLog.showLog("runSequence","group",2,logComp,displayLog,logDetailLevel);rlCompLog.showLog("complete sequence","time",2,logComp,displayLog,logDetailLevel)}else{rlCompLog.showLog("part "+sequenceID+" sequence needs","timeEnd",2,logComp,displayLog,logDetailLevel);rlCompLog.showLog("runSequencePart","groupEnd",2,logComp,displayLog,logDetailLevel)}var sequence=seqs[sequenceType][sequenceID];sequenceID++;rlCompLog.showLog("start part "+sequenceID+": "+sequence+" from sequence: "+sequenceType,"info",2,logComp,displayLog,logDetailLevel);rlCompLog.showLog("runSequencePart","group",2,logComp,displayLog,logDetailLevel);rlCompLog.showLog("part "+sequenceID+" sequence needs","time",2,logComp,displayLog,logDetailLevel);if(sequence){var seqLength=sequence.length;eval(sequence+"(true)")}else{rlCompLog.showLog("part_sequence","timeEnd",2,logComp,displayLog,logDetailLevel);rlCompLog.showLog("complete sequence","timeEnd",2,logComp,displayLog,logDetailLevel);rlCompLog.showLog("runSequence","groupEnd",2,logComp,displayLog,logDetailLevel);_isDisplayed=true}}function fadeOutSalesBarPanel(){_elemSalesBarPanel.animate({opacity:0},animationShortDuration,function(){updateSalesBar();runSequence()})}function hideSalesBar(){salesBarPanelStatus="closed";if(salesBarPositionStatus=="fixed"){_elemSalesBar.animate({bottom:-10},animationLongDuration,function(){})}closeElem(".salesBarDock .salesBarPanel",0)}function updateSalesBarPanel(){jq(".salesBarPanelContent .genericSalesbar a").css("display","none");jq(".salesBarPanelContent .conditionalSalesbar a").css("display","none");rlCompLog.showLog(buttonContext,"info",2,logComp,displayLog,logDetailLevel);for(var i=0;i<buttonContext.visibleButtons.length;i++){buttonContext.visibleButtons[i].find("div").html(buttonContext.visibleButtonLabels[i]);buttonContext.visibleButtons[i].css("display","table-cell")}runSequence()}function showSalesBar(){salesBarPanelStatus="open";if(_elemSalesBarPanelContent.height()>0&&buttonContext.isSalesbarVisible&&!isNccPage()){openElem(".salesBarDock .salesBarPanel",41+_elemSalesBarPanelContent.height());repositionSalesBar()}else{if(buttonContext.isSalesbarVisible&&isNccPage()){showTopLine();if(_elemSalesBarPanelContent.height()>0){openElem(".salesBarDock .salesBarPanel",41+_elemSalesBarPanelContent.height());repositionSalesBar()}else{rlCompLog.showLog("no button configuration available!","error",1,logComp,displayLog,logDetailLevel);openElem(".salesBarDock .salesBarPanel",9);repositionSalesBar()}}else{rlCompLog.showLog("no button configuration available!","error",1,logComp,displayLog,logDetailLevel)}}if(!buttonContext.isSalesbarVisible){rlCompLog.showLog("isSalesbarVisible is FALSE","error",1,logComp,displayLog,logDetailLevel)}}function showTopLine(){openElem("#salesBarTopLineWrapper",27);setTimeout(function(){jq("#salesBarTopLineWrapper").animate({opacity:1},animationLongDuration)},animationLongDuration)}function repositionSalesBar(){if(footerPosition<54&&footerPosition>=0){_elemSalesBar.animate({bottom:-71+(_elemSalesBarPanel.height()-footerPosition)},animationLongDuration,function(){updateSalesBar()})}else{if(salesBarPositionStatus=="fixed"){_elemSalesBar.animate({bottom:-22},animationLongDuration,function(){updateSalesBar()})}else{_elemSalesBar.animate({bottom:8},animationLongDuration,function(){updateSalesBar()})}}}function fadeInSalesBarPanel(){_elemSalesBarPanel.animate({opacity:1},animationShortDuration,function(){rlCompLog.showLog("salesBar is visible","log",0);isInitAnimation=false;runSequence()})}function fadeInFooter(){if(_elemFooter.css("opacity")<1){setTimeout(function(){_elemFooter.animate({opacity:1},animationLongDuration,function(){rlCompLog.showLog("footer is visible","log",0,logComp,displayLog,logDetailLevel)})},1000)}}function updateSalesBar(){if(isMobileDevice){return }fSBarPosBottom()}function updateSalesBarContext(newContext){rlCompLog.showLog(newContext,"info",0,logComp,displayLog,logDetailLevel);if(isEquals(newContext,buttonContext)){rlCompLog.showLog("No relevant changes in contextObject","info",0,logComp,displayLog,logDetailLevel);return }buttonContext=jq.extend(true,{},newContext);setTimeout(function(){if(salesBarPanelStatus=="open"){runSequence("update")}else{runSequence("show")}},1000)}function updateSalesBarContextTest(newContext){buttonContext=newContext;setTimeout(function(){runSequence("updateTest")},1000)}function fSBarPosBottom(){salesBarPosition=-_elemSalesBar.offset().top+jq(document).scrollTop()+jq(window).height()-_elemSalesBar.height();footerPosition=-_elemFooter.offset().top+jq(document).scrollTop()+jq(window).height();highLowSwitchMarkerPosition=-jq(".highbandLowbandMaker").offset().top+jq(document).scrollTop()+jq(window).height();rlCompLog.showLog("salesBarPosition: "+salesBarPosition,"log",2,logComp,displayLog,logDetailLevel);rlCompLog.showLog("footerPosition: "+footerPosition,"log",2,logComp,displayLog,logDetailLevel);if(!isMobileDevice){footerPositionFromBottom=-80;if(isNccPage()){footerPositionFromBottom=-92}if(salesBarPosition<=-72&&salesBarPositionStatus!="fixed"&&salesBarPanelStatus!="closed"){_elemSalesBar.removeClass("salesBarStatic").addClass("salesBarFixed").css("bottom","-22px");salesBarPositionStatus="fixed";rlCompLog.showLog("salesBarPositionStatus A: "+salesBarPositionStatus,"log",1,logComp,displayLog,logDetailLevel)}else{if(footerPosition>=footerPositionFromBottom&&salesBarPositionStatus!="static"&&salesBarPanelStatus!="closed"&&!isInitAnimation){_elemSalesBar.removeClass("salesBarFixed").addClass("salesBarStatic").css("bottom","8px");salesBarPositionStatus="static";rlCompLog.showLog("salesBarPositionStatus B: "+salesBarPositionStatus,"log",1,logComp,displayLog,logDetailLevel)}else{if(footerPosition>-72&&salesBarPositionStatus!="static"&&salesBarPanelStatus!="closed"){_elemSalesBar.removeClass("salesBarStatic").addClass("salesBarFixed").css("bottom","-22px");salesBarPositionStatus="fixed";rlCompLog.showLog("salesBarPositionStatus C: "+salesBarPositionStatus,"log",1,logComp,displayLog,logDetailLevel)}}}if(salesBarPosition<=-10&&salesBarPositionStatus!="fixed"&&salesBarPanelStatus!="open"){_elemSalesBar.removeClass("salesBarStatic").addClass("salesBarFixed").css("bottom","-10px");salesBarPositionStatus="fixed";rlCompLog.showLog("salesBarPositionStatus D: "+salesBarPositionStatus,"log",1,logComp,displayLog,logDetailLevel)}else{if(footerPosition>=-10&&salesBarPositionStatus!="static"&&salesBarPanelStatus!="open"){_elemSalesBar.removeClass("salesBarFixed").addClass("salesBarStatic").css("bottom","8px");salesBarPositionStatus="static";rlCompLog.showLog("salesBarPositionStatus E: "+salesBarPositionStatus,"log",1,logComp,displayLog,logDetailLevel)}else{if(footerPosition<-10&&salesBarPositionStatus!="static"&&salesBarPanelStatus!="open"){_elemSalesBar.removeClass("salesBarStatic").addClass("salesBarFixed").css("bottom","-10px");salesBarPositionStatus="fixed";rlCompLog.showLog("salesBarPositionStatus F: "+salesBarPositionStatus,"log",1,logComp,displayLog,logDetailLevel)}}}if(salesBarPositionStatus=="fixed"&&jq(document).scrollLeft()>0){_elemSalesBar.css("left",-jq(document).scrollLeft())}else{_elemSalesBar.css("left","")}coverCQWireframes()}}function resizeSalesBarReference(_elem,elemHeight){rlCompLog.showLog(elemHeight,"info",0,logComp,displayLog,logDetailLevel);var resizeHeight=jq(_elem).height()-(2*jq(_elem).height())+elemHeight;var animationDuration;if(iAmInMotion){_elemSalesBarReference.stop();animationDuration=animationLongDuration;iAmInMotion=false;salesBarReferenceHeight+=resizeHeight}else{salesBarReferenceHeight+=resizeHeight;animationDuration=animationLongDuration}iAmInMotion=true;_elemSalesBarReference.animate({height:salesBarReferenceHeight},animationDuration,function(){iAmInMotion=false;rlCompLog.showLog("salesBarReferenceHeight is now "+salesBarReferenceHeight+"px. Resize value is "+resizeHeight+"px","log",0,logComp,displayLog,logDetailLevel)})}function openElem(_elem,elemHeight){unbindWindowEvents();jq.when(jq(_elem).animate({height:elemHeight},{duration:animationLongDuration,step:function(){rlSalesBarAnimation.updateSalesBar()}})).then(function(){bindWindowEvents();updateSalesBar();runSequence()});resizeSalesBarReference(_elem,elemHeight)}function closeElem(_elem){salesBarPanelStatus="closed";unbindWindowEvents();jq.when(jq(_elem).animate({height:0},{duration:animationLongDuration,step:function(){}})).then(function(){bindWindowEvents();updateSalesBar();runSequence()});resizeSalesBarReference(_elem,0)}function coverCQWireframes(){if(isAuthorMode){_elemSalesBar.css("z-index","10000")}}function bindWindowEvents(){jq(window).bind("scroll",updateSalesBar);jq(window).bind("resize",updateSalesBar)}function unbindWindowEvents(){jq(window).unbind("scroll",updateSalesBar);jq(window).unbind("resize",updateSalesBar)}function bindSalesBarEvents(){jq(window).bind("updateSalesBarPanel",function(e,newContext){rlSalesBarAnimation.updateSalesBarPanel(newContext)});jq(window).bind("updateSalesBarContext",function(e,newContext){rlSalesBarAnimation.updateSalesBarContext(newContext)});jq(window).bind("hideSalesBar",function(){rlSalesBarAnimation.hideSalesBar()});jq(window).bind("showSalesBarPanel",function(){rlSalesBarAnimation.showSalesBarPanel()});jq(window).bind("hideSalesBarPanel",function(){rlSalesBarAnimation.hideSalesBarPanel()})}function getSalesBarStatus(){return salesBarPositionStatus}function isSalesBarDisplayed(){return _isDisplayed}return{__init__:function(){if(jq("#salesBarPanelWhite").length==0){rlCompLog.showLog("no salesBar available!","error",0,logComp,displayLog,logDetailLevel);return }_elemSalesBar=jq("#salesBarPanelWhite");_elemSalesBarPanel=jq(".salesBarPanel");_elemSalesBarPanelContent=jq(".salesBarPanelContent");_elemSalesBarReference=jq("#salesBarPanelHeightReference");_elemTopLine=jq(".salesBarTopLine");_elemFooter=jq("footer");_elemMLD=jq("#mldWrapper");_elemHighLowSwitchMarker=jq(".highbandLowbandMaker");if(_elemSalesBarPanel.height()>10){salesBarPanelStatus="open"}else{salesBarPanelStatus="closed"}salesBarReferenceHeight=_elemSalesBar.height();updateSalesBar();bindWindowEvents();bindSalesBarEvents()},updateSalesBar:function(){updateSalesBar()},addSaveListener:function(listener){saveListeners.push(listener);if(saveListeners.length===1){bindSaveListener()}},getConfigIdRequestParam:function(){var result;if(configId!==null&&configId!=="undefined"&&configId!==""){result={configId:configId}}else{result={}}return result},updateModelCodeUrl:function(){if(window.bmwModelCodeUrl!==null&&window.bmwModelCodeUrl!=="undefined"&&window.bmwModelCodeUrl!==""){var configButton=jq("#salesBarConfigureNow");configButton.prop("onclick",null);configButton.prop("href",window.bmwModelCodeUrl)}},showSalesBar:function(){showSalesBar()},hideSalesBar:function(){hideSalesBar()},updateSalesBarPanel:function(){updateSalesBarPanel()},resizeSalesBarReference:function(_elem,elemHeight){resizeSalesBarReference(_elem,elemHeight)},updateSalesBarContext:function(newContext){updateSalesBarContext(newContext)},updateSalesBarContextTest:function(newContext){updateSalesBarContextTest(newContext)},getSalesBarStatus:function(){return getSalesBarStatus()},isSalesBarDisplayed:function(){return isSalesBarDisplayed()},showLog:function(logTXT,type,detailLevel){showLog(logTXT,type,detailLevel)}}}();var rlSalesBarConditions=function(){function D(){return(rlContextObject.getIsSOC()==true)?true:false}function C(){return(rlContextObject.getIsAccessory()==true)?true:false}function E(){return(rlContextObject.getHasSavedConfigs()==true)?true:false}function B(){return(rlContextObject.getHasSavedVehicles()==true)?true:false}function A(){return(rlContextObject.getESP()==true)?true:false}return{__init:function(){},checkCondition:function(F){if(!F){F=""}switch(F.toLowerCase()){case"soc":return D();break;case"esp":return A();break;case"accessory":return checkConditionAccessory();break;case"configuration":return E();break;case"garage":return B();break;default:return false;break}}}}();var rlSearchResult=function(){var A=24;var C="query";var E,D;var B=false;return{__start__:function(){},setDisableAJAXHistorySearch:function(F){B=F},fixLoadingDivHeight:function(){jq("#searchResultContentLoading").height(jq("#searchResultContentWrapper").height())},getSearchResult:function(G,H){rlSearchResult.fixLoadingDivHeight();var I;if(!G){I=window.location.hash.substring(1)}else{rlSearchResult.setDisableAJAXHistorySearch(true);location.hash=G;window.setTimeout(function(){rlSearchResult.setDisableAJAXHistorySearch(false)},1000);I=G}if(I==""){return }var K=rlSearchUtil.getDecodedBase64(I);if(!K){return false}if(typeof K.q!="undefined"&&K.q){var F=rlSearchUtil.getConvertedSearchStringBackward(K.q);jq("#searchResultInputField").val(F);jq("#searchQueryBarInputField").val(F)}var J=rlSearchUtil.getGSASearchPath(I,A,K);if(J){jq("#searchResultContentLoading").show();D=window.setTimeout(function(){jq("#searchResultContentSlowLoading").show()},2000);rlCrossSubDomainAjax.call({url:J[0],type:"POST",scriptCharset:"UTF-8",data:J[1],beforeSend:function(L){L.setRequestHeader("Accept-Charset","UTF-8")},success:function(L){jq("#searchEngineResponse").html(L);rlSearchResult.labelI18nLanguageKeys();jq("#searchResultHeadSuggestionTarget").html(jq("#searchEngineResponse #searchEngineSuggest"));jq("#searchEngineResponse #searchEngineResults .searchEnginePageNavi").appendTo("#searchResultPageNaviTarget");jq("#searchResultResultsTarget").html("");jq("#searchEngineResponse #searchEngineKeymatch").appendTo("#searchResultResultsTarget");jq("#searchEngineResponse #searchEngineResults").appendTo("#searchResultResultsTarget");jq("#searchResultInputField").val(J[1].query);rlSearchResult.fixLoadingDivHeight();jq("#searchResultPageNaviTargetBottom").html("");jq("#searchResultPageNaviTargetBottom").html(jq("#searchResultPageNaviTarget .searchEnginePageNavi").clone());if(jq("#searchEngineResults").length==0){rlSearchResult.showErrorMessageNoResult();jq("#searchEngineResponseNoResult").clone().appendTo("#searchResultResultsTarget");jq("#searchEngineStatistic").html("");jq("#searchResultPageNaviTargetBottom").html("")}else{}jq("#searchResultDynNaviTarget").html("");jq("#searchResultDynNaviTarget").html(jq("#searchEngineDynNavi"));jq("#searchResultDynNaviTarget input").each(function(M,N){rlSearchUtil.linkWithAnchor(rlSearchResult.getSearchResult,"value",N)});jq(".searchResultDynamicNavigationFacetteHeadline").each(function(){jq(".searchResultDynamicNavigationFacetteHeadlineValue",this).html(facetLabelMap[jq(this).attr("name")]);rlSearchUtil.enableAccordion(this)});jq(".searchResultLeftNavigationTitle").html(cfFilterByHeadline);jq(".searchResultDynamicNavigationClearFilter").html(cfClearFilterLinkName);jq(".searchResultDynamicNavigationClearFilter").attr("title",cfClearFilterLinkName);jq(".searchEngineSuggestLabel").html(searchEngineSuggestLabel);jq("#searchResultList").fadeIn();jq("#searchResultDynamicNavigation").show();jq("#searchEngineSuggest a").each(function(M,N){rlSearchUtil.linkWithAnchor(rlSearchResult.getSearchResult,"href",N)});jq(".searchResultPageNavi a").each(function(M,N){rlSearchUtil.linkWithAnchor(rlSearchResult.getSearchResult,"href",N)});jq("#searchEngineResponse #searchEngineResults .searchResultTab a").each(function(M,N){rlSearchUtil.linkWithAnchor(rlSearchResult.getSearchResult,"href",N)});jq(".searchResultLeftNavigation a").each(function(M,N){rlSearchUtil.linkWithAnchor(rlSearchResult.getSearchResult,"href",N)});if(typeof wa_s_rc!="undefined"&&wa_s_rc>0){rlAsrInclude.registerLoad(page_query,page_start,page_site)}rlSearchResult.hideSearchResultLoading();if(H&&H=="value"){}else{jq("html, body").scrollTop(0)}jq("#searchEngineResponse").html("")},error:function(L,N,M){jq("#searchEngineStatistic").html("");jq("#searchResultPageNaviTargetBottom").html("");jq("#searchResultResultsTarget").html(cfMsgSearchEngineTechnicalError);jq("#searchResultList").fadeIn();rlSearchResult.hideSearchResultLoading()}})}},hideSearchResultLoading:function(){jq("#searchResultContentLoading").hide();jq("div.searchQueryLiveSearchLayer").fadeOut();if(D){window.clearTimeout(D)}jq("#searchResultContentSlowLoading").hide()},setNumResultPage:function(F){A=F},showErrorMessageNoResult:function(){jq("searchEngineStatistic").clone();jq("#searchEngineNoResultHeadline").html(cfMsgErrorNoResultsHeadline);jq("#searchEngineNoResultFirstLine").html(cfMsgErrorNoResultsFirstLine);jq("#searchEngineNoResultSecondLine").html(cfMsgErrorNoResultsSecondLine)},setStatisticsInformation:function(J,H,K,G,F){var I=J?cfMsgSearchResultStatistics:cfMsgSearchResultsStatistics;I=I.replace("{resultPageCount}",H);I=I.replace("{resultCount}",K);I=I.replace("{searchQuery}",G);I=I.replace("{searchDuration}",F);jq("#searchResultPageNaviTarget").html('<div id="searchEngineStatistic">'+I+"</div>")},registerAjaxHistory:function(G){var F=location.hash;if(F==""){}else{if(!B){rlSearchResult.getSearchResult(F)}B=false}},enableAjaxHistory:function(F){var G=true;if(G){jq(window).bind("hashchange",function(){rlSearchResult.registerAjaxHistory()});jq(window).trigger("hashchange")}else{rlSearchResult.getSearchResult()}},formatPDFSize:function(F,G){jq(F).formatNumber({format:"#,##0.00",locale:G.toLowerCase()})},gotoDealerLocator:function(F,H,G){rlGlassPaneLayerNext.openDialog({url:GLOBAL_DLO_PAGE_URL+"?distributionPartnerId="+H+"&outletId="+G,autoWcmMode:true,waitforcallback:true})},__init__:function(){rlSearchResult.setNumResultPage(cfNumResultsInPage);rlSearchResult.enableAjaxHistory()},labelI18nLanguageKeys:function(){jq(".labelDealerLocator").html(jq("#cf_searchResult_dealer_locator").html())}}}();var rlSearchResultPage=function(){var F,C,H,B;var A,D,G,E;return{__start__:function(){},go2result:function(I){rlSearchUtil.go2result(I,C,B,rlSearchResult.getSearchResult)},onButtonClick:function(J){var I=jq("#searchResultInputField").val();rlSearchUtil.go2result(I,C,B,rlSearchResult.getSearchResult)},initAutosuggest:function(){rlAutosuggest.autosuggest("page",{id:B,className:"searchResultPageLiveSearchLayerSuggest",suggestServletName:"",minCharsForAutoSuggest:A,minCharsForLiveSearch:D,numLiveSearchResults:G,numAutoSuggestResults:E,rtnIDs:false,searchFunction:rlSearchResultPage.go2result,methodType:"GET",dataFile:F});jq("#searchResultPageContentExtendedSearchLink a").click(function(){var M=jq("#searchResultInputField").val();var L=rlSearchUtil.encodeQueryParam(M,B);jq(this).attr("href",jq(this).attr("href")+"#"+L)});jq("#searchResultButton").click(rlSearchResultPage.onButtonClick);var J=window.location.hash.substring(1);if(J!=""){var I=jq.base64Decode(J);var K=jq.secureEvalJSON(I);if(K.q){jq("#"+B).val(rlSearchUtil.getConvertedSearchStringBackward(K.q));jq("#searchQueryBarInputField").val(rlSearchUtil.getConvertedSearchStringBackward(K.q))}}jq("#"+B).focus(function(){if(H&&H!=""){if(jq(this).val()==H){jq(this).val("")}}jq(this).css("color","#000000")});jq("#"+B).blur(function(){if(jq(this).val()==""){if(H&&H!=""){jq(this).val(H)}}jq(this).css("color","")})},setSearchResultPagePath:function(I){C=I},setMinCharsForAutoSuggest:function(I){A=I},setMinCharsForLiveSearch:function(I){D=I},setNumLiveSearchResults:function(I){G=I},setNumAutoSuggestResults:function(I){E=I},setSearchResultPageFieldInitValue:function(I){H=I},setGsaProxyHost:function(I){F=I},setSearchResultFieldId:function(I){B=I},getSearchResultFieldId:function(){return B},__init__:function(){rlSearchResultPage.setSearchResultPageFieldInitValue("");rlSearchResultPage.setMinCharsForAutoSuggest(cfMinCharAutoSuggest);rlSearchResultPage.setMinCharsForLiveSearch(cfMinCharLiveSearch);rlSearchResultPage.setNumLiveSearchResults(cfNumLiveSearchResults);rlSearchResultPage.setNumAutoSuggestResults(cfNumAutoSuggestResults);rlSearchResultPage.setSearchResultPagePath(externalSearchPagePath);rlSearchResultPage.setGsaProxyHost(rlPage.getNextCoreUrl()+cfGsaBaseUrl);rlSearchResultPage.setSearchResultFieldId("searchResultInputField");rlSearchResultPage.initAutosuggest()}}}();var rlSendCampaignFormButton=function(){var D;var A;var C=false;function B(F,G){C=G;if(A){var E=jq("#"+A);if(E&&E.length>0){E[0].disabled=G;E.toggleClass("buttonGrey",G);E.toggleClass("buttonBlue",!G)}}}return{__init__:function(){},__start__:function(){},initButton:function(E){A=E;jq(window).bind(rlAbstractUserManagementForm.getTriggerNameDisableRegistration(),B);B(this,rlAbstractUserManagementForm.isRegistrationDisabled())},setNextPagePath:function(E){D=E},register:function(){if(!C){var E=function(){if(D){rlGlassPaneLayerNext.switchContent({url:D,footerContent:".mybmw-feedbackLayer .feedback-footer",width:"w2"})}};rlAbstractUserManagementForm.sendCampaignForm("campaignForm",E)}}}}();var rlSeriesOverview=function(){return{__init__:function(){jq(".seriesOverviewModelsVehicle").hover(function(){jq(this).find(".seriesOverviewModelsInfoText").stop(true,true).fadeOut(250);jq(this).find(".seriesOverviewModelsActions").stop(true,true).delay(250).fadeIn(250)},function(){jq(this).find(".seriesOverviewModelsActions").stop(true,true).fadeOut(250);jq(this).find(".seriesOverviewModelsInfoText").stop(true,true).delay(250).fadeIn(250)})}}}();var rlShareButton=function(){var E="";var B="";var D="";var C="";var A="";return{__start__:function(){},__init__:function(){if(jq.browser.msie){rlShareButton.workaroundIEposForSharebutton();jq(window).resize(function(){rlShareButton.workaroundIEposForSharebutton()})}},workaroundIEposForSharebutton:function(){jq("body").append(jq("#interactionsShareButtonActive"));jq("#interactionsShareButtonActive").css(jq("#interactionListWrapper").offset())},setContentId:function(F){E=F},setFooterId:function(F){B=F},openLayerCallback:function(){},closeLayerCallback:function(){jq("#interactionsShareButtonActive").hide()},openLayer:function(){rlGlassPaneLayerNext.openDialog({url:rlShareButton.shareFormAjaxUrl,onOpen:rlShareButton.openLayerCallback,onClose:rlShareButton.closeLayerCallback,content:"#"+E,waitforcallback:true});jq("#interactionsShareButtonActive").show()},openSharePopUp:function(G,H,F){G=G+rlShareButton.getShareUrl();if(H){G=G+H+escape(rlShareButton.getTitleParam())}G=encodeURI(G);G=G.replace("#","%23");window.open(G,"_blank");return false},setShareFormAjaxUrl:function(F){rlShareButton.shareFormAjaxUrl=F},getShareUrl:function(){var F=false;if(window.document!=top.document){F=true}if(C===""){if(F){C=top.location.href}else{C=location.href}}return C},setShareUrl:function(F){C=F},getTitleParam:function(){var F=false;if(window.document!=top.document){F=true}if(A===""){if(F){A=top.document.title}else{A=document.title}}return A},setTitleParam:function(F){A=F}}}();var rlSlideBox=function(){animatedCheckbox=(function(){var B;function B(F,C){var D,E,G;this.elem=jq(F);E=jq.extend({},B.defaults,C);if(C&&C.bmwSliderType&&C.bmwSliderType=="slideBoxSmall"){E=jq.extend(E,B.defaultsSmall)}for(D in E){G=E[D];this[D]=G}this.wrapCheckboxWithDivs();this.attachEvents();this.disableTextSelection();this.sliderWidth=this.uncheckedWidth+this.checkedWidth+this.handleWidth;this.largerPartWidth=this.uncheckedWidth>this.checkedWidth?this.uncheckedWidth:this.checkedWidth;this.containerWidth=this.handleWidth+this.largerPartWidth;this.sizeElements();this.initialPosition();this.statusChanged=false}B.prototype.isDisabled=function(){return this.elem.is(":disabled")};B.prototype.wrapCheckboxWithDivs=function(){this.elem.wrap("<div class='"+this.containerClass+"' />");this.container=this.elem.parent();this.container.wrap("<div class='"+this.bmwSliderType+" slideBoxWrapper'/>");this.leftBorderWrapper=jq("<div class='slideBoxLeftBorderWrapper'>&nbsp;</div>").insertBefore(this.container);this.leftBorder=jq("<span class='slideBoxLeftBorder'>&nbsp;</span>").appendTo(this.leftBorderWrapper);var C="<label class='"+this.sliderClass+"'></label>";this.slider=jq(C).appendTo(this.container);this.checkedSpan=jq("<span class='"+this.checkedLabelClass+"'>"+this.checkedLabel+"&nbsp;</span>").appendTo(this.slider);this.uncheckedSpan=jq("<span class='"+this.uncheckedLabelClass+"'>"+this.uncheckedLabel+"&nbsp;</span>").appendTo(this.slider);this.rightBorderWrapper=jq("<div class='slideBoxRightBorderWrapper'>&nbsp;</div>").insertAfter(this.container);this.rightBorder=jq("<span class='slideBoxRightBorder'>&nbsp;</span>").appendTo(this.rightBorderWrapper)};B.prototype.disableTextSelection=function(){if(jq.browser.msie){return jq([this.slider,this.uncheckedSpan,this.checkedSpan,this.container]).attr("unselectable","on")}};B.prototype.sizeElements=function(){this.container.css({width:this.containerWidth});this.slider.css({width:this.sliderWidth});this.checkedSpan.css({width:this.checkedLabelWidth});this.uncheckedSpan.css({width:this.uncheckedLabelWidth,"margin-left":this.handleWidth})};B.prototype.onMouseDown=function(D){var C;D.preventDefault();if(this.isDisabled()){return }C=D.pageX||D.originalEvent.changedTouches[0].pageX;B.currentlyClicking=this.slider;B.dragStartPosition=C;return B.sliderLeftOffset=parseInt(this.slider.css("left"),10)||0};B.prototype.onDragMove=function(E,C){if(B.currentlyClicking!==this.slider){return }var F=C-B.dragStartPosition;var D=B.sliderLeftOffset+F;if(D>0){D=0}else{if(D<-this.checkedWidth){D=-this.checkedWidth}}this.leftBorder.css({left:D+this.checkedWidth});this.rightBorder.css({left:D});return this.slider.css({left:D})};B.prototype.onDragEnd=function(D,C){var E;if(B.currentlyClicking!==this.slider){return }if(this.isDisabled()){return }if(B.dragging){absMove=Math.abs(C-B.dragStartPosition);if(absMove>=this.checkedWidth/2){if(C-B.dragStartPosition<0){this.elem.prop("checked",false)}else{this.elem.prop("checked",true)}}}else{this.elem.prop("checked",!this.elem.prop("checked"))}B.currentlyClicking=null;B.dragging=null;this.statusChanged=true;return this.elem.change()};B.prototype.onChange=function(){if(this.isDisabled()){this.container.addClass(this.disabledClass);return false}else{this.container.removeClass(this.disabledClass)}var D=this.checkedWith<this.uncheckedWith?this.uncheckedWith-this.checkedWith:0;var C=this.elem.prop("checked")?D:-this.checkedWidth;this.leftBorder.animate({left:C+this.checkedWidth},this.duration);this.rightBorder.animate({left:C},this.duration);this.slider.animate({left:C},this.duration);if(this.callback!="undefined"&&typeof this.callback=="function"){this.callback()}if(this.statusChanged){jq(this.elem).trigger("customClickEvent");this.statusChanged=false}};B.prototype.attachEvents=function(){var E,D,C;C=this;E=function(F){return C.onGlobalMove.apply(C,arguments)};D=function(F){C.onGlobalUp.apply(C,arguments);jq(document).unbind("mousemove touchmove",E);return jq(document).unbind("mouseup touchend",D)};this.container.bind("mousedown touchstart",function(F){C.onMouseDown.apply(C,arguments);jq(document).bind("mousemove touchmove",E);return jq(document).bind("mouseup touchend",D)});return this.elem.bind("change",function(){return C.onChange.apply(C,arguments)})};B.prototype.initialPosition=function(){if(this.elem.is(":checked")){var C=this.checkedWith<this.uncheckedWith?this.uncheckedWith-this.checkedWith:0;this.leftBorder.css({left:C+this.checkedWith});this.rightBorder.css({left:C});this.slider.css({left:C})}else{this.leftBorder.css({left:0});this.rightBorder.css({left:-this.checkedWidth});this.slider.css({left:-this.checkedWidth})}if(this.isDisabled()){return this.container.addClass(this.disabledClass)}};B.prototype.onGlobalMove=function(D){var C;if(!(!this.isDisabled()&&B.currentlyClicking)){return }D.preventDefault();C=D.pageX||D.originalEvent.changedTouches[0].pageX;if(!B.dragging&&(Math.abs(B.dragStartPosition-C)>0.5)){B.dragging=true}return this.onDragMove(D,C)};B.prototype.onGlobalUp=function(D){var C;if(!B.currentlyClicking){return }D.preventDefault();C=D.pageX||D.originalEvent.changedTouches[0].pageX;return this.onDragEnd(D,C)};B.defaults={duration:200,checkedLabel:"",uncheckedLabel:"",disabledClass:"slideBoxCheckDisabled",containerClass:"slideBoxCheckContainer",sliderClass:"slideBoxSlider",checkedLabelClass:"slideBoxOn",uncheckedLabelClass:"slideBoxOff",checkedWidth:30,uncheckedWidth:30,checkedLabelWidth:30,uncheckedLabelWidth:30,handleWidth:24,bmwSliderType:"slideBoxHigh"};B.defaultsSmall={checkedWidth:25,uncheckedWidth:25,checkedLabelWidth:25,uncheckedLabelWidth:25,handleWidth:18,bmwSliderType:"slideBoxSmall"};return B})();var A=function(){jq.sliderStyle=this.animatedCheckbox=animatedCheckbox;jq.fn.sliderStyle=function(C){var F,E,B,D;D=this.filter(":checkbox");for(E=0,B=D.length;E<B;E++){F=D[E];jq(F).data("sliderStyle",new animatedCheckbox(F,C))}return this};jq.fn.addSliderClickListener=function(B){jq(this).bind("customClickEvent",B)};jq.fn.animatedCheckbox=function(C){var G,D,F,B,E;if(C==null){C={}}D=jq.extend({},C,{resizeHandle:false,disabledClass:"slideBoxCheckDisabled",containerClass:"slideBoxCheckContainer",sliderClass:"slideBoxSlider",checkedLabelClass:"slideBoxOn",uncheckedLabelClass:"slideBoxOff",bmwSliderType:"slideBoxHigh"});E=this.filter(":checkbox");for(F=0,B=E.length;F<B;F++){G=E[F];jq(G).data("animatedCheckbox",new animatedCheckbox(G,D))}return this}};return{__start__:function(){},__init__:function(){A()}}}();var rlSlideShow=function(){var A=6000;var D=1000;function B(E){var M=E;var L=0;var F=M.find(".slideShowImage").length;var H=false;var S=false;var G=M.find(".slideShowImageIndex").text();var O=M.find(".slideShowControls");if(F>1){J()}function J(){P();var V=M.find(".slideShowControlPrev");var U=M.find(".slideShowControlNext");var T=M.find(".slideShowControlPlayPause");V.click(function(){rlSlideShow.prev(M)});U.click(function(){rlSlideShow.next(M)});T.click(function(){rlSlideShow.togglePlayPause(M)});O.stop(true,true).fadeIn(500).delay(2000).fadeOut(500);R()}function R(){M.find(".slideShowImageContainer").mouseenter(function(){O.stop(true,true).fadeIn(500)});M.find(".slideShowImageContainer").mouseleave(function(){O.delay(2000).fadeOut(500)})}function Q(T){if(H){M.find(".slideShowImage").stop(true,true).css("opacity",1).removeClass("slideShowImageCurrent").removeClass("slideShowImageCurrentFade");M.find(".slideShowImage").each(function(U){if(U==L){jq(this).addClass("slideShowImageCurrentFade")}if(U==T){jq(this).addClass("slideShowImageCurrent");jq(this).show()}});M.find(".slideShowImageCurrentFade").stop(true,true).animate({opacity:0},D)}else{M.find(".slideShowImage").stop(true,true).css("opacity",1).removeClass("slideShowImageCurrent").removeClass("slideShowImageCurrentFade");M.find(".slideShowImage").each(function(U){if(jq(this).hasClass("slideShowImageCurrent")){jq(this).removeClass("slideShowImageCurrent")}if(U==T){jq(this).addClass("slideShowImageCurrent")}})}L=T;P()}function P(){var T=G.replace(/%{cur}/,L+1).replace(/%{total}/,F);M.find(".slideShowImageIndex").text(T)}function N(){if(H){S=setTimeout(function(){K();N()},A)}else{clearTimeout(S)}}function K(){var T=L+1;if(T==F){T=0}Q(T)}function I(U){var T=M.find(".slideShowControlPlayPause > div");if(U==="play"){T.removeClass("spriteIconControlPauseMedium").addClass("spriteIconControlPlayMedium")}else{T.removeClass("spriteIconControlPlayMedium").addClass("spriteIconControlPauseMedium")}}return{next:function(){rlSlideShow.pause(M);K()},prev:function(){rlSlideShow.pause(M);var T=L-1;if(T<0){T=F-1}Q(T)},togglePlayPause:function(){if(H){rlSlideShow.pause(M)}else{rlSlideShow.play(M)}},pause:function(){H=false;clearTimeout(S);I("play")},play:function(){if(F<2){return }I("pause");H=true;N()}}}function C(E){if(!E.data("slideShowComponent")){var F=B(E);E.data("slideShowComponent",F);return F}return E.data("slideShowComponent")}return{__init__:function(){jq(".slideShowContent").each(function(){var E=jq(this);var F=B(E);E.data("slideShowComponent",F)})},next:function(E){C(E).next()},prev:function(E){C(E).prev()},pause:function(E){C(E).pause()},play:function(E){C(E).play()},togglePlayPause:function(E){C(E).togglePlayPause()},startSlideshow:function(E){C(E).nextRepeat()}}}();var rlTeaserArea=function(){var B="/bin/offerUrls";var C=/^(.*)([.]html([?].*)?)$/;function I(){try{var Q=rlJQuery_queryParams.getQueryParam("teaserService");if(Q==="mock"){console.log("Using teaser mock servlet.");B="/stateful/getTeaserUrlsMock"}}catch(R){console.log("Can't apply teaserService mode: "+R)}}function J(R){var S=R.indexOf("<body>");if(S===-1){console.log("Can't find teaser body start.");return R}var Q=R.indexOf("</body>");if(Q===-1){console.log("Can't find teaser body end.");return R}return R.substr(S+"<body>".length,Q)}function M(){var Q='<div class="teaserContent teaserAreaPlaceholderContainer shadow dynamicTeaser">';Q+="This is a placeholder for personalized teaser. ";Q+='Please switch to "preview" mode and reload the page ';Q+="to see this personalized teaser.</div>";return Q}function A(){var Q=jq("head");return{series:jq("meta[name=bmwnext-teaser-series]",Q).attr("content"),bodyType:jq("meta[name=bmwnext-teaser-bodyType]",Q).attr("content"),contentType:jq("meta[name=bmwnext-teaser-contentType]",Q).attr("content")}}function P(){return jq("head meta[name=jcrPath]").attr("content")}function E(){var Q=new Array();var R=jq("head");var S=jq('meta[name^="bmwnext-teaser-parameter-"]',R);S.each(function(U){var W=jq(this);var T=W.attr("name");var V=T.split("bmwnext-teaser-parameter-")[1];var X=W.attr("content");Q[U]='"'+V+'": "'+X+'"'});Q=Q.join(",");return Q}function O(){return jq(".teaserTextImage a").map(function(){return'"'+this.href+'"'}).get()}function G(R){var S=A();var T=E();var Q=O();return'{"facets": {"series": "'+S.series+'", "bodyType": "'+S.bodyType+'", "contentType": "'+S.contentType+'"}, "requests": [{"facets": {},"count": '+R+'}],  "staticTeaserLinks": ['+Q.join(",")+"]"+(T!==""?", "+T:"")+"}"}function N(Q){return Q;try{var R=C.exec(Q);return R[1]+".teaser"+R[2]}catch(S){console.error("Can't create just body URL for teaser: "+S);return Q}}function K(Q){var R='["'+Q.join('","')+'"]';return R}function H(Q,T){var S=T.offerUrls;var R="/bin/tracking";if(typeof S=="object"){jq.each(S,function(U,V){V=N(V);jq.get(V,function(X){var W=J(X);Q(W)})});jq.post(R,"displayedOffers="+K(S),function(U){},"json");window.bmwDisplayedOffers=S.join("|")}}function L(){return rlPage.isEditMode()}function F(Q,S){var T=M();for(var R=0;R<S;++R){Q(T)}}function D(R,Q){if(L()){F(Q,R);return }var S={p:G(R),jcrPath:P()};var T=function(U){H(Q,U)};jq.post(B,S,T,"json")}return{__init__:function(){I()},loadDynamicTeaserBeforeDest:function(R,S){var Q=function(T){jq(R).before(T)};D(S,Q)},loadDynamicTeaserAfterDest:function(R,S){var Q=function(T){jq(R).after(T)};D(S,Q)},loadDynamicTeaserIntoDest:function(R,S){var Q=function(T){jq(R).append(T)};D(S,Q)}}}();var rlTeaserTracking=function(){var F={};function C(H){var G=jq.parseJSON(H);F[G.id.replace(/\//g,"//")]=D(G.facets)}function D(H){var G="";jq.each(H,function(I,J){G+=";"+J.key+"="+J.value});return G}function E(){return jq(".stageLargeTeaserContainerElement, .offerContent").not(".offerArea .offerContent").filter(":visible").map(function(){return this.id}).get()}function B(H){var G=F[H]||"";return"id="+H+G}function A(){var H=E();var J=H.sort();var G=[];if(J.length>0){for(var I=0;I<J.length;I++){if(J[I+1]==J[I]){continue}else{G.push(B(J[I]))}}window.bmwDisplayedTeasers=G.join("|")}}return{__start__:function(){jq(window).bind(rlComponentLoader.getPageReadyTriggerName(),A)},__init__:function(){},update:function(G){window.bmwDisplayedTeasers=B(teaserid)},updateSelector:function(G){window.bmwDisplayedTeasers=jq(G).map(function(){return B(this.id)}).get().join("|")},appendStaticTeaser:C}}();var rlTellAFriendForm=function(){function A(C,E){var M=CoreFormsBase.inheritanceFrom(rlFormBase.create(C,E));var K=M.parent;M.typeName="rlTellAFriendForm";M.switchToEditMode=function(){M.resetValidationMessages();jq.each(M.getFieldSetsById(),function(O,N){N.switchToEditMode()})};M.switchToViewMode=function(){M.resetValidationMessages();jq.each(M.getFieldSetsById(),function(O,N){N.switchToViewMode()})};M.setMetaData=function(O){if(O.user.constraints&&O.user.constraints.constraint){if(!jq.isArray(O.user.constraints.constraint)){O.user.constraints.constraint=[O.user.constraints.constraint]}for(var N=0;N<O.user.constraints.constraint.length;N++){var P=O.user.constraints.constraint[N];if(P.usage==="Mandatory"){P.usage="Optional"}}}return K.setMetaData(O)};M.getUseCaseMetaDataRoot=function(){return"tellAFriendRequest"};M.setData=function(N){K.setData(N);M.switchToEditMode()};function H(){if(!rlPage.isEditMode()&&!rlPage.isDesignMode()){C.find(".formSubmitButton").click(L);C.find(".furtherRecommendationLink").click(G)}}function L(){if(M.validate()){B()}}function G(){J();C.find(".tellAFriendSuccessMessage").hide();C.find(".tellAFriendFormContent").fadeIn()}function B(){M.showDitherLayer();var N=F(M.getEditedData());rlCoreServices.sendTellAFriendEmail({data:N,success:function(R){var O=rlContextObject.getBrandSubbrand();var Q="";if(O&&O===rlEventTracker.eventList().BRAND_BMW_I()){Q="BI"}else{Q="BM"}var P=rlEventTracker.create();P.trackCustomEvent("form_share@"+Q+"?page=sent","genericAction/layer/open");C.find(".tellAFriendFormContent").hide();M.hideDitherLayer();C.find(".tellAFriendSuccessMessage").fadeIn();J();rlCoreServices.trackEventAsClick("tafEmailSent","tafAction")},validation:function(O){M.showBackendMessages(O);M.hideDitherLayer()},error:function(){M.hideDitherLayer();rlErrorService.handleError({actor:rlErrorService.ACTOR_SYSTEM})}})}function F(N){if(N.captcha){if(N.captcha.input){N.captchaResponse=N.captcha.input}delete (N.captcha)}N.charset="UTF-8";N.siteName=document.title;N.site=location.href;if(typeof (rlShareButton)!="undefined"&&rlShareButton.getShareUrl()){N.site=rlShareButton.getShareUrl()}return N}function J(){jq.each(M.getFieldSetsById(),function(O,N){if(typeof (N.resetFs)==="function"){N.resetFs()}if(typeof (N.reloadCaptcha)==="function"){N.reloadCaptcha()}})}function D(){C.find('[data-field="comment"]').attr("data-field","personalNote");C.find('[data-validationplacements="comment"]').attr("data-validationplacements","personalNote")}function I(){if(rlPage.isEditMode()||rlPage.isDesignMode()){C.find(".tellAFriendSuccessMessage").show()}}H();D();I();M.switchToEditMode();return M}return{__init__:function(){},__start__:function(){},create:function(B,C){return A(B,C)}}}();var rlTime=function(){function D(F){function E(G){return G<10?"0"+G:G}return F.getUTCFullYear()+"-"+E(F.getUTCMonth()+1)+"-"+E(F.getUTCDate())+"T"+E(F.getUTCHours())+":"+E(F.getUTCMinutes())+":"+E(F.getUTCSeconds())+"Z"}function C(L){var N="";var F="";var G="";var Q="";var H="";var E="";var M="";var P="";if((typeof L=="undefined")||(L=="")){return undefined}var R=new Date();var K=null;var J=null;var O=true;var I=L.indexOf("T");if(I!=-1){K=L.slice(0,I).split("-");J=L.slice(I+1,-1).split(":")}else{K=L.split("-")}if((J==null)&&(K.length==1)){R=new Date(Number(L))}else{if(((J!=null)&&((J.length<3)||isNaN(J[0])||isNaN(J[1])||isNaN(J[2])))||((K!=null)&&((K.length<3)||isNaN(K[0])||isNaN(K[1])||isNaN(K[2])))){return undefined}else{if(I!=-1){R.setUTCFullYear(K[0],K[1]-1,K[2]);R.setUTCHours(J[0],J[1],J[2],0)}else{O=false;G=K[0];Q=K[1];H=K[2]}}}if(O){H=R.getDate();H=(H<10?"0":"")+H;Q=R.getMonth()+1;Q=(Q<10?"0":"")+Q;G=""+R.getFullYear();E=R.getHours();E=(E<10?"0":"")+E;M=R.getMinutes();M=(M<10?"0":"")+M;P=R.getSeconds();P=(P<10?"0":"")+P;var F=E+":"+M+":"+P}var N=H+"."+Q+"."+G;return{day:H,month:Q,year:G,hours:E,minutes:M,seconds:P,dateView:N,timeView:F,toDate:function(){return new Date(G,Q-1,H,E,M,P)}}}function A(I){var H="";var E=false;if(I!=undefined){var G=new Object();for(var F in I){G[F]=I[F]}if(G.year==undefined){G.year="1970"}if(G.month==undefined){G.month="1"}if(G.day==undefined){G.day="1"}if(G.hours==undefined){E=true;G.hours="0"}if(G.minutes==undefined){G.minutes="0"}if(G.seconds==undefined){G.seconds="0"}if(isNaN(G.year)||isNaN(G.month)||isNaN(G.day)||isNaN(G.hours)||isNaN(G.minutes)||isNaN(G.seconds)){return undefined}var J=new Date(G.year,G.month-1,G.day);if(G.month!=J.getMonth()+1){return undefined}if(E){H=H+G.year+"-"+(G.month<10?"0":"")+Number(G.month)+"-"+(G.day<10?"0":"")+Number(G.day)}else{var K=new Date();K.setFullYear(G.year,G.month-1,G.day);K.setHours(Number(I.hours),G.minutes,G.seconds,0);H=H+K.getUTCFullYear()+"-"+((K.getUTCMonth()+1)<10?"0":"")+(K.getUTCMonth()+1)+"-"+(K.getUTCDate()<10?"0":"")+K.getUTCDate()+"T"+(K.getUTCHours()<10?"0":"")+K.getUTCHours()+":"+(K.getUTCMinutes()<10?"0":"")+K.getUTCMinutes()+":"+(K.getUTCSeconds()<10?"0":"")+K.getUTCSeconds()}}return H}function B(H,E){var F=31;if(H==""){return F}else{if(isNaN(H)||(H>12)||(H<1)){return undefined}else{if(H==2){F=29;if(E!=""){if(isNaN(E)){return undefined}var G=new Date(E,1,29);if(G.getMonth()!=1){F=28}}}else{if((H==4)||(H==6)||(H==9)||(H==11)){F=30}}}}return F}return{__init__:function(){},convertUTCDateToLocal:function(E){return C(E)},convertLocalDateToUTC:function(E){return A(E)},getMaxDaysForMonth:function(F,E){return B(F,E)},convertDateToISO8601:function(E){return D(E)}}}();var rlTooltip=function(){var B=false;function A(){jq(".myconfigTooltipAnchor").each(function(I){var H=jq(this);var K=H.attr("id");var G="#"+K+"_div";var J=jq(G);J.appendTo("body")});jq("div.myconfigTooltipAnchor").mouseover(function(){var G=jq(this);F(G)}).mouseout(function(){var G=jq(this);C(G)});jq("input.myconfigTooltipAnchor").focusin(function(){E(jq(this))}).focusout(function(){D(jq(this))})}function F(H){var K=H.attr("id");console.log("ToolTipAchorId mouseover: "+K);var G="#"+K+"_div";var J=jq(G);var L=30+jq(H).offset().left;var I=jq(H).offset().top;J.css("left",L);J.css("top",I);J.show()}function C(H){var J=H.attr("id");console.log("ToolTipAchorId mouseout: "+J);var G="#"+J+"_div";var I=jq(G);I.hide()}function E(H){var K=H.attr("id");console.log("ToolTipAchorId focusin: "+K);var G="#"+K+"_div";var J=jq(G);var I=jq(H).offset().top;var L=30+jq(H).offset().left+jq(H)[0].offsetWidth;J.css("left",L);J.css("top",I);J.fadeIn(500);J.queue(function(){J.append('<img border="0" src="/etc/designs/bmwnext/apps/bmwnext/mybmw/base/static/parComponents/tooltip/ttanchor.png" alt="" class="tt_anchor">');jq(this).dequeue()})}function D(H){var J=H.attr("id");console.log("ToolTipAchorId focusout: "+J);var G="#"+J+"_div";var I=jq(G);I.fadeOut(500);I.queue(function(){jq(".tt_anchor").remove();jq(this).dequeue()})}return{__init__:function(){},__start__:function(){A()}}}();var rlTracking=function(){var A=window.location.protocol;var L=window.location.host;var C=window.location.port;var G=A+"//"+L;if(G.indexOf("dev.bmw-dev.com")<0){if(A.indexOf("https")<0){G=window.nextCore}else{G=window.nextCoreSecure}}var I=G+"/perso/services/nomandator/tracking/page";var H=G+"/perso/services/nomandator/tracking/offerClick";var J=G+"/perso/services/nomandator/tracking/startEsp";return{__init__:function(){},__start__:function(){},offerClick:function(N){},startEspClick:function(N){if(N.configId&&N.publicConfigId){rlCrossSubDomainAjax.call({type:"POST",url:J,contentType:"application/json",data:JSON.stringify(N),success:function(O){},error:function(O,Q,P){console.error("tracking of ESP start failed")}})}else{console.log("startEspClick: configId or publicConfigId undefined.")}}};function M(){var P=window.location.href;var O=F("WT.mc_id");var N=F("Lc")||F("lc");if(O!=""||N!=""){return'{"id":"'+N+'","params":["'+P+'","WT.mc_id='+O+'","Lc='+N+'"]}'}else{return"null"}}function K(){var Q=[],P;var N=window.location.href.slice(window.location.href.indexOf("?")+1).split("&");for(var O=0;O<N.length;O++){P=N[O].split("=");Q.push(P[0]);Q[P[0]]=P[1]}return Q}function F(N){var O=K()[N];return O!=undefined?O:""}function B(N){return E(N.key,N.value)}function E(P,O){var N='"'+P+'":';if(P==="consec"){N+='"'+O[0]+'"'}else{N+='["'+O.join('","')+'"]'}return N}function D(){if(window.bmwPageFacets===undefined){return"{}"}var P=window.bmwPageFacets.split("|");var T=[];for(var R=0;R<P.length;R++){var S=P[R].split("=");var N=new Object();N.key=S[0];N.value=[];N.value[N.value.length]=S[1];var O=false;for(var Q=0;Q<T.length;Q++){if(T[Q].key===N.key){T[Q].value[T[Q].value.length]=N.value[0];O=true;break}}if(!O){T[T.length]=N}}var U="{";for(R=0;R<T.length;R++){if(R>0){U+=","}U+=B(T[R])}U+="}";return U}}();var rlUserMgmtUser=function(){var A=rlPage.getNextCoreUrl();var B=A+"/usermgmt-metadata/services/_{mandatorContext}/fielddescription/allFieldKeys";function C(E,D){var H=D.success||function(){};var G=D.validation||D.error||function(){};var F=D.error||function(){};rlNxt.call({type:"GET",dataType:"json",url:rlMandator.replaceCoreUrl(E),cacheKey:E,success:function(I){if(I.status){if(I.status==="OK"){H(I)}else{if(I.status==="NOK"){F(I)}else{if(I.status==="VALIDATION"){G(I)}else{F("Unsupported status from back-end: "+I.status)}}}}else{F("Missing entry 'status' in server response.")}},error:function(I,K,J){F(J)}})}return{__init__:function(){},__start__:function(){},getAllMetaData:function(D){C(B,D)}}}();var rlUserSettingsForCookies=function(){return{__init__:function(){jq("#cookieTogglerThirdParty").sliderStyle({callback:function(){if(jq("#cookieTogglerThirdParty").prop("checked")){jq(".cookieTogglerTextWrapperThirdParty span").css("display","none");jq("#cookieToggleOnThirdParty").css("display","block");rlCookieController.setRegulationThirdAccepted()}else{jq(".cookieTogglerTextWrapperThirdParty span").css("display","none");jq("#cookieToggleOffThirdParty").css("display","block");if(rlCookieController.isRegulationThirdAccepted()){jq("#cookieToggleOffHintThirdParty").css("display","block")}rlCookieController.setRegulationThirdRejected()}}});jq("#cookieToggler").sliderStyle({callback:function(){if(jq("#cookieToggler").prop("checked")){jq(".cookieTogglerTextWrapper span").css("display","none");jq("#cookieToggleOn").css("display","block");rlCookieController.setRegulationAccepted()}else{jq(".cookieTogglerTextWrapper span").css("display","none");jq("#cookieToggleOff").css("display","block");rlCookieController.setRegulationRejected()}}});if(rlCookieController.hasRegulation()&&rlCookieController.cookiesEnabled()){jq("#cookieTogglerWrapper").css("display","block");jq("#cookieTogglerWrapperThirdParty").css("display","block")}if(!rlCookieController.cookiesEnabled()){jq(".cookieTogglerWrapper").css("display","block");jq("#cookieTogglerWrapperThirdParty").css("display","block");jq(".slideBoxWrapper").css("display","none");jq(".cookieTogglerTextWrapper").css("width","600px");jq(".cookieTogglerTextWrapperThirdParty").css("width","600px");jq("span#cookieToggleBrowserDisabled").css("display","block");jq("#cookieToggleOffHintThirdParty").css("display","none")}else{if(rlCookieController.isRegulationAccepted()){jq(".cookieTogglerTextWrapper span").css("display","none");jq("#cookieToggleOn").css("display","block");jq("#cookieToggler").attr("checked",true).change()}else{jq(".cookieTogglerTextWrapper span").css("display","none");jq("#cookieToggleOff").css("display","block");jq("#cookieToggler").attr("checked",false).change()}if(rlCookieController.isRegulationThirdAccepted()){jq(".cookieTogglerTextWrapperThirdParty span").css("display","none");jq("#cookieToggleOnThirdParty").css("display","block");jq("#cookieTogglerThirdParty").attr("checked",true).change()}else{jq(".cookieTogglerTextWrapperThirdParty span").css("display","none");jq("#cookieToggleOffThirdParty").css("display","block");jq("#cookieTogglerThirdParty").attr("checked",false).change()}}}}}();var rlUsernameChangeConfirmError=function(){return{__init__:function(){jq("#loginChangeMyAccountLink").click(function(){var A={protocol:window.location.protocol,hostname:window.location.hostname};rlUserDialog.redirectToMyDashboard(A)})}}}();var rlVehicleDetailsFS=function(){function A(N,e){var W=CoreFormsBase.inheritanceFrom(rlFormFieldSet.createFS(N,e));var P=W.parent;W.typeName="rlVehicleDetailsFS";var b;var H={};var T=N.find("[data-extendedFieldsRequireModel]").length>0;var O;var f;var E;var X;var h;var C=false;var Q=N.find("#"+e.fsId+"_brand");var g=N.find("#"+e.fsId+"_series");var I=N.find("#"+e.fsId+"_model");var k=N.find("#"+e.fsId+"_modelyear");var B=N.find("#"+e.fsId+"_vin");var a=N.find("#"+e.fsId+"_initreg_year");var J=N.find("#"+e.fsId+"_initreg_month");var F=N.find("#"+e.fsId+"_annualUse");var j=N.find("#"+e.fsId+"_mileage");var d=N.find("#"+e.fsId+"_usage");var Y=N.find("#"+e.fsId+"_vehicleType");W.getFieldMappers=function(m){m=P.getFieldMappers(m);m.valueUndefinedIfEmpty={get:m.valueUndefinedIfEmpty.get,set:function(p,o,n){n.val(o||"")}};m.modelTreeBrandSeriesModel={get:L,set:Z};return m};function D(){var m=g.find("option:selected").attr("data-external-value");return m||g.val()}function V(m){return typeof (m)==="undefined"||m===null||m===""}function L(o,n){function m(p,q){q=V(q)?p.val():q;return p.prop("disabled")||V(q)?undefined:q}return{brand:m(Q,undefined),series:m(g,undefined),extSeries:m(g,D()),model:m(I,undefined),brandText:m(Q,Q.find("option:selected").text()),seriesText:m(g,g.find("option:selected").text()),modelText:m(I,I.find("option:selected").text()),vin:rlNccServices.modelTreeCheckIsBrandKeyBMW(Q.val())?m(B,undefined):undefined}}function Z(o,n,m){console.log("VehicleDetailsFS - setModelTreeBrandSeriesModel()");n=n||{};O=n.brand;f=n.series;E=n.model;h=n.vin;C=true;if(Q.find("option").length>1){b.afterBrandsLoaded()}}W.getValueRenderers=function(m){m.vin=function(q,p,n,o){o.text(p);if(jq.trim(p).length<1){o.parents(".fieldSetViewAreaRow").hide();o.prop("disabled",true)}else{o.prop("disabled",false);o.parents(".fieldSetViewAreaRow").show()}};m.initialRegistration=function(r,q,n,o){if(V(q)){o.text("--")}else{var p=q.split("-");o.text(p[1]+" / "+p[0])}};m.vehicleBrand=function(t,q,n,p){var s=N.find(".vehicleDetailsModelRow");var o=p.attr("data-treedepth");var r=q&&rlNccServices.modelTreeCheckIsBrandKeyBMW(q);if(o==2&&!r){s.hide();p.prop("disabled",true)}else{p.prop("disabled",false);s.show()}};return m};W.addValidatorToElement=function(q,n,p){var v=W.getFieldName(q);var m=true;if(/\.brand$/i.test(v)&&/required/i.test(n)){m=false;var t=v.split(".");t.pop();var u=t.join(".");var r=W.resolveConstraints(u);if(r){for(var s=0;s<r.length;s++){var o=r[s];if(o&&o.usage&&o.usage==="Mandatory"){m=true;break}}}}if(m===true){P.addValidatorToElement(q,n,p)}};W.getValidationRules=function(m){m=P.getValidationRules(m);m.noPartialInitRegDate=function(s,q){var r=jq.trim(q.find(".date_month:enabled").val());var p=jq.trim(q.find(".date_year:enabled").val());var o=(r!==""||p!=="");var n=(r!==""&&p!=="");if(o&&!n){return{fieldName:s,level:"ERROR",errorKey:"noPartialDate"}}};m.initialRegistrationYearNotBeforeModelYear=function(q,o){var p=parseInt(k.val());var n=parseInt(a.val());if(!isNaN(p)&&!isNaN(n)){if(p>n){return{fieldName:q,level:"ERROR",errorKey:"vehicle.initialRegistration#notBeforeModelYear"}}}};m.noPartialInitRegDateLive={event:"focusout",async:true,liveOnly:true,rule:function(q,o,p,n){setTimeout(function(){if(o.find(":focus").length>0){n()}else{var r=m.noPartialInitRegDate(q,o)||m.initialRegistrationYearNotBeforeModelYear(q,o);n(r)}},10)}};m.cleanUpValidationMessages={event:"focusout",rule:function(p,n,o){return null}};return m};W.getStateForInputCache=function(n){var m=n||{};delete m.modelYear;m=P.getStateForInputCache(m);return m};W.setStateFromInputCache=function(n){console.log("VehicleDetailsFS - setStateFromInputCache()");P.setStateFromInputCache(n);var o={brand:"",series:"",model:"",vin:""};var m=W.getInputCacheItemForInputId(n,Q.attr("id"));if(m!=null){o.brand=m.value}m=W.getInputCacheItemForInputId(n,g.attr("id"));if(m!=null){o.series=m.value}m=W.getInputCacheItemForInputId(n,I.attr("id"));if(m!=null){o.model=m.value}m=W.getInputCacheItemForInputId(n,B.attr("id"));if(m!=null){o.vin=m.value}m=W.getInputCacheItemForInputId(n,k.attr("id"));if(m!=null){X=m.value}Z(null,o,null)};W.getEditedData=function(m){m=P.getEditedData(m);var n=N.find("[data-mapper='modelTreeBrandSeriesModel']").attr("data-field");if(n&&m[n]){if(rlNccServices.modelTreeCheckIsBrandKeyBMW(Q.val())){m[n].defaultFreeTextNote=H.params.defaultfreetextnote}if(!m[n].brand&&!m[n].bmwVIN){delete m[n]}}return m};function S(){var m=(H.params.nbgvvehicletreedepth==2);if((m?g:I).val()==""&&B.val()==""){R()}else{c()}}function c(){if(T){a.prop("disabled",false);J.prop("disabled",false);F.prop("disabled",false);j.prop("disabled",false);d.prop("disabled",false);Y.prop("disabled",false)}}function R(){if(T){a.prop("disabled",true);J.prop("disabled",true);F.prop("disabled",true);j.prop("disabled",true);d.prop("disabled",true);Y.prop("disabled",true)}}W.onBrandsLoaded=function(){};W.onSeriesLoaded=function(){};W.onModelYearsLoaded=function(){};W.onModelsLoaded=function(){};function M(){var m={brandsDropdown:Q,seriesDropdown:g,modelsDropdown:I,modelYearsDropdown:k,pleaseChooseOptionLabel:H.params.pleasechooseoptionlabel,afterBrandsLoaded:function(){B.parents(".fieldSetEditAreaRow").hide();B.prop("disabled",true);if(H.params.nbgvvehicletreedepth==2){I.parents(".fieldSetEditAreaRow").hide();I.prop("disabled",true);if(k){k.parents(".fieldSetEditAreaRow").hide();k.prop("disabled",true)}}if(C===true){C=false;if(typeof h!=="undefined"){B.val(h);h=undefined;B.change();setTimeout(function(){B.focusout()},100)}if(typeof O!=="undefined"){Q.val(O);O=undefined;Q.change()}}W.onBrandsLoaded()},afterSeriesLoaded:function(){if(rlNccServices.modelTreeCheckIsBrandKeyBMW(Q.val())&&B.prop("disabled")){B.prop("disabled",false);B.parents(".fieldSetEditAreaRow").fadeIn()}if(typeof f!=="undefined"){g.val(f);f=undefined;g.change()}g.prop("disabled",W.disableSeriesModelDropdowns());W.onSeriesLoaded()},afterModelYearsLoaded:function(){if(typeof X!="undefined"){k.val(X);X=undefined;k.change()}k.prop("disabled",W.disableSeriesModelDropdowns());W.onModelYearsLoaded()},beforeModelYearSelected:function(q){var p=I.val();if(typeof p=="string"&&p.length>0){E=p}},afterModelsLoaded:function(){if(typeof X==="undefined"&&typeof E!=="undefined"){I.val(E);E=undefined;I.change()}I.prop("disabled",W.disableSeriesModelDropdowns());W.onModelsLoaded()},afterBrandSelected:function(){if(rlNccServices.modelTreeCheckIsBrandKeyBMW(Q.val())){if(B.prop("disabled")){B.prop("disabled",false);B.parents(".fieldSetEditAreaRow").fadeIn()}if(H.params.nbgvvehicletreedepth==2){I.prop("disabled",W.disableSeriesModelDropdowns());I.parents(".fieldSetEditAreaRow").fadeIn();if(k){k.prop("disabled",W.disableSeriesModelDropdowns());k.parents(".fieldSetEditAreaRow").fadeIn()}}}else{B.parents(".fieldSetEditAreaRow").fadeOut();B.val("");B.prop("disabled",true);g.prop("disabled",W.disableSeriesModelDropdowns());if(W.vgModelHelper.isVGModelVisible()){W.vgModelHelper.hideVGModelSection()}if(H.params.nbgvvehicletreedepth==2){I.parents(".fieldSetEditAreaRow").fadeOut();I.prop("disabled",true);if(k){k.parents(".fieldSetEditAreaRow").fadeOut();k.prop("disabled",true)}}}S()},afterSeriesSelected:function(){S()},afterModelSelected:function(){S()}};if(H.params.pleasechoosebrandoptionlabel){m.pleaseChooseBrandOptionLabel=H.params.pleasechoosebrandoptionlabel}if(H.params.pleasechooseseriesoptionlabel){m.pleaseChooseSeriesOptionLabel=H.params.pleasechooseseriesoptionlabel}if(H.params.pleasechoosemodelyearoptionlabel){m.pleaseChooseModelYearOptionLabel=H.params.pleasechoosemodelyearoptionlabel}if(H.params.pleasechoosemodeloptionlabel){m.pleaseChooseModelOptionLabel=H.params.pleasechoosemodeloptionlabel}b=rlModelTreeController.buildController(m);try{b.loadBrands()}catch(n){var o="Could not load brands: ";if(rlPage.isRunningOnAuthorInstance()){console.log(o+"This is normal on author as we don't have UCP-access.")}else{throw (o+n)}}}W.initVinTextbox=function(){var m=function(){K();S()};B.keyup(m);B.change(m)};W.disableSeriesModelDropdowns=function(){return !B.prop("disabled")&&jq.trim(B.val()).length>0};function K(){function m(n){return n.find("option").length<=1}if(W.vgModelHelper.isVGModelVisible()){W.vgModelHelper.hideVGModelSection()}g.prop("disabled",m(g)||W.disableSeriesModelDropdowns());k.prop("disabled",m(k)||W.disableSeriesModelDropdowns());I.prop("disabled",m(I)||W.disableSeriesModelDropdowns())}function G(){var n,o;var p="";for(n=1;n<=12;n++){o=(n<10)?"0"+n:n;p+="<option value='{month}'>{month}</option>".replace(/{month}/g,o)}N.find("select.date_month").append(p);var m="";for(n=(new Date()).getFullYear();n>=1960;n--){o=(n<10)?"0"+n:n;m+="<option value='{year}'>{year}</option>".replace(/{year}/g,o)}N.find("select.date_year").append(m)}function U(){N.find(".hideStar").each(function(m,n){n=jq(n);n.text(n.text().replace("*",""))})}W.vgModelHelper=rlVgModelHelper.create(N,{formEvents:W.formEvents,fsId:e.fsId});W.init=function(){P.init();W.initVinTextbox();G();R();U();H.params=W.getFieldsetProperties();W.vgModelHelper.initVGModelListener()};W.onFormReady=function(){P.onFormReady();if(!b){M()}};return W}return{__init__:function(){},__start__:function(){},createFS:function(B,C){return A(B,C)}}}();var rlVehicleInterestTypeFS=function(){return{__init__:function(){},__start__:function(){},createFS:function(A,B){return rlVehicleInterestTypesFSInstance(A,B)}}}();function rlVehicleInterestTypesFSInstance(A,D){var B=CoreFormsBase.inheritanceFrom(rlFormFieldSet.createFS(A,D));var C=B.parent;B.typeName="rlVehicleInterestTypeFS";return B}var rlVehicleProfileFS=function(){function A(L,E){var K=CoreFormsBase.inheritanceFrom(rlFormFieldSet.createFS(L,E));var I=K.parent;K.typeName="rlVehicleProfileFS";var M=K.getFieldsetProperties();var B=jq("#"+K.getFieldSetId()+"_DetailsLinkBeforeSummary");var D=jq("#"+K.getFieldSetId()+"_DetailsLinkAfterSummary");var G=jq("#"+K.getFieldSetId()+"_Details");K.init=function(){I.init();if(M.detaildataisinitiallyshown=="yes"){J()}else{H()}B.click(function(){C()});D.click(function(){C()})};K.supportsInputCache=function(){return false};K.getMetaDataRenderers=function(N){N.vehicleProfileSummary=function(Q,O,P){if(O==""){L.find(".vehicleMyBMWProfile").hide()}else{P.html(O)}};return N};function C(){if(F()){rlRfxViewHelper.hideElement(G,function(){H();jq(window).trigger(rlTrackingListener.EVENTS.EVENT_TRACKING_LISTENER_NOTIFICATION,{id:"vehicleProfileHideCarDetails",info:"",type:""})})}else{rlRfxViewHelper.showElement(G,function(){J();jq(window).trigger(rlTrackingListener.EVENTS.EVENT_TRACKING_LISTENER_NOTIFICATION,{id:"vehicleProfileShowCarDetails",info:"",type:""})})}}function F(){return G.css("display")!="none"}function J(){B.text(M.hidedetailslabel);G.css("display","block");if(typeof rlGlassPaneLayerNext==="object"&&rlGlassPaneLayerNext.isOpen()){rlGlassPaneLayerNext.layerSizeToWindowSize()}}function H(){B.text(M.showdetailslabel);G.css("display","none");if(typeof rlGlassPaneLayerNext==="object"&&rlGlassPaneLayerNext.isOpen()){rlGlassPaneLayerNext.layerSizeToWindowSize()}}return K}return{__init__:function(){},__start__:function(){},createFS:function(B,C){return A(B,C)}}}();var rlVehicleSelectionFS=function(){function A(j,D){var L=CoreFormsBase.inheritanceFrom(rlFormFieldSet.createFS(j,D));var P=L.parent;L.typeName="rlVehicleSelectionFS";var k="/apps/bmwnext/requests/parComponents/formFieldSets/vehicleSelectionFS/images/defaultVehicle.jpg";var O=L.typeName+": ";var Y={};var N=null;var a=null;var I=null;var G=null;var b=null;var H=undefined;L.init=function(){P.init();s();X();var w=window.rfxContextParams&&window.rfxContextParams.configId||-1,v=window.rfxContextParams&&window.rfxContextParams.seriesId||-1,u=window.rfxContextParams&&window.rfxContextParams.modelRangeId||-1;if(M(w)){W(w,R)}else{if(typeof (rlCoreFormEvents)!="undefined"){jq(window).bind(rlCoreFormEvents.ENUM.NAMES.VEHICLE_CONFIG_CHANGED,function(x,y){y&&R(y)})}}K();V();h();J();if(M(v)&&!M(w)){N.val(v).change()}if(M(u)&&!M(w)){a.val(u).change()}};L.supportsInputCache=function(){return false};L.getRequiredValidators=function(){return[]};L.getFieldsetProperties=function(){var u=j.data("fieldsetProperties");u=jq.extend(u,P.getFieldsetProperties());return u};L.getValidationRules=function(u){u.requiredVehicle={event:"focusout",when:"ELEM_INVALIDATED_BY_FORM",rule:function(x,v,w){if(!q(v.val())){return{fieldName:v.attr("name"),level:"ERROR",errorKey:"requiredVehicle",messageText:Y.fieldsetProperties.noVehicleSelectedErrorText}}}};return u};L.getFieldMappers=function(u){u.selectedVehicle={set:function(x,w,v){},get:function(x,w){var v={};if(m()){v={series:F(),bodyType:r(),model:E(),brand:t()}}return v}};u.vehicleConfiguration={set:function(x,w,v){},get:function(w,v){return H}};return u};L.getMailSummary=function(u){return u};L.getFormSummary=function(u,v){var w=window.rfxContextParams&&window.rfxContextParams.configId||-1;if(!M(w)){u.push({type:v.KEY_VALUE,key:jq.trim(j.find(".modelArea label").text().replace("*","")),value:jq.trim(j.find(".modelArea select option:selected").text())||jq.trim(j.find(".modelHeadline").text())})}return u};function Q(v){var u=jq("<img/>");u.addClass("selectedVehicleImage");j.find(".imageContainer, .imageContainerNCC").html(u);u.attr("src",v).ready(function(){u.delay(100).fadeIn(700);window.setTimeout(function(){jq(window).trigger(rlFormFieldSet.EVENT_FIELDSET_SIZE_CHANGED)},1)})}function R(v){H={configId:v.configId,originalConfigId:v.originalConfigId,configUrl:v.configUrl.value,lastChange:v.lastUpdate.value,brand:v.brand};var w=k;if(isDefined(v.imageUrlFrontVeryBig)){w=v.imageUrlFrontVeryBig.value}Q(w);var u=isDefined(v.modelSection.modelName)?v.modelSection.modelName.value:isDefined(v.modelSection.title)?v.modelSection.title.value:"";j.find("h2").text(u);j.find(".imageContainer").removeClass("imageContainer").addClass("imageContainerNCC");j.find(".selectedVehicleArea").show();j.find("#"+D.fsId+"_dropdown_cascade").hide()}function W(w,u){var v=w;if(c(w)===false){w+="?doSave=true"}rlNccServices.getConfig({isPub:true,configId:w,success:function(y){if(y!=null&&y.content!=null){y=y.content;y.originalConfigId=v;u(y)}else{var x=isDefined(y)&&isDefined(y.status)?y.status.message:"no data received.";console.error("rlNccServices.getConfig with configId "+w+" failed: "+x)}},error:function(){rlErrorService.handleError({actor:rlErrorService.ACTOR_SYSTEM});console.error(O+"Error in rlNccServices.getConfig")}})}function s(){Y.fieldsetProperties=L.getFieldsetProperties();Y.selectors={};Y.selectors.seriesArea=".seriesArea";Y.selectors.bodyTypeArea=".bodyTypeArea";Y.selectors.modelArea=".modelArea";Y.selectors.selectedVehicleArea=".selectedVehicleArea";Y.selectors.dropdown=".fieldSetFieldSelect"}function X(){N=j.find(Y.selectors.seriesArea+" "+Y.selectors.dropdown);a=j.find(Y.selectors.bodyTypeArea+" "+Y.selectors.dropdown);I=j.find(Y.selectors.modelArea+" "+Y.selectors.dropdown);G=j.find(".imageContainer, .imageContainerNCC").first();b=j.find(".headlineh2Mixed")}function h(){N.change(g);a.change(C);I.change(f)}function g(){V();Z();var u=N.val();if(!q(u)){K()}else{T();S()}n()}function C(){var u=a.val();if(!q(u)){V();Z()}else{p();B();U();d(a);e()}n()}function f(){var u=I.val();if(!q(u)){d(a)}else{d(I)}n()}function n(){j.find("select[name=vehselseries]").trigger("focusout")}function S(){j.find(Y.selectors.bodyTypeArea).fadeIn(700)}function K(){j.find(Y.selectors.bodyTypeArea).fadeOut(400);I.val([])}function B(){j.find(Y.selectors.modelArea).fadeIn(700)}function V(){j.find(Y.selectors.modelArea).fadeOut(400)}function e(){j.find(Y.selectors.selectedVehicleArea).fadeIn(700)}function Z(){j.find(Y.selectors.selectedVehicleArea).fadeOut(400);a.val([]);I.val([])}function J(){if(typeof Y.fieldsetProperties.vehicleSeries==="undefined"){console.error("options.fieldsetProperties.vehicleSeries missing.");return }N.html("");N.append(jq("<option />").val("-").html(Y.fieldsetProperties.defaultOptionText));var x=Y.fieldsetProperties.vehicleSeries;var u=Y.fieldsetProperties.vehicleSeriesSubBrands;for(var w=0;w<x.length;w++){var v=x[w];if(u[v]===D.subBrand){N.append(jq("<option />").val(v).html(v))}}}function T(){var u=F();a.html("");a.append(jq("<option />").val("-").html(Y.fieldsetProperties.defaultOptionText));for(var v=0;v<Y.fieldsetProperties.vehicleBodyTypes[u].length;v++){a.append(jq("<option/>").val(Y.fieldsetProperties.vehicleBodyTypeIds[u][v]).html(Y.fieldsetProperties.vehicleBodyTypes[u][v]))}}function p(){var v=F()+"."+r();I.html("");I.append(jq("<option />").val("-").html(Y.fieldsetProperties.defaultOptionText));for(var u=0;u<Y.fieldsetProperties.vehicleModels[v].length;u++){I.append(jq("<option/>").val(Y.fieldsetProperties.vehicleModelIds[v][u]).html(Y.fieldsetProperties.vehicleModels[v][u]))}}function o(){var v=F()+"."+r();var u=Y.fieldsetProperties.vehicleImages[v];if(typeof u!=="undefined"&&!u.match(/^(http|\/)/)){u="//"+u;Q(u)}}function U(){var u=G.find("img");if(u.length>0){u.fadeOut(400,function(){G.html("");o()})}else{o()}}function d(u){b.text(u.find("option:selected").text())}function q(u){return !(typeof u==="undefined"||u===null||u=="-"||u<0)}function M(u){return(typeof u!=="undefined"&&u!==null&&u!=""&&u!="-1")}function F(){var u=N.val();if(!q(u)){console.error("seriesKey invalid.");return undefined}else{return u}}function t(){var u=Y.fieldsetProperties.vehicleSeriesSubBrands[F()];if(!isDefined(u)){return"BM"}else{return u}}function r(){var u=a.val();if(!q(u)){console.error("bodyTypeKey invalid.");return undefined}else{return u}}function E(){var u=I.val();if(!q(u)){console.error("modelKey invalid.");return undefined}else{return u}}function m(){var u=I.val();return q(u)}function c(x){var v=rlMyConfigsController.getConfigs();if(v){for(var w=0,u=v.length;w<u;w++){if(v[w].configId==x){return true}}}return false}return L}return{__init__:function(){},__start__:function(){},createFS:function(B,C){return A(B,C)}}}();var rlVehicleteasers=function(){function A(){jq(".vehicleteasers").removeClass("onPageWithoutVehicle");jq(".vehicleteasers").addClass("onPageWithVehicle")}function B(){jq(".vehicleteasers").removeClass("onPageWithVehicle");jq(".vehicleteasers").addClass("onPageWithoutVehicle")}return{__init__:function(){if(rlPage.isEditMode()){B();return }rlCoreServices.isLoggedIn({loggedOut:function(){B()}});rlCoreServices.addLoggedInListener(function(){A()});rlCoreServices.addLoggedOutListener(function(){B()});rlMyVehiclesController.addVehicleLoadedListener({success:function(D){if(D){var C=function(){jq(".vehicleTeasers").find(".offerArea:hidden").show()};window.setTimeout(function(){var E=jq("meta[name=bmwnext-teaser-parameter-vehicleId]");E=E.length?E:jq('<meta name="bmwnext-teaser-parameter-vehicleId" />').appendTo("head");E.attr("content",D.vehicleId);rlOfferArea.__start__(true,C)},0)}}});rlMyVehiclesController.addVehicleListLoadedListener({success:function(C){if(C.length==0){B();rlOfferArea.__start__(true);jq(".vehicleTeasers").find(".offerArea:hidden").show()}else{A()}},error:function(C){B();rlOfferArea.__start__(true);jq(".vehicleTeasers").find(".offerArea:hidden").show()}});if(typeof rlNavigationTab!=="undefined"){rlNavigationTab.addTabChangedListener(function(){if(jq("#myBMWMainContent .usesFifthColumn").is(":visible")){jq(".vehicleteasers").hide(0);jq(".navigationTabContainer").removeClass("hasVehicleTeasers")}else{jq(".vehicleteasers").show(0);jq(".navigationTabContainer").addClass("hasVehicleTeasers")}})}},__start__:function(){}}}();rlVgModelHelper=function(){function A(I,B){var H=CoreFormsBase.inheritanceFrom(CoreFormsBase.createBaseType());var F=H.parent;H.typeName="rlVgModelHelper";if(!I||!B||!B.formEvents||!B.fsId){throw"VgModelHelper not properly initialized. Use rlVgModelHelper.create(jqFS, {formEvents, fsId})"}var D=B.formEvents;var E=B.fsId;var J=I.find("#"+E+"_vgmodel");var G=I.find(".vgModelSection");var C=I.find(".seriesModelSection");H.isVGModelVisible=function(){return G.is(":visible")};H.isVGModelDropdownRendered=function(){return(J.length===1)};H.isVGModelDropdownEmpty=function(){return(J.find("option").length<=1)};H.emptyVGModelDropdown=function(){J.find("option").each(function(K,L){if(K!==0){jq(L).remove()}})};H.hideVGModelSection=function(){if(rlGlobalConfig.isManualVinMapping){H.emptyVGModelDropdown();if(C.length===0){G.fadeOut()}else{G.hide()}C.fadeIn()}};H.showVGModelSection=function(){if(rlGlobalConfig.isManualVinMapping){C.hide();G.fadeIn()}};H.initVGModelListener=function(){if(!H.isVGModelDropdownRendered()){console.warn("No VGModelDropdown found");return }if(rlGlobalConfig.isManualVinMapping){if(rlPage.isEditMode()){G.show();J.prop("disabled",true)}else{G.hide();D.subscribe(rlCoreFormEvents.ENUM.NAMES.MANUAL_VIN_MAPPING_MODELS,function(K,L){console.log("vehicleDetalisFS: vg models: ",L);if(!L||L&&L.length<=1){H.hideVGModelSection();return }if(L&&L.length>1){H.emptyVGModelDropdown();jq.each(L,function(M,N){J.append("<option value="+N.code+">"+N.name+"</option>")});H.showVGModelSection()}})}}};return H}return{__init__:function(){},__start__:function(){},create:function(B,C){return A(B,C)}}}();var rlWallpaper=function(){var J=".wallpaperLayer";var P=".abstractLayerContent";var I=".galleryWrap";var N=".wallpaperItemContent";var T=".wallpaperItemData";var B=".wallpaperItemWallpaperPreview";var D=".wallpaperItemWallpaper1920";var H=".wallpaperItemWallpaper1600";var F=".wallpaperGalleryLink1920";var S=".wallpaperGalleryLink1600";var A=".wallpaperItemTitle";var O=".wallpaperItemText";var U=".wpControlPanel";var M=".wallpaperControlNext";var C=".wallpaperControlPrev";var V=".wallpaperImageIndex";var R=false;var G;var Q=false;var K=false;var L=false;var E=false;return{getComponentLayer:function(){return K},hideComponentLayer:function(){K.hide();jq(P,K).attr("src","")},getComponentParent:function(){return L},createShow:function(a){function Z(){var o=rlBrowser.getInternetExplorerVersion();return o>=7&&o<9}K=jq(J);L=K.parent();var W=jq(U+":first",K).show();var k=0;var g=a.parents(I+":first");if(!E){E=W.find(V).text()}var X=n(g);var m=a.attr("id");k=d(X.items,m);j(K,W,X,m,k);if(X.size>1){f(K,W)}else{W.hide()}function f(){G=setTimeout('jq("'+U+'").fadeOut(500);rlWallpaper.setMovingMouse(false)',5000);jq(J).mousemove(function(){clearTimeout(G);if(!Q){G=setTimeout('jq("'+U+'").fadeOut(500);rlWallpaper.setMovingMouse(false)',500)}if(!R){jq(U).fadeIn(500);R=true}});jq(J).mouseleave(function(){clearTimeout(G);G=setTimeout('jq("'+U+'").fadeOut(500);rlWallpaper.setMovingMouse(false)',500)});jq(U).mouseenter(function(){clearTimeout(G);Q=true});jq(U).mouseleave(function(){Q=false})}jq(M,K).unbind("click");jq(M,K).bind("click",function(){var o=c(X.items,function(){return(k+1)%X.size});k=o.index;j(K,W,X,o.key,k)});jq(C,K).unbind("click");jq(C,K).bind("click",function(){var o=c(X.items,function(){var p=(k-1)%X.size;if(p<0){p=X.size-1}return p});k=o.index;j(K,W,X,o.key,k)});function j(q,r,o,s,p){b(q,r,o.items[s]);h(q,p,o.size)}function h(p,o,q){var r=E.replace(/%{cur}/,o+1).replace(/%{total}/,q);jq(V).text(r)}function b(o,q,p){jq(P).attr("src",p.imagePreview).attr("id","_"+p.imageID);var r=jq(window).scrollTop();window.location.hash="#_"+p.imageID;jq(window).scrollTop(r);jq(".wpControlPanelContainer .headline h3").text(p.title);jq(".wpControlPanelContainer .copyTextBold").text(p.text);jq(".wpControlPanelContainer "+F).attr("href",p.image);jq(".wpControlPanelContainer "+S).attr("href",p.imageSmall)}function Y(o){if(jq("html").hasClass("ie7")||jq("html").hasClass("ie8")){jq(o).get(0).style.removeAttribute("filter")}}function n(p){var o={items:new Object(),size:0};jq(N,p).each(function(){var s=jq(this);var r=jq(T,s);var q={title:jq(A,r).text(),text:jq(O,r).text(),image:jq(D,r).attr("href"),imageSmall:jq(H,r).attr("href"),imagePreview:jq(B,r).attr("href"),imageID:s.attr("id")};o.items[s.attr("id")]=q;o.size++});return o}function e(r,p){var o=null;var q=0;for(var s in r){if(q===p){o=s;break}q++}return o}function d(p,r){var o=0;for(var q in p){if(r===q){break}o++}return o}function c(p,r){var q=r();var o=e(p,q);return{index:q,key:o,item:p[o]}}return K},startShow:function(W){var X=this;X.createShow(W);var Z=X.getComponentLayer();var Y=X.getComponentParent();rlGlassPaneLayerNext.openDialog({content:Z,flexible:true,flexibleSelector:"#wallpaperLayer img"})},setMovingMouse:function(W){R=W},getMovingMouse:function(){return R},__init__:function(){jq(I).each(function(){var Y=jq(this);jq(N,Y).each(function(){var Z=jq(this);Z.click(function(){rlWallpaper.startShow(Z)})})});var W=window.location.hash;var X="#"+W.substr(2);if(W.length>0){jq(document).ready(function(){jq(X).click()})}},__start__:function(){}}}();var rlZoomImage=function(){return{__init__:function(){jq(".zoomImageThumbWrap").click(function(){jq(this).parent().find(".magnifierIconBlue").trigger("click")})},__start__:function(){}}}();